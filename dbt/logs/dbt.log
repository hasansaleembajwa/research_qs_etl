[0m15:13:33.094081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c5b5dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c5aff2aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c59b5abc0>]}


============================== 15:13:33.096337 | 7bbfb710-6876-46b8-b0e5-1365c44e95a6 ==============================
[0m15:13:33.096337 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:13:33.096740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'send_anonymous_usage_stats': 'True'}
[0m15:13:33.516469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bbfb710-6876-46b8-b0e5-1365c44e95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c5b5016f0>]}
[0m15:13:33.556349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bbfb710-6876-46b8-b0e5-1365c44e95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c59f72ad0>]}
[0m15:13:33.557006 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:13:33.563533 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:13:33.564077 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:13:33.564386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7bbfb710-6876-46b8-b0e5-1365c44e95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c4212e710>]}
[0m15:13:34.360602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '7bbfb710-6876-46b8-b0e5-1365c44e95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c5b3d92d0>]}
[0m15:13:34.461318 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.stg_research_questions' (models/staging/stg_research_questions.sql) depends on a source named 'raw.consolidated_research_questions' which was not found
[0m15:13:34.468507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4129767, "process_user_time": 2.794671, "process_kernel_time": 0.09551, "process_mem_max_rss": "157200", "process_in_blocks": "8968", "process_out_blocks": "16", "command_success": false}
[0m15:13:34.469051 [debug] [MainThread]: Command `dbt run` failed at 15:13:34.468964 after 1.41 seconds
[0m15:13:34.469430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c5b5dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c41d54dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c4232e6b0>]}
[0m15:13:34.469762 [debug] [MainThread]: Flushing usage events
[0m18:28:05.271977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f3edffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f2749ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f274ab90>]}


============================== 18:28:05.274347 | 8f351fc2-485a-457b-b7e6-91b89c703e05 ==============================
[0m18:28:05.274347 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:28:05.274869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt/logs', 'profiles_dir': 'dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:28:05.692428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f351fc2-485a-457b-b7e6-91b89c703e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2dabe7e50>]}
[0m18:28:05.732388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f351fc2-485a-457b-b7e6-91b89c703e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f2c9f1f0>]}
[0m18:28:05.733191 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:28:05.739832 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:28:05.740435 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:28:05.740774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8f351fc2-485a-457b-b7e6-91b89c703e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2daa88fd0>]}
[0m18:28:06.613764 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.stg_research_questions' (models/staging/stg_research_questions.sql) depends on a source named 'raw.consolidated_research_questions' which was not found
[0m18:28:06.621159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3866417, "process_user_time": 2.763383, "process_kernel_time": 0.105556, "process_mem_max_rss": "156268", "process_in_blocks": "37184", "process_out_blocks": "16", "command_success": false}
[0m18:28:06.622069 [debug] [MainThread]: Command `dbt run` failed at 18:28:06.621948 after 1.39 seconds
[0m18:28:06.622629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f3edffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2da7f44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2da7f43d0>]}
[0m18:28:06.623109 [debug] [MainThread]: Flushing usage events
[0m18:36:15.177931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757e9ca580a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757e9af5b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757e9af5abf0>]}


============================== 18:36:15.180364 | 48d1d83a-367f-44fe-93f6-beb9c9bf633a ==============================
[0m18:36:15.180364 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:36:15.180806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:36:15.182801 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m18:36:15.183587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.042950463, "process_user_time": 0.825476, "process_kernel_time": 0.048086, "process_mem_max_rss": "107828", "process_in_blocks": "17456", "process_out_blocks": "16", "command_success": false}
[0m18:36:15.184045 [debug] [MainThread]: Command `dbt run` failed at 18:36:15.183972 after 0.04 seconds
[0m18:36:15.184388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757e9ca580a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757e9af8d4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757e9af8d990>]}
[0m18:36:15.184698 [debug] [MainThread]: Flushing usage events
[0m18:36:47.396149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b155e3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b159aa9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b159aa980>]}


============================== 18:36:47.398491 | 4d024198-0e42-4662-9d48-04b4b4f8d952 ==============================
[0m18:36:47.398491 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:36:47.399003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:36:47.401558 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m18:36:47.402305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.04966053, "process_user_time": 0.873348, "process_kernel_time": 0.044915, "process_mem_max_rss": "85084", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m18:36:47.402817 [debug] [MainThread]: Command `dbt run` failed at 18:36:47.402728 after 0.05 seconds
[0m18:36:47.403144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b155e3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b159abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732b159abd60>]}
[0m18:36:47.403488 [debug] [MainThread]: Flushing usage events
[0m18:37:03.453347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b35878effd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3587306aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3587c71720>]}


============================== 18:37:03.455392 | 7df89c21-679a-40d6-a4e2-43465ada95b2 ==============================
[0m18:37:03.455392 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:37:03.455986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:37:03.918004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7df89c21-679a-40d6-a4e2-43465ada95b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b35878116f0>]}
[0m18:37:03.959240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7df89c21-679a-40d6-a4e2-43465ada95b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3586ac5960>]}
[0m18:37:03.959940 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:37:03.966643 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:37:03.967296 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:37:03.967653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7df89c21-679a-40d6-a4e2-43465ada95b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b356e4550f0>]}
[0m18:37:04.892309 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:37:04.892796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7df89c21-679a-40d6-a4e2-43465ada95b2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b356e1f4190>]}
[0m18:37:05.027455 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.stg_research_questions' (models/staging/stg_research_questions.sql) depends on a source named 'raw.consolidated_research_questions' which was not found
[0m18:37:05.028241 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6123459, "process_user_time": 2.870442, "process_kernel_time": 0.067539, "process_mem_max_rss": "159436", "process_in_blocks": "3304", "process_out_blocks": "16", "command_success": false}
[0m18:37:05.028778 [debug] [MainThread]: Command `dbt run` failed at 18:37:05.028694 after 1.61 seconds
[0m18:37:05.029108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b35878effd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b356dd150f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b356e4a2b60>]}
[0m18:37:05.029432 [debug] [MainThread]: Flushing usage events
[0m18:38:15.267533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bdb27efdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bdb2bb68f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bdb2bb6890>]}


============================== 18:38:15.269527 | 86f7cbf5-f32e-4212-b62b-d8e58c42612c ==============================
[0m18:38:15.269527 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:38:15.269959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'profiles_dir': 'dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:15.667313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86f7cbf5-f32e-4212-b62b-d8e58c42612c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bdb2260c10>]}
[0m18:38:15.707488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86f7cbf5-f32e-4212-b62b-d8e58c42612c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bdb19c6c50>]}
[0m18:38:15.708160 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:38:15.715015 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:38:15.715666 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:38:15.716029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86f7cbf5-f32e-4212-b62b-d8e58c42612c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd99468a30>]}
[0m18:38:16.611658 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:38:16.612151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86f7cbf5-f32e-4212-b62b-d8e58c42612c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd990e7d90>]}
[0m18:38:16.743027 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.stg_research_questions' (models/staging/stg_research_questions.sql) depends on a source named 'raw.consolidated_research_questions' which was not found
[0m18:38:16.743832 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5133016, "process_user_time": 2.919444, "process_kernel_time": 0.079739, "process_mem_max_rss": "159932", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m18:38:16.744356 [debug] [MainThread]: Command `dbt run` failed at 18:38:16.744275 after 1.51 seconds
[0m18:38:16.744698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bdb27efdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd98d2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75bd990e6a10>]}
[0m18:38:16.745048 [debug] [MainThread]: Flushing usage events
[0m18:40:56.106149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca749d3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca731f1b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca731f1ba0>]}


============================== 18:40:56.109643 | ac826628-8d0c-4d97-a4cc-eba285c6b119 ==============================
[0m18:40:56.109643 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:40:56.110070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'profiles_dir': 'dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:40:56.542037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac826628-8d0c-4d97-a4cc-eba285c6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca748f56c0>]}
[0m18:40:56.582463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac826628-8d0c-4d97-a4cc-eba285c6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca73700400>]}
[0m18:40:56.583263 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:40:56.590183 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:40:56.590811 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:40:56.591136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac826628-8d0c-4d97-a4cc-eba285c6b119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca5b4fad10>]}
[0m18:40:57.527559 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:40:57.528092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac826628-8d0c-4d97-a4cc-eba285c6b119', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca5b292ec0>]}
[0m18:40:57.673698 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.int_research_questions_unified' (models/intermediate/int_research_questions_unified.sql) depends on a source named 'raw.question_categories' which was not found
[0m18:40:57.681164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6126266, "process_user_time": 2.982661, "process_kernel_time": 0.095572, "process_mem_max_rss": "159788", "process_in_blocks": "36256", "process_out_blocks": "16", "command_success": false}
[0m18:40:57.681847 [debug] [MainThread]: Command `dbt run` failed at 18:40:57.681749 after 1.61 seconds
[0m18:40:57.682203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca749d3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca5b0e4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ca5adcf040>]}
[0m18:40:57.682550 [debug] [MainThread]: Flushing usage events
[0m18:41:31.772762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71185b9d3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71185b35aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71185a1ad720>]}


============================== 18:41:31.774784 | d97a1683-cae8-403d-858e-fa148ea41013 ==============================
[0m18:41:31.774784 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:41:31.775201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:32.166984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd97a1683-cae8-403d-858e-fa148ea41013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71185b8f96f0>]}
[0m18:41:32.208062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd97a1683-cae8-403d-858e-fa148ea41013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71185ad15960>]}
[0m18:41:32.208761 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:41:32.215486 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:41:32.216114 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:41:32.216495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd97a1683-cae8-403d-858e-fa148ea41013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7118424b10f0>]}
[0m18:41:33.115032 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:41:33.115514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd97a1683-cae8-403d-858e-fa148ea41013', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71184225c190>]}
[0m18:41:33.248650 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.int_research_questions_unified' (models/intermediate/int_research_questions_unified.sql) depends on a source named 'raw.question_categories' which was not found
[0m18:41:33.249466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5127157, "process_user_time": 2.910268, "process_kernel_time": 0.081894, "process_mem_max_rss": "159876", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m18:41:33.249989 [debug] [MainThread]: Command `dbt run` failed at 18:41:33.249907 after 1.51 seconds
[0m18:41:33.250341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71185b9d3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7118420823b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7118424feb60>]}
[0m18:41:33.250670 [debug] [MainThread]: Flushing usage events
[0m18:46:31.282142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7191349cffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7191331ee8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7191331ee860>]}


============================== 18:46:31.284482 | ac338dfb-b290-4c26-b4b2-88277ff4bbc5 ==============================
[0m18:46:31.284482 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:46:31.285010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:46:31.369977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac338dfb-b290-4c26-b4b2-88277ff4bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7191343a3580>]}
[0m18:46:31.379590 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:46:31.381361 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:46:31.382220 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14449057, "process_user_time": 0.923326, "process_kernel_time": 0.054195, "process_mem_max_rss": "88024", "process_in_blocks": "1568", "process_out_blocks": "16"}
[0m18:46:31.382789 [debug] [MainThread]: Command `dbt deps` succeeded at 18:46:31.382710 after 0.15 seconds
[0m18:46:31.383093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7191349cffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7191331f0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719132d88130>]}
[0m18:46:31.383415 [debug] [MainThread]: Flushing usage events
[0m18:46:55.119531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cec036c3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cec01f2ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cec01f2cbb0>]}


============================== 18:46:55.121623 | c15645da-8f10-4b68-a2f2-499502256161 ==============================
[0m18:46:55.121623 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:46:55.122084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models +consolidated_research_questions', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:46:55.658041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c15645da-8f10-4b68-a2f2-499502256161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cebea32b7c0>]}
[0m18:46:55.700023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c15645da-8f10-4b68-a2f2-499502256161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cec01f2e890>]}
[0m18:46:55.707470 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:46:55.744771 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:46:55.745924 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:46:55.754329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c15645da-8f10-4b68-a2f2-499502256161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cebea1ace20>]}
[0m18:46:57.281915 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:46:57.282417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c15645da-8f10-4b68-a2f2-499502256161', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cebea1ad090>]}
[0m18:46:57.297458 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/schema.yml @ models: {'name': 'consolidated_research_questions', 'description': 'Current set of active research questions across all years', 'columns': [{'name': 'question_id', 'description': 'The unique identifier for the question', 'tests': ['unique', 'not_null']}, {'name': 'year', 'description': 'The year the question was introduced or last updated', 'tests': ['not_null']}, {'name': 'question_text', 'description': 'The text of the research question', 'tests': ['not_null']}, {'name': 'category_name', 'description': 'The category of the research question'}, {'name': 'is_active', 'description': 'Whether the question is currently active', 'tests': [{'accepted_values': {'values': [True]}}]}, {'name': 'valid_from', 'description': 'The date from which this version of the question is valid', 'tests': ['not_null']}, {'name': 'valid_to', 'description': 'The date until which this version of the question is valid', 'tests': [None]}, {'name': 'question_status', 'description': 'The current status of the question', 'tests': [{'accepted_values': {'values': ['Current']}}]}, {'name': 'answer_set', 'description': 'The set of possible answers for this question'}], 'tests': [{'dbt_utils.unique_combination_of_columns': {'combination_of_columns': ['question_id', 'valid_from']}}], 'original_file_path': 'models/schema.yml', 'yaml_key': 'models', 'package_name': 'research_questions_etl'} - at path ['columns'][6]['tests'][0]: None is not valid under any of the given schemas
[0m18:46:57.298638 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2192657, "process_user_time": 3.165163, "process_kernel_time": 0.102231, "process_mem_max_rss": "157292", "process_in_blocks": "88960", "process_out_blocks": "8", "command_success": false}
[0m18:46:57.299310 [debug] [MainThread]: Command `dbt run` failed at 18:46:57.299200 after 2.22 seconds
[0m18:46:57.299752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cec036c3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cebea1ad090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cebe9e7aef0>]}
[0m18:46:57.300133 [debug] [MainThread]: Flushing usage events
[0m18:47:25.032498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733968d540d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733967533c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733967532050>]}


============================== 18:47:25.034620 | a9a871f0-0d3e-4512-84dc-5e936b323a57 ==============================
[0m18:47:25.034620 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:47:25.035099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'dbt', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:47:25.439812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9a871f0-0d3e-4512-84dc-5e936b323a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73394f84c160>]}
[0m18:47:25.481645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9a871f0-0d3e-4512-84dc-5e936b323a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733967680100>]}
[0m18:47:25.482317 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:47:25.493218 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:47:25.494428 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:47:25.495110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9a871f0-0d3e-4512-84dc-5e936b323a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73394f7eb280>]}
[0m18:47:26.439968 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:47:26.440449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9a871f0-0d3e-4512-84dc-5e936b323a57', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73394f787d60>]}
[0m18:47:26.451797 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/schema.yml @ models: {'name': 'consolidated_research_questions', 'description': 'Current set of active research questions across all years', 'columns': [{'name': 'question_id', 'description': 'The unique identifier for the question', 'tests': ['unique', 'not_null']}, {'name': 'year', 'description': 'The year the question was introduced or last updated', 'tests': ['not_null']}, {'name': 'question_text', 'description': 'The text of the research question', 'tests': ['not_null']}, {'name': 'category_name', 'description': 'The category of the research question'}, {'name': 'is_active', 'description': 'Whether the question is currently active', 'tests': [{'accepted_values': {'values': [True]}}]}, {'name': 'valid_from', 'description': 'The date from which this version of the question is valid', 'tests': ['not_null']}, {'name': 'valid_to', 'description': 'The date until which this version of the question is valid', 'tests': [None]}, {'name': 'question_status', 'description': 'The current status of the question', 'tests': [{'accepted_values': {'values': ['Current']}}]}, {'name': 'answer_set', 'description': 'The set of possible answers for this question'}], 'tests': [{'dbt_utils.unique_combination_of_columns': {'combination_of_columns': ['question_id', 'valid_from']}}], 'original_file_path': 'models/schema.yml', 'yaml_key': 'models', 'package_name': 'research_questions_etl'} - at path ['columns'][6]['tests'][0]: None is not valid under any of the given schemas
[0m18:47:26.452720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4585738, "process_user_time": 2.910322, "process_kernel_time": 0.077955, "process_mem_max_rss": "157616", "process_in_blocks": "16", "process_out_blocks": "24", "command_success": false}
[0m18:47:26.453291 [debug] [MainThread]: Command `dbt run` failed at 18:47:26.453183 after 1.46 seconds
[0m18:47:26.453689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733968d540d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7339675316c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73394f8f3a90>]}
[0m18:47:26.454063 [debug] [MainThread]: Flushing usage events
[0m18:49:32.715985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741ba54bffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741ba3d6e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741ba3d6e890>]}


============================== 18:49:32.718365 | 58b1f966-bcf4-4538-9ab6-a7d415ff0c5d ==============================
[0m18:49:32.718365 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:49:32.718867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:49:32.805019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58b1f966-bcf4-4538-9ab6-a7d415ff0c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741ba53e16c0>]}
[0m18:49:32.816076 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5w63gi50'
[0m18:49:32.816545 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:49:32.959383 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:49:32.960865 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:49:33.051292 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:49:33.079375 [info ] [MainThread]: Updating lock file in file path: /home/hasan/Desktop/MyLearning/research_questions_etl/dbt/package-lock.yml
[0m18:49:33.081818 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lqeynk04'
[0m18:49:33.085544 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:49:33.439143 [info ] [MainThread]: Installed from version 0.9.2
[0m18:49:33.439719 [info ] [MainThread]: Updated version available: 1.3.0
[0m18:49:33.440136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '58b1f966-bcf4-4538-9ab6-a7d415ff0c5d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741ba4f08790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741ba3d6cb50>]}
[0m18:49:33.440497 [info ] [MainThread]: 
[0m18:49:33.440909 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m18:49:33.441858 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.77118987, "process_user_time": 1.028097, "process_kernel_time": 0.083386, "process_mem_max_rss": "88956", "process_in_blocks": "38576", "process_out_blocks": "2736"}
[0m18:49:33.442339 [debug] [MainThread]: Command `dbt deps` succeeded at 18:49:33.442250 after 0.77 seconds
[0m18:49:33.442645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741ba54bffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741ba4f34b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741ba4f08790>]}
[0m18:49:33.442951 [debug] [MainThread]: Flushing usage events
[0m18:49:51.032937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279f59d3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279f41f5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279f41f5b70>]}


============================== 18:49:51.035078 | 3eb105c0-abd1-46fd-bdb0-2c50850a2b07 ==============================
[0m18:49:51.035078 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:49:51.035589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m18:49:51.531700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3eb105c0-abd1-46fd-bdb0-2c50850a2b07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279dc693c70>]}
[0m18:49:51.579684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3eb105c0-abd1-46fd-bdb0-2c50850a2b07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279dc6b6860>]}
[0m18:49:51.580498 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:49:51.591783 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:49:51.592479 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:49:51.592878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3eb105c0-abd1-46fd-bdb0-2c50850a2b07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279dc565ba0>]}
[0m18:49:53.338684 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:49:53.339191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3eb105c0-abd1-46fd-bdb0-2c50850a2b07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279dc3a81f0>]}
[0m18:49:53.461343 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.stg_research_questions' (models/staging/stg_research_questions.sql) depends on a source named 'raw.consolidated_research_questions' which was not found
[0m18:49:53.462150 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.4712534, "process_user_time": 3.691478, "process_kernel_time": 0.093179, "process_mem_max_rss": "161668", "process_in_blocks": "1168", "process_out_blocks": "8", "command_success": false}
[0m18:49:53.462707 [debug] [MainThread]: Command `dbt compile` failed at 18:49:53.462618 after 2.47 seconds
[0m18:49:53.463047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279f59d3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279dbd5c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279dc129b40>]}
[0m18:49:53.463406 [debug] [MainThread]: Flushing usage events
[0m18:52:15.059700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bb0fcd7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bb0e19aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bb0e19a9b0>]}


============================== 18:52:15.063147 | c6dcc85f-6218-4fb6-bf5c-5f454f214eea ==============================
[0m18:52:15.063147 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:52:15.063635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:52:16.123337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6dcc85f-6218-4fb6-bf5c-5f454f214eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf698fc70>]}
[0m18:52:16.189853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6dcc85f-6218-4fb6-bf5c-5f454f214eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf69b9e40>]}
[0m18:52:16.190935 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:52:16.212665 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:52:16.213885 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:52:16.214542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c6dcc85f-6218-4fb6-bf5c-5f454f214eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf6861ba0>]}
[0m18:52:17.693426 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:52:17.693913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c6dcc85f-6218-4fb6-bf5c-5f454f214eea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf650edd0>]}
[0m18:52:18.014525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m18:52:18.024359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6dcc85f-6218-4fb6-bf5c-5f454f214eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf6286890>]}
[0m18:52:18.153194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6dcc85f-6218-4fb6-bf5c-5f454f214eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf6476950>]}
[0m18:52:18.153739 [info ] [MainThread]: Found 3 models, 21 data tests, 2 sources, 651 macros
[0m18:52:18.154122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6dcc85f-6218-4fb6-bf5c-5f454f214eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf6323e20>]}
[0m18:52:18.155993 [info ] [MainThread]: 
[0m18:52:18.156485 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:52:18.157317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_staging'
[0m18:52:18.157855 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema'
[0m18:52:18.163684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_intermediate'
[0m18:52:18.173038 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m18:52:18.176956 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m18:52:18.180847 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m18:52:18.181375 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m18:52:18.181860 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m18:52:18.182384 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m18:52:18.182771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:18.183174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:18.183672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:18.694905 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b761b0-0001-5d03-0001-de660002fe2e
[0m18:52:18.696154 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:52:18.697556 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:52:18.698201 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:52:18.698959 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m18:52:18.719917 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b761b0-0001-5d03-0001-de660002fe36
[0m18:52:18.720389 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:52:18.720775 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:52:18.721037 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:52:18.721375 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m18:52:18.739663 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.556 seconds
[0m18:52:18.743363 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m18:52:18.840655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6dcc85f-6218-4fb6-bf5c-5f454f214eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf64eb430>]}
[0m18:52:18.841288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:18.841742 [info ] [MainThread]: 
[0m18:52:18.852021 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m18:52:18.852685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m18:52:18.853064 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m18:52:18.861400 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m18:52:18.862069 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m18:52:18.862731 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m18:52:18.863960 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m18:52:18.864458 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m18:52:18.864990 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m18:52:18.865523 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b
[0m18:52:18.865936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.int_research_questions_unified)
[0m18:52:18.866432 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c'
[0m18:52:18.866843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46)
[0m18:52:18.867298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.stg_research_questions, now test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b)
[0m18:52:18.867656 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m18:52:18.867999 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m18:52:18.868386 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m18:52:18.868868 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b
[0m18:52:18.871950 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m18:52:18.879747 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c"
[0m18:52:18.883637 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46"
[0m18:52:18.887634 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b"
[0m18:52:18.888109 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m18:52:18.888662 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m18:52:18.889032 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m18:52:18.889861 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m18:52:18.890213 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b
[0m18:52:18.890834 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m18:52:18.891428 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m18:52:18.891857 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m18:52:18.892557 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b
[0m18:52:18.893094 [debug] [Thread-4 (]: Began running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m18:52:18.893607 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m18:52:18.894090 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe)
[0m18:52:18.894508 [debug] [Thread-1 (]: Began running node test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6
[0m18:52:18.895014 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c, now test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428)
[0m18:52:18.895461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46, now model.research_questions_etl.consolidated_research_questions)
[0m18:52:18.895914 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m18:52:18.896350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b, now test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6)
[0m18:52:18.896786 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m18:52:18.897173 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m18:52:18.901062 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe"
[0m18:52:18.901466 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6
[0m18:52:18.906935 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428"
[0m18:52:18.910290 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m18:52:18.914354 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6"
[0m18:52:18.914812 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m18:52:18.915659 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m18:52:18.916389 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m18:52:18.916713 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6
[0m18:52:18.917087 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m18:52:18.917676 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m18:52:18.918067 [debug] [Thread-3 (]: Began running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m18:52:18.918760 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6
[0m18:52:18.919357 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m18:52:18.919737 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m18:52:18.920151 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe, now test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5)
[0m18:52:18.920591 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m18:52:18.921113 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739
[0m18:52:18.921649 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428, now test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14)
[0m18:52:18.921998 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m18:52:18.922383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6, now test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be)
[0m18:52:18.922925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.consolidated_research_questions, now test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739)
[0m18:52:18.923312 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m18:52:18.928127 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5"
[0m18:52:18.928616 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m18:52:18.929107 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739
[0m18:52:18.932743 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14"
[0m18:52:18.936206 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be"
[0m18:52:18.936687 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m18:52:18.939851 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739"
[0m18:52:18.940443 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m18:52:18.941199 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m18:52:18.941596 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m18:52:18.942360 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m18:52:18.942729 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739
[0m18:52:18.943196 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m18:52:18.943917 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m18:52:18.944359 [debug] [Thread-4 (]: Began running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m18:52:18.945104 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739
[0m18:52:18.945502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5, now test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6)
[0m18:52:18.945905 [debug] [Thread-1 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5
[0m18:52:18.946341 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14, now test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5)
[0m18:52:18.946844 [debug] [Thread-2 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m18:52:18.947258 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m18:52:18.947676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be, now test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5)
[0m18:52:18.948047 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m18:52:18.948438 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739, now test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960)
[0m18:52:18.952220 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6"
[0m18:52:18.952671 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5
[0m18:52:18.955733 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5"
[0m18:52:18.956175 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m18:52:18.960630 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5"
[0m18:52:18.961144 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m18:52:18.961600 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m18:52:18.965859 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960"
[0m18:52:18.966451 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5
[0m18:52:18.967094 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m18:52:18.967726 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m18:52:18.968403 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5
[0m18:52:18.968733 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m18:52:18.969191 [debug] [Thread-3 (]: Began running node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5
[0m18:52:18.969660 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m18:52:18.970085 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef
[0m18:52:18.970602 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m18:52:18.971161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6, now test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5)
[0m18:52:18.971644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5, now test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b)
[0m18:52:18.972006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5, now test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef)
[0m18:52:18.972374 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923
[0m18:52:18.972795 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5
[0m18:52:18.973223 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m18:52:18.973560 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef
[0m18:52:18.973921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960, now test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923)
[0m18:52:18.978314 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5"
[0m18:52:18.982137 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b"
[0m18:52:18.985571 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef"
[0m18:52:18.985965 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923
[0m18:52:18.986775 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5
[0m18:52:18.987202 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m18:52:18.991120 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923"
[0m18:52:18.991529 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef
[0m18:52:18.992248 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5
[0m18:52:18.993017 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m18:52:18.993700 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef
[0m18:52:18.994096 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923
[0m18:52:18.994546 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d
[0m18:52:18.995147 [debug] [Thread-4 (]: Began running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m18:52:18.995965 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923
[0m18:52:18.996394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5, now test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d)
[0m18:52:18.996887 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b, now test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752)
[0m18:52:18.997365 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d
[0m18:52:18.997776 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m18:52:19.001507 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d"
[0m18:52:19.005431 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752"
[0m18:52:19.006192 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d
[0m18:52:19.006867 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d
[0m18:52:19.007347 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m18:52:19.007954 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m18:52:19.008797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:19.009073 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef' was properly closed.
[0m18:52:19.009318 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923' was properly closed.
[0m18:52:19.009542 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d' was properly closed.
[0m18:52:19.009757 [debug] [MainThread]: Connection 'test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752' was properly closed.
[0m18:52:19.012211 [debug] [MainThread]: Command end result
[0m18:52:19.045741 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.0324597, "process_user_time": 4.332544, "process_kernel_time": 0.179561, "process_mem_max_rss": "174356", "process_in_blocks": "167104", "process_out_blocks": "4528"}
[0m18:52:19.046541 [debug] [MainThread]: Command `dbt compile` succeeded at 18:52:19.046427 after 4.03 seconds
[0m18:52:19.046928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bb0fcd7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf4f4f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70baf570df60>]}
[0m18:52:19.047302 [debug] [MainThread]: Flushing usage events
[0m18:52:47.453768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a653c77c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a653ca2f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a653ca2f4c0>]}


============================== 18:52:47.455857 | 860f9bc6-6d0d-4109-809b-13fa0d44dcd2 ==============================
[0m18:52:47.455857 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:52:47.456299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls --select source:raw.*', 'send_anonymous_usage_stats': 'True'}
[0m18:52:47.915199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '860f9bc6-6d0d-4109-809b-13fa0d44dcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6523200b80>]}
[0m18:52:47.960200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '860f9bc6-6d0d-4109-809b-13fa0d44dcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65233dde70>]}
[0m18:52:47.960924 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:52:47.972940 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:52:48.097301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:48.097704 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:48.102565 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m18:52:48.146031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '860f9bc6-6d0d-4109-809b-13fa0d44dcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6522e9c1f0>]}
[0m18:52:48.264210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '860f9bc6-6d0d-4109-809b-13fa0d44dcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6522e9f970>]}
[0m18:52:48.264771 [info ] [MainThread]: Found 3 models, 21 data tests, 2 sources, 651 macros
[0m18:52:48.265125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '860f9bc6-6d0d-4109-809b-13fa0d44dcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6522e9e9b0>]}
[0m18:52:48.266189 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.85491204, "process_user_time": 2.247267, "process_kernel_time": 0.115704, "process_mem_max_rss": "157788", "process_in_blocks": "26416", "process_out_blocks": "1472"}
[0m18:52:48.266671 [debug] [MainThread]: Command `dbt ls` succeeded at 18:52:48.266592 after 0.86 seconds
[0m18:52:48.266999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a653c77c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6522e9fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6522e9f970>]}
[0m18:52:48.267337 [debug] [MainThread]: Flushing usage events
[0m18:53:04.258521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7120732cfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712071b829e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712071b82980>]}


============================== 18:53:04.260899 | ed9f9030-28d8-4cae-a404-008ed1eff9cd ==============================
[0m18:53:04.260899 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:53:04.261477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:53:04.784373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed9f9030-28d8-4cae-a404-008ed1eff9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712071b335e0>]}
[0m18:53:04.828281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed9f9030-28d8-4cae-a404-008ed1eff9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712059f1a890>]}
[0m18:53:04.829082 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:53:04.842698 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:53:04.983364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:04.983724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:04.988153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m18:53:05.032539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed9f9030-28d8-4cae-a404-008ed1eff9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7120599e0130>]}
[0m18:53:05.147256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed9f9030-28d8-4cae-a404-008ed1eff9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7120599e1f60>]}
[0m18:53:05.147720 [info ] [MainThread]: Found 3 models, 21 data tests, 2 sources, 651 macros
[0m18:53:05.148027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed9f9030-28d8-4cae-a404-008ed1eff9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7120599e3220>]}
[0m18:53:05.149410 [info ] [MainThread]: 
[0m18:53:05.149884 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:05.153581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m18:53:05.154129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m18:53:05.165424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m18:53:05.169862 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m18:53:05.220864 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m18:53:05.223207 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m18:53:05.223587 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m18:53:05.223936 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m18:53:05.224269 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m18:53:05.224597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:05.224930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:05.225300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:05.838443 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.613 seconds
[0m18:53:05.839734 [debug] [ThreadPool]: On list_research_db: Close
[0m18:53:05.842136 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.618 seconds
[0m18:53:05.843173 [debug] [ThreadPool]: On list_research_db: Close
[0m18:53:05.857767 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.633 seconds
[0m18:53:05.858775 [debug] [ThreadPool]: On list_research_db: Close
[0m18:53:05.955070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now create_research_db_etl_schema_intermediate)
[0m18:53:05.956821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now create_research_db_etl_schema_staging)
[0m18:53:05.958020 [debug] [ThreadPool]: Creating schema "database: "research_db"
schema: "etl_schema_intermediate"
"
[0m18:53:05.959315 [debug] [ThreadPool]: Creating schema "database: "research_db"
schema: "etl_schema_staging"
"
[0m18:53:05.973829 [debug] [ThreadPool]: Using snowflake connection "create_research_db_etl_schema_intermediate"
[0m18:53:05.974847 [debug] [ThreadPool]: Using snowflake connection "create_research_db_etl_schema_staging"
[0m18:53:05.975151 [debug] [ThreadPool]: On create_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "create_research_db_etl_schema_intermediate"} */
create schema if not exists research_db.etl_schema_intermediate
[0m18:53:05.975444 [debug] [ThreadPool]: On create_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "create_research_db_etl_schema_staging"} */
create schema if not exists research_db.etl_schema_staging
[0m18:53:05.975705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:05.975959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:06.318887 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.343 seconds
[0m18:53:06.319811 [debug] [ThreadPool]: On create_research_db_etl_schema_staging: Close
[0m18:53:06.328771 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.353 seconds
[0m18:53:06.330180 [debug] [ThreadPool]: On create_research_db_etl_schema_intermediate: Close
[0m18:53:06.423940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_research_db_etl_schema_intermediate, now list_research_db_etl_schema_intermediate)
[0m18:53:06.424755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_research_db_etl_schema_staging, now list_research_db_etl_schema_staging)
[0m18:53:06.430640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m18:53:06.439077 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m18:53:06.441638 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m18:53:06.444131 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m18:53:06.444835 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m18:53:06.445354 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m18:53:06.445889 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m18:53:06.446575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:06.447158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:06.447806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:06.744258 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.297 seconds
[0m18:53:06.747733 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m18:53:06.871344 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.425 seconds
[0m18:53:06.876359 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m18:53:06.965235 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.517 seconds
[0m18:53:06.966849 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m18:53:07.111513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed9f9030-28d8-4cae-a404-008ed1eff9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712059c873a0>]}
[0m18:53:07.113343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:53:07.114348 [info ] [MainThread]: 
[0m18:53:07.125440 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m18:53:07.126955 [info ] [Thread-1 (]: 1 of 3 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m18:53:07.128208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m18:53:07.129301 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m18:53:07.146332 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m18:53:07.147248 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m18:53:07.169896 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m18:53:07.170866 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m18:53:07.171262 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM your_snowflake_database_name.your_snowflake_schema_name.consolidated_research_questions
        );
[0m18:53:07.171605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:07.471177 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b761b1-0001-5d30-0001-de660002cd1e
[0m18:53:07.471869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'YOUR_SNOWFLAKE_DATABASE_NAME' does not exist or not authorized.
[0m18:53:07.472291 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m18:53:07.543328 [debug] [Thread-1 (]: Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  002003 (02000): SQL compilation error:
  Database 'YOUR_SNOWFLAKE_DATABASE_NAME' does not exist or not authorized.
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m18:53:07.544644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9f9030-28d8-4cae-a404-008ed1eff9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712072695d50>]}
[0m18:53:07.545214 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model etl_schema_staging.stg_research_questions  [[31mERROR[0m in 0.42s]
[0m18:53:07.545733 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m18:53:07.546914 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m18:53:07.547350 [info ] [Thread-3 (]: 2 of 3 SKIP relation etl_schema_intermediate.int_research_questions_unified .... [[33mSKIP[0m]
[0m18:53:07.547722 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m18:53:07.548355 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m18:53:07.548821 [info ] [Thread-2 (]: 3 of 3 SKIP relation etl_schema.consolidated_research_questions ................ [[33mSKIP[0m]
[0m18:53:07.549257 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m18:53:07.550168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:07.550464 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m18:53:07.550713 [debug] [MainThread]: Connection 'list_research_db_etl_schema' was properly closed.
[0m18:53:07.550944 [debug] [MainThread]: Connection 'list_research_db_etl_schema_staging' was properly closed.
[0m18:53:07.551274 [info ] [MainThread]: 
[0m18:53:07.551615 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m18:53:07.552166 [debug] [MainThread]: Command end result
[0m18:53:07.583274 [info ] [MainThread]: 
[0m18:53:07.583695 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:53:07.583978 [info ] [MainThread]: 
[0m18:53:07.584306 [error] [MainThread]:   Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  002003 (02000): SQL compilation error:
  Database 'YOUR_SNOWFLAKE_DATABASE_NAME' does not exist or not authorized.
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m18:53:07.584571 [info ] [MainThread]: 
[0m18:53:07.584834 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m18:53:07.585565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3700533, "process_user_time": 2.915725, "process_kernel_time": 0.162984, "process_mem_max_rss": "169288", "process_in_blocks": "56648", "process_out_blocks": "2904", "command_success": false}
[0m18:53:07.586030 [debug] [MainThread]: Command `dbt run` failed at 18:53:07.585955 after 3.37 seconds
[0m18:53:07.586367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7120732cfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712059f1a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712058538d00>]}
[0m18:53:07.586678 [debug] [MainThread]: Flushing usage events
[0m18:54:39.003487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88b02effd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88b06740d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88b0675f90>]}


============================== 18:54:39.005521 | 1a1779d6-406b-475f-aefc-ff6bcd408519 ==============================
[0m18:54:39.005521 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:54:39.005974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m18:54:39.444283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a1779d6-406b-475f-aefc-ff6bcd408519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88b02156f0>]}
[0m18:54:39.493058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a1779d6-406b-475f-aefc-ff6bcd408519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88af4d2410>]}
[0m18:54:39.493779 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:54:39.504645 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:54:39.620858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:54:39.621917 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m18:54:39.857849 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:54:39.858316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a1779d6-406b-475f-aefc-ff6bcd408519', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8896ade170>]}
[0m18:54:40.122719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m18:54:40.133200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a1779d6-406b-475f-aefc-ff6bcd408519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88965e4130>]}
[0m18:54:40.235249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a1779d6-406b-475f-aefc-ff6bcd408519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88965e65f0>]}
[0m18:54:40.235822 [info ] [MainThread]: Found 21 data tests, 3 models, 2 sources, 651 macros
[0m18:54:40.236154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1779d6-406b-475f-aefc-ff6bcd408519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88965f20b0>]}
[0m18:54:40.237891 [info ] [MainThread]: 
[0m18:54:40.238418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:54:40.239310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema'
[0m18:54:40.245014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_intermediate'
[0m18:54:40.253192 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m18:54:40.253748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_staging'
[0m18:54:40.256338 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m18:54:40.256988 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m18:54:40.259122 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m18:54:40.259461 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m18:54:40.259821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:40.260129 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m18:54:40.260455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:40.262718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:40.740209 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.480 seconds
[0m18:54:40.744046 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m18:54:40.847734 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.585 seconds
[0m18:54:40.849013 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m18:54:40.850457 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.591 seconds
[0m18:54:40.851723 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m18:54:40.931100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1779d6-406b-475f-aefc-ff6bcd408519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88965dc070>]}
[0m18:54:40.931722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:40.932095 [info ] [MainThread]: 
[0m18:54:40.933702 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m18:54:40.934131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m18:54:40.934513 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m18:54:40.941860 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m18:54:40.942541 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m18:54:40.943343 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m18:54:40.944179 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m18:54:40.944607 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m18:54:40.945014 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m18:54:40.945408 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b
[0m18:54:40.945865 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.int_research_questions_unified)
[0m18:54:40.946458 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c'
[0m18:54:40.946978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46)
[0m18:54:40.947418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.stg_research_questions, now test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b)
[0m18:54:40.947877 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m18:54:40.948367 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m18:54:40.948789 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m18:54:40.949174 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b
[0m18:54:40.953371 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m18:54:40.960350 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c"
[0m18:54:40.963379 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46"
[0m18:54:40.966845 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b"
[0m18:54:40.967620 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m18:54:40.967974 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m18:54:40.968493 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m18:54:40.968931 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b
[0m18:54:40.969550 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m18:54:40.970122 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m18:54:40.970658 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m18:54:40.971332 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b
[0m18:54:40.971740 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m18:54:40.972195 [debug] [Thread-4 (]: Began running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m18:54:40.972705 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m18:54:40.973112 [debug] [Thread-1 (]: Began running node test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6
[0m18:54:40.973645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe)
[0m18:54:40.974078 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c, now test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428)
[0m18:54:40.974506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46, now model.research_questions_etl.consolidated_research_questions)
[0m18:54:40.974904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_valid_from.720fe4d26b, now test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6)
[0m18:54:40.975281 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m18:54:40.975618 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m18:54:40.975944 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m18:54:40.976310 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6
[0m18:54:40.979801 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe"
[0m18:54:40.985267 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428"
[0m18:54:40.987938 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m18:54:40.991089 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6"
[0m18:54:40.991749 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m18:54:40.992191 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m18:54:40.992587 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m18:54:40.993183 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m18:54:40.993490 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6
[0m18:54:40.994088 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m18:54:40.994653 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m18:54:40.995068 [debug] [Thread-3 (]: Began running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m18:54:40.995667 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6
[0m18:54:40.996091 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m18:54:40.996475 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m18:54:40.997021 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe, now test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5)
[0m18:54:40.997421 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739
[0m18:54:40.997831 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428, now test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14)
[0m18:54:40.998218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.consolidated_research_questions, now test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be)
[0m18:54:40.998545 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m18:54:40.998909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_int_research_questions_unified_is_active__True__False.298fcbb9a6, now test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739)
[0m18:54:40.999273 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m18:54:40.999574 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m18:54:41.003044 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5"
[0m18:54:41.003405 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739
[0m18:54:41.006336 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14"
[0m18:54:41.010213 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be"
[0m18:54:41.013586 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739"
[0m18:54:41.014053 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m18:54:41.014656 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m18:54:41.015057 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m18:54:41.015623 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739
[0m18:54:41.016296 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m18:54:41.017038 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m18:54:41.017599 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m18:54:41.018173 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739
[0m18:54:41.018569 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m18:54:41.019034 [debug] [Thread-4 (]: Began running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m18:54:41.019437 [debug] [Thread-2 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5
[0m18:54:41.020022 [debug] [Thread-1 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m18:54:41.020426 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5, now test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6)
[0m18:54:41.020917 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14, now test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5)
[0m18:54:41.021349 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be, now test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5)
[0m18:54:41.021755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_valid_from.7f789ce739, now test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960)
[0m18:54:41.022130 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m18:54:41.022454 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m18:54:41.022737 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5
[0m18:54:41.023071 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m18:54:41.026254 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6"
[0m18:54:41.029126 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5"
[0m18:54:41.032080 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5"
[0m18:54:41.035831 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960"
[0m18:54:41.036397 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m18:54:41.036929 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m18:54:41.037380 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5
[0m18:54:41.037772 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m18:54:41.038407 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m18:54:41.038969 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m18:54:41.039519 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5
[0m18:54:41.040193 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m18:54:41.040640 [debug] [Thread-3 (]: Began running node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5
[0m18:54:41.041117 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m18:54:41.041542 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef
[0m18:54:41.042016 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923
[0m18:54:41.042446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6, now test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5)
[0m18:54:41.042836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5, now test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b)
[0m18:54:41.043181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True.7432c695b5, now test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef)
[0m18:54:41.043588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960, now test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923)
[0m18:54:41.043957 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5
[0m18:54:41.044292 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m18:54:41.044616 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef
[0m18:54:41.044927 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923
[0m18:54:41.048480 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5"
[0m18:54:41.051934 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b"
[0m18:54:41.054985 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef"
[0m18:54:41.057904 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923"
[0m18:54:41.058521 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5
[0m18:54:41.059553 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5
[0m18:54:41.060032 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d
[0m18:54:41.060388 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m18:54:41.060782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__valid_from.f081bca9f5, now test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d)
[0m18:54:41.061239 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923
[0m18:54:41.061841 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m18:54:41.062163 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef
[0m18:54:41.062557 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d
[0m18:54:41.063155 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923
[0m18:54:41.063543 [debug] [Thread-4 (]: Began running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m18:54:41.064114 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef
[0m18:54:41.067893 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d"
[0m18:54:41.068771 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b, now test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752)
[0m18:54:41.069555 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m18:54:41.073951 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752"
[0m18:54:41.074376 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d
[0m18:54:41.075012 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d
[0m18:54:41.075369 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m18:54:41.075924 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m18:54:41.076794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:41.077057 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_year.54ade7b09d' was properly closed.
[0m18:54:41.077310 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_question_text.a65e33deef' was properly closed.
[0m18:54:41.077539 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_valid_from.82f83a4923' was properly closed.
[0m18:54:41.077766 [debug] [MainThread]: Connection 'test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752' was properly closed.
[0m18:54:41.080201 [debug] [MainThread]: Command end result
[0m18:54:41.166185 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.2007654, "process_user_time": 3.044557, "process_kernel_time": 0.108734, "process_mem_max_rss": "175216", "process_in_blocks": "80", "process_out_blocks": "4520"}
[0m18:54:41.166742 [debug] [MainThread]: Command `dbt compile` succeeded at 18:54:41.166654 after 2.20 seconds
[0m18:54:41.167074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88b02effd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88955db910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88955d87f0>]}
[0m18:54:41.167417 [debug] [MainThread]: Flushing usage events
[0m18:54:44.513056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73574c5b7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73574ade6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73574ade69b0>]}


============================== 18:54:44.515149 | b9755077-a5e0-4bdd-a22f-e4d31c7fd8a1 ==============================
[0m18:54:44.515149 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:54:44.515640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:54:44.925188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9755077-a5e0-4bdd-a22f-e4d31c7fd8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735733293c70>]}
[0m18:54:44.968934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9755077-a5e0-4bdd-a22f-e4d31c7fd8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357332b6860>]}
[0m18:54:44.969690 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:54:44.981242 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:54:45.096850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:45.097408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:45.102112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m18:54:45.144360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9755077-a5e0-4bdd-a22f-e4d31c7fd8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735732d0c130>]}
[0m18:54:45.245285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9755077-a5e0-4bdd-a22f-e4d31c7fd8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735732d0c100>]}
[0m18:54:45.245755 [info ] [MainThread]: Found 21 data tests, 3 models, 2 sources, 651 macros
[0m18:54:45.246068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9755077-a5e0-4bdd-a22f-e4d31c7fd8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735732d0e350>]}
[0m18:54:45.247509 [info ] [MainThread]: 
[0m18:54:45.247984 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:54:45.251726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m18:54:45.259159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m18:54:45.313798 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m18:54:45.315739 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m18:54:45.316194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m18:54:45.316551 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m18:54:45.316985 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m18:54:45.318837 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m18:54:45.319221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:45.319581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:45.319880 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m18:54:45.322954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:45.656095 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.333 seconds
[0m18:54:45.659577 [debug] [ThreadPool]: On list_research_db: Close
[0m18:54:45.664519 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.345 seconds
[0m18:54:45.667368 [debug] [ThreadPool]: On list_research_db: Close
[0m18:54:45.831422 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.512 seconds
[0m18:54:45.834970 [debug] [ThreadPool]: On list_research_db: Close
[0m18:54:45.935835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m18:54:45.936419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m18:54:45.937432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m18:54:45.949301 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m18:54:45.950473 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m18:54:45.953703 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m18:54:45.954210 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m18:54:45.954524 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m18:54:45.954885 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m18:54:45.955327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:45.955626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:45.955965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:46.224181 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.269 seconds
[0m18:54:46.228153 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m18:54:46.320823 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.365 seconds
[0m18:54:46.324034 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m18:54:46.446618 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.491 seconds
[0m18:54:46.450070 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m18:54:46.543942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9755077-a5e0-4bdd-a22f-e4d31c7fd8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735733167c70>]}
[0m18:54:46.545523 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:46.546527 [info ] [MainThread]: 
[0m18:54:46.550859 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m18:54:46.552332 [info ] [Thread-1 (]: 1 of 3 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m18:54:46.553548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m18:54:46.554534 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m18:54:46.571712 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m18:54:46.572351 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m18:54:46.595591 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m18:54:46.596480 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m18:54:46.596874 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM research_db.etl_schema.consolidated_research_questions
        );
[0m18:54:46.597177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:48.067374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.470 seconds
[0m18:54:48.095622 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m18:54:48.184688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9755077-a5e0-4bdd-a22f-e4d31c7fd8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735733292b90>]}
[0m18:54:48.186353 [info ] [Thread-1 (]: 1 of 3 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 1.63s]
[0m18:54:48.188029 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m18:54:48.189893 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m18:54:48.191190 [info ] [Thread-3 (]: 2 of 3 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m18:54:48.192649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.int_research_questions_unified)
[0m18:54:48.193590 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m18:54:48.199728 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m18:54:48.200440 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m18:54:48.204498 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m18:54:48.206617 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m18:54:48.207373 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (-- File: dbt/models/intermediate/int_research_questions_unified.sql



/*
  This model unifies research questions with their categories and determines their current status.
  It serves as an intermediate step before creating the final consolidated view.
*/

WITH questions_with_categories AS (
    SELECT
        q.question_id,
        q.year,
        q.question_text,
        COALESCE(c.category_name, 'Uncategorized') AS category_name,
        q.is_active,
        q.valid_from,
        q.valid_to,
        q.answer_set
    FROM research_db.etl_schema_staging.stg_research_questions q
    LEFT JOIN research_db.etl_schema.question_categories c ON q.category = c.category_id
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions_with_categories
        );
[0m18:54:48.207982 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:54:48.595302 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b761b2-0001-5d03-0001-de660002fe62
[0m18:54:48.596452 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RESEARCH_DB.ETL_SCHEMA.QUESTION_CATEGORIES' does not exist or not authorized.
[0m18:54:48.597727 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m18:54:48.706805 [debug] [Thread-3 (]: Database Error in model int_research_questions_unified (models/intermediate/int_research_questions_unified.sql)
  002003 (42S02): SQL compilation error:
  Object 'RESEARCH_DB.ETL_SCHEMA.QUESTION_CATEGORIES' does not exist or not authorized.
  compiled code at target/run/research_questions_etl/models/intermediate/int_research_questions_unified.sql
[0m18:54:48.708174 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9755077-a5e0-4bdd-a22f-e4d31c7fd8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735731771150>]}
[0m18:54:48.709711 [error] [Thread-3 (]: 2 of 3 ERROR creating sql table model etl_schema_intermediate.int_research_questions_unified  [[31mERROR[0m in 0.52s]
[0m18:54:48.711288 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m18:54:48.714354 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m18:54:48.715498 [info ] [Thread-2 (]: 3 of 3 SKIP relation etl_schema.consolidated_research_questions ................ [[33mSKIP[0m]
[0m18:54:48.716692 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m18:54:48.719252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:48.720159 [debug] [MainThread]: Connection 'model.research_questions_etl.int_research_questions_unified' was properly closed.
[0m18:54:48.721155 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m18:54:48.721944 [debug] [MainThread]: Connection 'list_research_db_etl_schema' was properly closed.
[0m18:54:48.723092 [info ] [MainThread]: 
[0m18:54:48.724460 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m18:54:48.726469 [debug] [MainThread]: Command end result
[0m18:54:48.760569 [info ] [MainThread]: 
[0m18:54:48.761036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:54:48.761419 [info ] [MainThread]: 
[0m18:54:48.761780 [error] [MainThread]:   Database Error in model int_research_questions_unified (models/intermediate/int_research_questions_unified.sql)
  002003 (42S02): SQL compilation error:
  Object 'RESEARCH_DB.ETL_SCHEMA.QUESTION_CATEGORIES' does not exist or not authorized.
  compiled code at target/run/research_questions_etl/models/intermediate/int_research_questions_unified.sql
[0m18:54:48.762056 [info ] [MainThread]: 
[0m18:54:48.762351 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m18:54:48.763021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.287355, "process_user_time": 2.807771, "process_kernel_time": 0.093791, "process_mem_max_rss": "170292", "process_in_blocks": "56", "process_out_blocks": "2920", "command_success": false}
[0m18:54:48.763535 [debug] [MainThread]: Command `dbt run` failed at 18:54:48.763450 after 4.29 seconds
[0m18:54:48.763883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73574c5b7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357330b5f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357321df580>]}
[0m18:54:48.764213 [debug] [MainThread]: Flushing usage events
[0m18:58:50.662587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72542dedfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72542c79a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72542c79a980>]}


============================== 18:58:50.666024 | 62f70cb3-c4af-42c4-bb17-ed12efddaf56 ==============================
[0m18:58:50.666024 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:58:50.666575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:58:51.765600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72542c74b5e0>]}
[0m18:58:51.853505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725414bba890>]}
[0m18:58:51.855624 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:58:51.893845 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:58:52.178496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m18:58:52.180451 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m18:58:52.181214 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m18:58:52.181869 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m18:58:52.539016 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:58:52.539544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725414614550>]}
[0m18:58:52.828502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m18:58:52.839673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7254141e0130>]}
[0m18:58:52.956931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7254141f6710>]}
[0m18:58:52.957447 [info ] [MainThread]: Found 21 data tests, 3 models, 1 source, 651 macros
[0m18:58:52.957789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7254141f6560>]}
[0m18:58:52.959282 [info ] [MainThread]: 
[0m18:58:52.959788 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:58:52.963771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m18:58:52.964451 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m18:58:52.970716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m18:58:52.976460 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m18:58:52.978577 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m18:58:52.980912 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m18:58:52.981463 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m18:58:52.981829 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m18:58:52.982188 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m18:58:52.982755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:52.983152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:52.983497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:53.518767 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.536 seconds
[0m18:58:53.519503 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m18:58:53.520383 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m18:58:53.521661 [debug] [ThreadPool]: On list_research_db: Close
[0m18:58:53.522768 [debug] [ThreadPool]: On list_research_db: Close
[0m18:58:53.523847 [debug] [ThreadPool]: On list_research_db: Close
[0m18:58:53.622644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m18:58:53.624034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m18:58:53.625475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m18:58:53.661886 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m18:58:53.665341 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m18:58:53.671325 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m18:58:53.671920 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m18:58:53.672564 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m18:58:53.673212 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m18:58:53.673878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:53.674504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:53.675075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:53.970542 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.295 seconds
[0m18:58:53.974171 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m18:58:53.978897 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.304 seconds
[0m18:58:53.982245 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m18:58:54.103365 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.429 seconds
[0m18:58:54.106603 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m18:58:54.194671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725413157a90>]}
[0m18:58:54.196165 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:54.197116 [info ] [MainThread]: 
[0m18:58:54.202012 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m18:58:54.203518 [info ] [Thread-1 (]: 1 of 3 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m18:58:54.204941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m18:58:54.205932 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m18:58:54.222162 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m18:58:54.223261 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m18:58:54.246134 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m18:58:54.247047 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m18:58:54.247422 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m18:58:54.247693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:54.937408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m18:58:54.965943 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m18:58:55.063061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725414b96b60>]}
[0m18:58:55.064841 [info ] [Thread-1 (]: 1 of 3 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 0.86s]
[0m18:58:55.066525 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m18:58:55.068294 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m18:58:55.069647 [info ] [Thread-3 (]: 2 of 3 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m18:58:55.071425 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.int_research_questions_unified)
[0m18:58:55.072545 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m18:58:55.081974 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m18:58:55.089936 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m18:58:55.097965 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m18:58:55.100245 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m18:58:55.101022 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m18:58:55.101916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:56.267180 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.165 seconds
[0m18:58:56.271094 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m18:58:56.358778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725412dc7160>]}
[0m18:58:56.360697 [info ] [Thread-3 (]: 2 of 3 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.29s]
[0m18:58:56.362359 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m18:58:56.364422 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m18:58:56.365785 [info ] [Thread-2 (]: 3 of 3 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m18:58:56.366980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.consolidated_research_questions)
[0m18:58:56.368460 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m18:58:56.382247 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m18:58:56.383635 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m18:58:56.386915 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m18:58:56.388030 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m18:58:56.388409 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    question_status,
    answer_set
FROM research_db.etl_schema_intermediate.int_research_questions_unified
WHERE question_status = 'Current' AND is_active = true


        );
[0m18:58:56.388853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:57.329879 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.941 seconds
[0m18:58:57.335489 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m18:58:57.424049 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f70cb3-c4af-42c4-bb17-ed12efddaf56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7254131d0a90>]}
[0m18:58:57.425783 [info ] [Thread-2 (]: 3 of 3 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 1.06s]
[0m18:58:57.427283 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m18:58:57.429994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:57.430917 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m18:58:57.431773 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m18:58:57.432595 [debug] [MainThread]: Connection 'model.research_questions_etl.int_research_questions_unified' was properly closed.
[0m18:58:57.433622 [info ] [MainThread]: 
[0m18:58:57.434697 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m18:58:57.437334 [debug] [MainThread]: Command end result
[0m18:58:57.534984 [info ] [MainThread]: 
[0m18:58:57.535465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:57.535762 [info ] [MainThread]: 
[0m18:58:57.536041 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:58:57.536906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9278684, "process_user_time": 4.019474, "process_kernel_time": 0.167811, "process_mem_max_rss": "175240", "process_in_blocks": "167272", "process_out_blocks": "4312"}
[0m18:58:57.537422 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:57.537345 after 6.93 seconds
[0m18:58:57.537760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72542dedfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725414cc8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72542c799e70>]}
[0m18:58:57.538133 [debug] [MainThread]: Flushing usage events
[0m19:11:50.222857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e58691dbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e58677a2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e58677a29b0>]}


============================== 19:11:50.225286 | 7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c ==============================
[0m19:11:50.225286 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:11:50.225745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'dbt', 'log_path': 'dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:50.673378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e58690fd6c0>]}
[0m19:11:50.717908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e58685b6020>]}
[0m19:11:50.718713 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:11:50.730888 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:11:50.871273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:50.871939 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m19:11:51.123941 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:11:51.124476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e584f9d65c0>]}
[0m19:11:51.289843 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m19:11:51.302329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e584f7acf70>]}
[0m19:11:51.413470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e584f8ff1f0>]}
[0m19:11:51.413936 [info ] [MainThread]: Found 21 data tests, 3 models, 1 source, 651 macros
[0m19:11:51.414256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e584f7ac0a0>]}
[0m19:11:51.415649 [info ] [MainThread]: 
[0m19:11:51.416112 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:11:51.419803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m19:11:51.420400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m19:11:51.426174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m19:11:51.434315 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m19:11:51.434964 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m19:11:51.438881 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m19:11:51.439418 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m19:11:51.439845 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m19:11:51.440370 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m19:11:51.440845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:51.441178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:51.441507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:51.740985 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.300 seconds
[0m19:11:51.744460 [debug] [ThreadPool]: On list_research_db: Close
[0m19:11:51.751196 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.310 seconds
[0m19:11:51.753727 [debug] [ThreadPool]: On list_research_db: Close
[0m19:11:52.111911 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.670 seconds
[0m19:11:52.113125 [debug] [ThreadPool]: On list_research_db: Close
[0m19:11:52.205641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m19:11:52.206282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m19:11:52.207362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m19:11:52.219698 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m19:11:52.220984 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m19:11:52.223658 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m19:11:52.224040 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m19:11:52.224438 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m19:11:52.224725 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m19:11:52.225003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:52.225279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:52.225541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:52.533262 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.308 seconds
[0m19:11:52.537255 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m19:11:52.541872 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.316 seconds
[0m19:11:52.545825 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m19:11:52.704502 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.479 seconds
[0m19:11:52.708409 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m19:11:52.794195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e584fefa740>]}
[0m19:11:52.795653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:11:52.796445 [info ] [MainThread]: 
[0m19:11:52.799370 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m19:11:52.800094 [info ] [Thread-1 (]: 1 of 3 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m19:11:52.800700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m19:11:52.801185 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m19:11:52.812454 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m19:11:52.814130 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m19:11:52.851693 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m19:11:52.853536 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m19:11:52.854127 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m19:11:52.854654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:53.566508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m19:11:53.595808 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m19:11:53.672615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e584fefab90>]}
[0m19:11:53.674345 [info ] [Thread-1 (]: 1 of 3 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 0.87s]
[0m19:11:53.675853 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m19:11:53.677897 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m19:11:53.679203 [info ] [Thread-3 (]: 2 of 3 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m19:11:53.680390 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.int_research_questions_unified)
[0m19:11:53.681307 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m19:11:53.686841 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m19:11:53.693984 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m19:11:53.698171 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m19:11:53.699751 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m19:11:53.700151 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m19:11:53.700523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:11:55.072397 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.372 seconds
[0m19:11:55.074488 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m19:11:55.169716 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e584e1641f0>]}
[0m19:11:55.171568 [info ] [Thread-3 (]: 2 of 3 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.49s]
[0m19:11:55.173077 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m19:11:55.175223 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m19:11:55.176590 [info ] [Thread-2 (]: 3 of 3 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m19:11:55.177834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.consolidated_research_questions)
[0m19:11:55.179424 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m19:11:55.188512 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m19:11:55.190014 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m19:11:55.195015 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m19:11:55.196195 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m19:11:55.196620 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (

/*
    This model represents the final, consolidated view of research questions.
    It includes only current and active questions, ready for analysis and reporting.
*/

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    question_status,
    answer_set
FROM research_db.etl_schema_intermediate.int_research_questions_unified
WHERE question_status = 'Current' AND is_active = true


        );
[0m19:11:55.196988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:11:55.862964 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m19:11:55.867320 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m19:11:55.932186 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d19e5dc-c1cb-4155-9ade-b9f0f8c05d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e584d76a2f0>]}
[0m19:11:55.932904 [info ] [Thread-2 (]: 3 of 3 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 0.75s]
[0m19:11:55.933458 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m19:11:55.934412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:55.934748 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m19:11:55.935033 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m19:11:55.935288 [debug] [MainThread]: Connection 'model.research_questions_etl.int_research_questions_unified' was properly closed.
[0m19:11:55.935646 [info ] [MainThread]: 
[0m19:11:55.936002 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m19:11:55.936777 [debug] [MainThread]: Command end result
[0m19:11:55.970456 [info ] [MainThread]: 
[0m19:11:55.971004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:11:55.971380 [info ] [MainThread]: 
[0m19:11:55.971712 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:11:55.972620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7916527, "process_user_time": 3.268123, "process_kernel_time": 0.122666, "process_mem_max_rss": "174604", "process_in_blocks": "39824", "process_out_blocks": "4320"}
[0m19:11:55.973089 [debug] [MainThread]: Command `dbt run` succeeded at 19:11:55.973011 after 5.79 seconds
[0m19:11:55.973423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e58691dbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e58690fd6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e58685b7850>]}
[0m19:11:55.973749 [debug] [MainThread]: Flushing usage events
[0m19:15:49.126371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96d28dbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96d118e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96d118e0e0>]}


============================== 19:15:49.129143 | a5e008b5-9add-439a-8c39-18a011f3b432 ==============================
[0m19:15:49.129143 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:15:49.129742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'profiles_dir': 'dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:15:49.583093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b95e3ca0>]}
[0m19:15:49.634187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b95937c0>]}
[0m19:15:49.635035 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:15:49.647284 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:15:49.788484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:15:49.789176 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m19:15:50.026049 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:15:50.026525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b9377460>]}
[0m19:15:50.187552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m19:15:50.200290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b8e98ee0>]}
[0m19:15:50.312343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b9011db0>]}
[0m19:15:50.312830 [info ] [MainThread]: Found 21 data tests, 3 models, 1 source, 651 macros
[0m19:15:50.313158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b8e98490>]}
[0m19:15:50.314576 [info ] [MainThread]: 
[0m19:15:50.315060 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:50.318811 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m19:15:50.325104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m19:15:50.331025 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m19:15:50.333435 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m19:15:50.333911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m19:15:50.334438 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m19:15:50.334791 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m19:15:50.337023 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m19:15:50.337447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:50.338001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:50.338571 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m19:15:50.343343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:50.680737 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.343 seconds
[0m19:15:50.684297 [debug] [ThreadPool]: On list_research_db: Close
[0m19:15:50.784454 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.441 seconds
[0m19:15:50.787726 [debug] [ThreadPool]: On list_research_db: Close
[0m19:15:50.929978 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.592 seconds
[0m19:15:50.933357 [debug] [ThreadPool]: On list_research_db: Close
[0m19:15:51.013446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m19:15:51.014923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m19:15:51.023062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m19:15:51.036151 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m19:15:51.039968 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m19:15:51.043242 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m19:15:51.044099 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m19:15:51.044988 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m19:15:51.045885 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m19:15:51.046801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:51.047888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:51.048732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:51.347131 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.298 seconds
[0m19:15:51.351052 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m19:15:51.366484 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.318 seconds
[0m19:15:51.370152 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m19:15:51.389013 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.342 seconds
[0m19:15:51.393147 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m19:15:51.489198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b91e6d70>]}
[0m19:15:51.490753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:51.491848 [info ] [MainThread]: 
[0m19:15:51.503547 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m19:15:51.504958 [info ] [Thread-1 (]: 1 of 3 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m19:15:51.506183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.stg_research_questions)
[0m19:15:51.507298 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m19:15:51.524175 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m19:15:51.525425 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m19:15:51.548980 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m19:15:51.550460 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m19:15:51.551002 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m19:15:51.551451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:52.260123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m19:15:52.289998 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m19:15:52.376425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b9592aa0>]}
[0m19:15:52.377071 [info ] [Thread-1 (]: 1 of 3 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 0.87s]
[0m19:15:52.377710 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m19:15:52.378604 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m19:15:52.379362 [info ] [Thread-3 (]: 2 of 3 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m19:15:52.379939 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.int_research_questions_unified)
[0m19:15:52.380268 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m19:15:52.382857 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m19:15:52.389857 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m19:15:52.393775 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m19:15:52.395175 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m19:15:52.395711 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m19:15:52.396048 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:53.292801 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.897 seconds
[0m19:15:53.298499 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m19:15:53.400274 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b803f580>]}
[0m19:15:53.400957 [info ] [Thread-3 (]: 2 of 3 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.02s]
[0m19:15:53.401569 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m19:15:53.402245 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m19:15:53.402712 [info ] [Thread-2 (]: 3 of 3 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m19:15:53.403129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.consolidated_research_questions)
[0m19:15:53.403484 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m19:15:53.407003 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m19:15:53.407739 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m19:15:53.410371 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m19:15:53.412043 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m19:15:53.412515 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (-- 

-- /*
--     This model represents the final, consolidated view of research questions.
--     It includes only current and active questions, ready for analysis and reporting.
-- */

-- SELECT
--     question_id,
--     year,
--     question_text,
--     category,
--     is_active,
--     valid_from,
--     valid_to,
--     question_status,
--     answer_set
-- FROM research_db.etl_schema_intermediate.int_research_questions_unified
-- WHERE question_status = 'Current' AND is_active = true

-- 



WITH deduplicated_questions AS (
    SELECT DISTINCT *
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
),

classified_questions AS (
    SELECT
        *,
        CASE
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) = 2 THEN 'Binary'
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) <= 4 THEN 'Multiple Choice'
            ELSE 'Extended Multiple Choice'
        END AS question_type,
        CASE
            WHEN category LIKE '%Topic%' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS standardized_category
    FROM deduplicated_questions
),

final AS (
    SELECT
        question_id,
        year,
        question_text,
        standardized_category AS category,
        question_type,
        is_active,
        valid_from,
        valid_to,
        question_status,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text
    FROM classified_questions
)

SELECT
    *,
    CASE
        WHEN previous_question_text IS NULL THEN 'New'
        WHEN question_text != previous_question_text THEN 'Modified'
        ELSE 'Unchanged'
    END AS question_change_status
FROM final
WHERE question_status = 'Current' AND is_active = true
        );
[0m19:15:53.412876 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:54.307107 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.894 seconds
[0m19:15:54.313706 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m19:15:54.398199 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5e008b5-9add-439a-8c39-18a011f3b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b81241f0>]}
[0m19:15:54.399907 [info ] [Thread-2 (]: 3 of 3 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 0.99s]
[0m19:15:54.401427 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m19:15:54.404537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:54.405477 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m19:15:54.406279 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m19:15:54.407066 [debug] [MainThread]: Connection 'model.research_questions_etl.int_research_questions_unified' was properly closed.
[0m19:15:54.408180 [info ] [MainThread]: 
[0m19:15:54.409224 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m19:15:54.411632 [debug] [MainThread]: Command end result
[0m19:15:54.448090 [info ] [MainThread]: 
[0m19:15:54.448564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:54.448898 [info ] [MainThread]: 
[0m19:15:54.449198 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:15:54.450144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.3647294, "process_user_time": 3.596555, "process_kernel_time": 0.149023, "process_mem_max_rss": "174876", "process_in_blocks": "40648", "process_out_blocks": "4336"}
[0m19:15:54.450646 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:54.450562 after 5.37 seconds
[0m19:15:54.450970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96d28dbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b90bf040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c96b8166890>]}
[0m19:15:54.451302 [debug] [MainThread]: Flushing usage events
[0m20:31:28.329561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916b63efeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916b67b6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916b67b60e0>]}


============================== 20:31:28.331782 | 836e3830-8b2f-44f8-a9a4-498b8d0a81da ==============================
[0m20:31:28.331782 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:31:28.332233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'profiles_dir': 'dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:31:28.733040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916b63116c0>]}
[0m20:31:28.773644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916b55d2020>]}
[0m20:31:28.774430 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:31:28.785525 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:31:28.908695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:31:28.909284 [debug] [MainThread]: Partial parsing: added file: research_questions_etl://models/marts/answer_option_analysis.sql
[0m20:31:29.091217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m20:31:29.102289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79169cb40430>]}
[0m20:31:29.262655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79169d0098d0>]}
[0m20:31:29.263149 [info ] [MainThread]: Found 21 data tests, 4 models, 1 source, 651 macros
[0m20:31:29.263540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79169d00a4a0>]}
[0m20:31:29.265068 [info ] [MainThread]: 
[0m20:31:29.265623 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:31:29.269664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:31:29.270410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:31:29.284048 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:31:29.284714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:31:29.287647 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:31:29.288233 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:31:29.290845 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:31:29.291219 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:31:29.291602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:29.291921 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:31:29.292256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:29.295087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:29.809002 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.517 seconds
[0m20:31:29.812483 [debug] [ThreadPool]: On list_research_db: Close
[0m20:31:29.817563 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.526 seconds
[0m20:31:29.822256 [debug] [ThreadPool]: On list_research_db: Close
[0m20:31:29.867916 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.573 seconds
[0m20:31:29.871320 [debug] [ThreadPool]: On list_research_db: Close
[0m20:31:29.968692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m20:31:29.976860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m20:31:29.994003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m20:31:30.005739 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m20:31:30.012000 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m20:31:30.016452 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m20:31:30.017301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:30.019972 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m20:31:30.020709 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m20:31:30.022898 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m20:31:30.025766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:30.027160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:30.376512 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.349 seconds
[0m20:31:30.378033 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m20:31:30.858496 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.841 seconds
[0m20:31:30.862035 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m20:31:30.921663 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.896 seconds
[0m20:31:30.925193 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m20:31:31.022568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916b637db10>]}
[0m20:31:31.024059 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:31:31.024988 [info ] [MainThread]: 
[0m20:31:31.036867 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m20:31:31.038115 [info ] [Thread-1 (]: 1 of 4 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m20:31:31.039210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.stg_research_questions)
[0m20:31:31.039817 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m20:31:31.049027 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m20:31:31.049641 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m20:31:31.073642 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m20:31:31.074567 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m20:31:31.074944 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m20:31:31.075261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:31.904488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m20:31:32.034504 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m20:31:32.218037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79169d116b90>]}
[0m20:31:32.221459 [info ] [Thread-1 (]: 1 of 4 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 1.18s]
[0m20:31:32.226373 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m20:31:32.245617 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m20:31:32.246704 [info ] [Thread-3 (]: 2 of 4 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m20:31:32.247599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.int_research_questions_unified)
[0m20:31:32.248217 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m20:31:32.271668 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m20:31:32.273194 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m20:31:32.277923 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m20:31:32.280507 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m20:31:32.281438 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m20:31:32.282208 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:31:34.355500 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.073 seconds
[0m20:31:34.361111 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m20:31:34.497301 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79169bf75ab0>]}
[0m20:31:34.499144 [info ] [Thread-3 (]: 2 of 4 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 2.25s]
[0m20:31:34.500711 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m20:31:34.502620 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m20:31:34.503896 [info ] [Thread-2 (]: 3 of 4 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m20:31:34.505243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.consolidated_research_questions)
[0m20:31:34.506392 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m20:31:34.523962 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m20:31:34.524699 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m20:31:34.527787 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m20:31:34.529378 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m20:31:34.529767 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (-- 

-- /*
--     This model represents the final, consolidated view of research questions.
--     It includes only current and active questions, ready for analysis and reporting.
-- */

-- SELECT
--     question_id,
--     year,
--     question_text,
--     category,
--     is_active,
--     valid_from,
--     valid_to,
--     question_status,
--     answer_set
-- FROM research_db.etl_schema_intermediate.int_research_questions_unified
-- WHERE question_status = 'Current' AND is_active = true

-- 



WITH deduplicated_questions AS (
    SELECT DISTINCT *
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
),

classified_questions AS (
    SELECT
        *,
        CASE
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) = 2 THEN 'Binary'
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) <= 4 THEN 'Multiple Choice'
            ELSE 'Extended Multiple Choice'
        END AS question_type,
        CASE
            WHEN category LIKE '%Topic%' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS standardized_category
    FROM deduplicated_questions
),

final AS (
    SELECT
        question_id,
        year,
        question_text,
        standardized_category AS category,
        question_type,
        is_active,
        valid_from,
        valid_to,
        question_status,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text
    FROM classified_questions
)

SELECT
    *,
    CASE
        WHEN previous_question_text IS NULL THEN 'New'
        WHEN question_text != previous_question_text THEN 'Modified'
        ELSE 'Unchanged'
    END AS question_change_status
FROM final
WHERE question_status = 'Current' AND is_active = true
        );
[0m20:31:34.530112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:31:36.607686 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.077 seconds
[0m20:31:36.613463 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m20:31:36.727613 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79169bf752a0>]}
[0m20:31:36.729385 [info ] [Thread-2 (]: 3 of 4 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 2.22s]
[0m20:31:36.730927 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m20:31:36.732919 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m20:31:36.734250 [info ] [Thread-4 (]: 4 of 4 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m20:31:36.735827 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m20:31:36.736835 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m20:31:36.745530 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m20:31:36.753625 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m20:31:36.759790 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m20:31:36.762413 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m20:31:36.762840 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m20:31:36.763167 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:31:37.854146 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.091 seconds
[0m20:31:37.856309 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m20:31:37.944917 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '836e3830-8b2f-44f8-a9a4-498b8d0a81da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79169bf74610>]}
[0m20:31:37.946621 [info ] [Thread-4 (]: 4 of 4 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 1.21s]
[0m20:31:37.948144 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m20:31:37.951236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:37.952581 [debug] [MainThread]: Connection 'model.research_questions_etl.int_research_questions_unified' was properly closed.
[0m20:31:37.953818 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m20:31:37.954798 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m20:31:37.955786 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m20:31:37.956764 [info ] [MainThread]: 
[0m20:31:37.957350 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m20:31:37.958910 [debug] [MainThread]: Command end result
[0m20:31:37.992012 [info ] [MainThread]: 
[0m20:31:37.992508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:37.992851 [info ] [MainThread]: 
[0m20:31:37.993137 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:31:37.994143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.700013, "process_user_time": 3.117798, "process_kernel_time": 0.140341, "process_mem_max_rss": "174396", "process_in_blocks": "35224", "process_out_blocks": "4384"}
[0m20:31:37.994645 [debug] [MainThread]: Command `dbt run` succeeded at 20:31:37.994567 after 9.70 seconds
[0m20:31:37.994981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916b63efeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79169cbf9c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7916b55d2020>]}
[0m20:31:37.995326 [debug] [MainThread]: Flushing usage events
[0m20:45:26.956476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fba7aeffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fba7e700a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fba7e71f90>]}


============================== 20:45:26.959328 | 6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329 ==============================
[0m20:45:26.959328 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:45:26.959767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:45:27.405755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8e8ad1e0>]}
[0m20:45:27.450157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fba631ad40>]}
[0m20:45:27.451036 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:45:27.464003 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:45:27.608655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:45:27.609249 [debug] [MainThread]: Partial parsing: added file: research_questions_etl://models/marts/question_evolution.sql
[0m20:45:27.609847 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m20:45:27.850383 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:45:27.850863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8e60d540>]}
[0m20:45:28.025057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m20:45:28.037336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8e1567d0>]}
[0m20:45:28.147507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8e1543d0>]}
[0m20:45:28.147969 [info ] [MainThread]: Found 22 data tests, 5 models, 1 source, 651 macros
[0m20:45:28.148309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8e154fd0>]}
[0m20:45:28.149754 [info ] [MainThread]: 
[0m20:45:28.150215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:45:28.154136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:45:28.154766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:45:28.165552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:45:28.169578 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:45:28.171976 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:45:28.174575 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:45:28.174989 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:45:28.175353 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:45:28.175688 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:45:28.176053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:28.176411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:28.176768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:28.486554 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.310 seconds
[0m20:45:28.487858 [debug] [ThreadPool]: On list_research_db: Close
[0m20:45:28.615600 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.439 seconds
[0m20:45:28.619131 [debug] [ThreadPool]: On list_research_db: Close
[0m20:45:28.822376 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.646 seconds
[0m20:45:28.825825 [debug] [ThreadPool]: On list_research_db: Close
[0m20:45:28.968325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m20:45:28.977399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m20:45:29.002250 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m20:45:29.003748 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m20:45:29.004362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:29.007739 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m20:45:29.008340 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m20:45:29.008853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:29.012833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m20:45:29.019305 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m20:45:29.020845 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m20:45:29.021720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:29.272718 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.268 seconds
[0m20:45:29.276421 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m20:45:29.295283 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.286 seconds
[0m20:45:29.298980 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m20:45:29.421888 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.400 seconds
[0m20:45:29.425596 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m20:45:29.577393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8dd25150>]}
[0m20:45:29.578003 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:45:29.578349 [info ] [MainThread]: 
[0m20:45:29.586816 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m20:45:29.587404 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m20:45:29.588015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m20:45:29.588425 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m20:45:29.596741 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m20:45:29.597425 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m20:45:29.622452 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m20:45:29.623415 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m20:45:29.623781 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m20:45:29.624088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:31.359412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.735 seconds
[0m20:45:31.380559 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m20:45:31.494660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8e8aebc0>]}
[0m20:45:31.496501 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 1.90s]
[0m20:45:31.498284 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m20:45:31.500372 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m20:45:31.501640 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m20:45:31.502878 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.int_research_questions_unified)
[0m20:45:31.503855 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m20:45:31.511545 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m20:45:31.513230 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m20:45:31.520454 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m20:45:31.521891 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m20:45:31.522418 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m20:45:31.522850 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:45:33.011103 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.488 seconds
[0m20:45:33.015391 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m20:45:33.102898 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8d1a4dc0>]}
[0m20:45:33.104703 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.60s]
[0m20:45:33.106346 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m20:45:33.108160 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m20:45:33.109528 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m20:45:33.111256 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.consolidated_research_questions)
[0m20:45:33.112662 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m20:45:33.127165 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m20:45:33.128311 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m20:45:33.131352 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m20:45:33.132880 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m20:45:33.133398 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (-- 

-- /*
--     This model represents the final, consolidated view of research questions.
--     It includes only current and active questions, ready for analysis and reporting.
-- */

-- SELECT
--     question_id,
--     year,
--     question_text,
--     category,
--     is_active,
--     valid_from,
--     valid_to,
--     question_status,
--     answer_set
-- FROM research_db.etl_schema_intermediate.int_research_questions_unified
-- WHERE question_status = 'Current' AND is_active = true

-- 



WITH deduplicated_questions AS (
    SELECT DISTINCT *
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
),

classified_questions AS (
    SELECT
        *,
        CASE
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) = 2 THEN 'Binary'
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) <= 4 THEN 'Multiple Choice'
            ELSE 'Extended Multiple Choice'
        END AS question_type,
        CASE
            WHEN category LIKE '%Topic%' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS standardized_category
    FROM deduplicated_questions
),

final AS (
    SELECT
        question_id,
        year,
        question_text,
        standardized_category AS category,
        question_type,
        is_active,
        valid_from,
        valid_to,
        question_status,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text
    FROM classified_questions
)

SELECT
    *,
    CASE
        WHEN previous_question_text IS NULL THEN 'New'
        WHEN question_text != previous_question_text THEN 'Modified'
        ELSE 'Unchanged'
    END AS question_change_status
FROM final
WHERE question_status = 'Current' AND is_active = true
        );
[0m20:45:33.133747 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:45:34.643895 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.510 seconds
[0m20:45:34.646186 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m20:45:34.916691 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8d19d360>]}
[0m20:45:34.918621 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 1.81s]
[0m20:45:34.920517 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m20:45:34.922617 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m20:45:34.923823 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m20:45:34.925359 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m20:45:34.927109 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m20:45:34.928905 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m20:45:34.930206 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m20:45:34.931397 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m20:45:34.931841 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m20:45:34.935209 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m20:45:34.940123 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m20:45:34.941211 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m20:45:34.941850 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m20:45:34.946106 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m20:45:34.949708 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m20:45:34.951967 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m20:45:34.952475 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (

WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set
    FROM research_db.etl_schema.consolidated_research_questions
)

SELECT
    question_id,
    year,
    question_text,
    category,
    answer_set,
    previous_question_text,
    previous_answer_set,
    CASE
        WHEN previous_question_text IS NULL THEN 'New Question'
        WHEN question_text != previous_question_text THEN 'Modified Question'
        WHEN answer_set != previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type,
    CASE
        WHEN answer_set != previous_answer_set THEN 
            (SELECT ARRAY_AGG(OBJECT_CONSTRUCT('action', 
                CASE
                    WHEN new.value IS NULL THEN 'removed'
                    WHEN old.value IS NULL THEN 'added'
                    ELSE 'modified'
                END,
                'option', COALESCE(new.value:OptionText, old.value:OptionText)))
            FROM TABLE(FLATTEN(PARSE_JSON(answer_set))) new
            FULL OUTER JOIN TABLE(FLATTEN(PARSE_JSON(previous_answer_set))) old
            ON new.value:OptionOrder = old.value:OptionOrder
            WHERE new.value != old.value OR new.value IS NULL OR old.value IS NULL)
        ELSE NULL
    END AS answer_set_changes
FROM question_history
ORDER BY year, question_id
        );
[0m20:45:34.952885 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:45:34.954858 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m20:45:34.955932 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m20:45:34.956361 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:45:35.432189 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b76221-0001-5d02-0001-de6600031616
[0m20:45:35.433523 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000002 (0A000): Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
[0m20:45:35.434870 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m20:45:35.520850 [debug] [Thread-3 (]: Database Error in model question_evolution (models/marts/question_evolution.sql)
  000002 (0A000): Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
  compiled code at target/run/research_questions_etl/models/marts/question_evolution.sql
[0m20:45:35.522258 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8cd9cf70>]}
[0m20:45:35.524033 [error] [Thread-3 (]: 5 of 5 ERROR creating sql table model etl_schema.question_evolution ............ [[31mERROR[0m in 0.59s]
[0m20:45:35.525680 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m20:45:36.596101 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.640 seconds
[0m20:45:36.600637 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m20:45:36.731416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8c6cc5-8fa8-4b96-bedf-f55a05dfd329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8cd9d150>]}
[0m20:45:36.732820 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 1.80s]
[0m20:45:36.733347 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m20:45:36.734321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:36.734623 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m20:45:36.734877 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m20:45:36.735110 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m20:45:36.735346 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m20:45:36.735668 [info ] [MainThread]: 
[0m20:45:36.735974 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.59 seconds (8.59s).
[0m20:45:36.736888 [debug] [MainThread]: Command end result
[0m20:45:36.777491 [info ] [MainThread]: 
[0m20:45:36.777970 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:45:36.778337 [info ] [MainThread]: 
[0m20:45:36.778722 [error] [MainThread]:   Database Error in model question_evolution (models/marts/question_evolution.sql)
  000002 (0A000): Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
  compiled code at target/run/research_questions_etl/models/marts/question_evolution.sql
[0m20:45:36.779032 [info ] [MainThread]: 
[0m20:45:36.779361 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:45:36.780257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.862147, "process_user_time": 3.275408, "process_kernel_time": 0.126362, "process_mem_max_rss": "177860", "process_in_blocks": "37224", "process_out_blocks": "4480", "command_success": false}
[0m20:45:36.780808 [debug] [MainThread]: Command `dbt run` failed at 20:45:36.780713 after 9.86 seconds
[0m20:45:36.781189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fba7aeffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fba631ad40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fb8e5a1420>]}
[0m20:45:36.781535 [debug] [MainThread]: Flushing usage events
[0m20:47:54.986745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21c90e7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21c94aea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21c94ae9b0>]}


============================== 20:47:54.989281 | 31599014-82ed-4aef-8467-83eca47e8ffa ==============================
[0m20:47:54.989281 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:47:54.989867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:47:55.503613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21c90056c0>]}
[0m20:47:55.556002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21c82c2020>]}
[0m20:47:55.556779 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:47:55.570242 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:47:55.711105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:55.711798 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m20:47:55.946776 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:47:55.947375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21af70b4f0>]}
[0m20:47:56.115100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m20:47:56.128033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21af3b8130>]}
[0m20:47:56.249687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21af3ba710>]}
[0m20:47:56.250277 [info ] [MainThread]: Found 22 data tests, 5 models, 1 source, 651 macros
[0m20:47:56.250675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21af3b9d20>]}
[0m20:47:56.252714 [info ] [MainThread]: 
[0m20:47:56.253381 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:47:56.257950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:47:56.258927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:47:56.264873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:47:56.276691 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:47:56.279940 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:47:56.283973 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:47:56.284708 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:47:56.285222 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:47:56.285713 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:47:56.286356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:56.286839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:56.287338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:56.698802 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.412 seconds
[0m20:47:56.699804 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.412 seconds
[0m20:47:56.701240 [debug] [ThreadPool]: On list_research_db: Close
[0m20:47:56.702514 [debug] [ThreadPool]: On list_research_db: Close
[0m20:47:56.707746 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.421 seconds
[0m20:47:56.709079 [debug] [ThreadPool]: On list_research_db: Close
[0m20:47:56.796568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m20:47:56.797227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m20:47:56.797917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m20:47:56.806416 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m20:47:56.809125 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m20:47:56.812016 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m20:47:56.812461 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m20:47:56.812851 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m20:47:56.813237 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m20:47:56.813557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:56.813882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:56.814183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:57.071569 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.258 seconds
[0m20:47:57.073071 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m20:47:57.097207 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.283 seconds
[0m20:47:57.098575 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m20:47:57.114040 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.300 seconds
[0m20:47:57.115605 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m20:47:57.199287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21af728880>]}
[0m20:47:57.199881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:47:57.200236 [info ] [MainThread]: 
[0m20:47:57.208670 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m20:47:57.209296 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m20:47:57.209801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m20:47:57.210193 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m20:47:57.218799 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m20:47:57.220035 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m20:47:57.246990 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m20:47:57.248899 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m20:47:57.249403 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m20:47:57.249743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:57.973574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.724 seconds
[0m20:47:57.992486 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m20:47:58.073576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21af30b8e0>]}
[0m20:47:58.074575 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 0.86s]
[0m20:47:58.075272 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m20:47:58.076053 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m20:47:58.076637 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m20:47:58.077057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.int_research_questions_unified)
[0m20:47:58.077383 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m20:47:58.080314 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m20:47:58.087256 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m20:47:58.090793 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m20:47:58.092064 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m20:47:58.092469 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m20:47:58.092784 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:47:58.937905 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m20:47:58.971461 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m20:47:59.072883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21adf50c70>]}
[0m20:47:59.074023 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.00s]
[0m20:47:59.074986 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m20:47:59.076385 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m20:47:59.077425 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m20:47:59.078441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.consolidated_research_questions)
[0m20:47:59.079194 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m20:47:59.090467 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m20:47:59.098733 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m20:47:59.106354 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m20:47:59.110434 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m20:47:59.111512 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (-- 

-- /*
--     This model represents the final, consolidated view of research questions.
--     It includes only current and active questions, ready for analysis and reporting.
-- */

-- SELECT
--     question_id,
--     year,
--     question_text,
--     category,
--     is_active,
--     valid_from,
--     valid_to,
--     question_status,
--     answer_set
-- FROM research_db.etl_schema_intermediate.int_research_questions_unified
-- WHERE question_status = 'Current' AND is_active = true

-- 



WITH deduplicated_questions AS (
    SELECT DISTINCT *
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
),

classified_questions AS (
    SELECT
        *,
        CASE
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) = 2 THEN 'Binary'
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) <= 4 THEN 'Multiple Choice'
            ELSE 'Extended Multiple Choice'
        END AS question_type,
        CASE
            WHEN category LIKE '%Topic%' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS standardized_category
    FROM deduplicated_questions
),

final AS (
    SELECT
        question_id,
        year,
        question_text,
        standardized_category AS category,
        question_type,
        is_active,
        valid_from,
        valid_to,
        question_status,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text
    FROM classified_questions
)

SELECT
    *,
    CASE
        WHEN previous_question_text IS NULL THEN 'New'
        WHEN question_text != previous_question_text THEN 'Modified'
        ELSE 'Unchanged'
    END AS question_change_status
FROM final
WHERE question_status = 'Current' AND is_active = true
        );
[0m20:47:59.112356 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:47:59.949183 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.837 seconds
[0m20:47:59.951442 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m20:48:00.033014 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21adf88880>]}
[0m20:48:00.033763 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 0.95s]
[0m20:48:00.034332 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m20:48:00.035105 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m20:48:00.035560 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m20:48:00.036035 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m20:48:00.036508 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m20:48:00.037004 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m20:48:00.037374 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m20:48:00.037695 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m20:48:00.037993 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m20:48:00.041153 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m20:48:00.043884 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m20:48:00.044568 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m20:48:00.047031 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m20:48:00.047591 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m20:48:00.049332 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m20:48:00.052094 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m20:48:00.052604 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (

WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set
    FROM research_db.etl_schema.consolidated_research_questions
),

answer_set_changes AS (
    SELECT
        question_id,
        year,
        ARRAY_AGG(OBJECT_CONSTRUCT('action', 
            CASE
                WHEN new_option IS NULL THEN 'removed'
                WHEN old_option IS NULL THEN 'added'
                WHEN new_option != old_option THEN 'modified'
                ELSE 'unchanged'
            END,
            'old_option', old_option,
            'new_option', new_option
        )) AS changes
    FROM (
        SELECT 
            qh.question_id,
            qh.year,
            no.value::STRING AS new_option,
            oo.value::STRING AS old_option
        FROM question_history qh,
        LATERAL FLATTEN(input => PARSE_JSON(qh.answer_set)) no
        FULL OUTER JOIN LATERAL FLATTEN(input => PARSE_JSON(qh.previous_answer_set)) oo
        ON no.index = oo.index
        WHERE qh.answer_set != qh.previous_answer_set
    )
    GROUP BY question_id, year
)

SELECT
    qh.question_id,
    qh.year,
    qh.question_text,
    qh.category,
    qh.answer_set,
    qh.previous_question_text,
    qh.previous_answer_set,
    CASE
        WHEN qh.previous_question_text IS NULL THEN 'New Question'
        WHEN qh.question_text != qh.previous_question_text THEN 'Modified Question'
        WHEN qh.answer_set != qh.previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type,
    asc.changes AS answer_set_changes
FROM question_history qh
LEFT JOIN answer_set_changes asc ON qh.question_id = asc.question_id AND qh.year = asc.year
ORDER BY qh.year, qh.question_id
        );
[0m20:48:00.053266 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:48:00.055752 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m20:48:00.056285 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m20:48:00.056674 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:48:00.406853 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b76224-0001-5d30-0001-de66000324ee
[0m20:48:00.407582 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001072 (42601): SQL compilation error:
Lateral View cannot be on the left side of join
[0m20:48:00.408334 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m20:48:00.493745 [debug] [Thread-3 (]: Database Error in model question_evolution (models/marts/question_evolution.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target/run/research_questions_etl/models/marts/question_evolution.sql
[0m20:48:00.494705 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21adfb04f0>]}
[0m20:48:00.495724 [error] [Thread-3 (]: 5 of 5 ERROR creating sql table model etl_schema.question_evolution ............ [[31mERROR[0m in 0.46s]
[0m20:48:00.496640 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m20:48:00.873856 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.817 seconds
[0m20:48:00.880281 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m20:48:00.955841 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31599014-82ed-4aef-8467-83eca47e8ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21adf52860>]}
[0m20:48:00.956617 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 0.92s]
[0m20:48:00.957299 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m20:48:00.958857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:00.959370 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m20:48:00.959812 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m20:48:00.960279 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m20:48:00.960801 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m20:48:00.961498 [info ] [MainThread]: 
[0m20:48:00.962159 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m20:48:00.965098 [debug] [MainThread]: Command end result
[0m20:48:01.082584 [info ] [MainThread]: 
[0m20:48:01.083093 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:48:01.083421 [info ] [MainThread]: 
[0m20:48:01.083804 [error] [MainThread]:   Database Error in model question_evolution (models/marts/question_evolution.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target/run/research_questions_etl/models/marts/question_evolution.sql
[0m20:48:01.084099 [info ] [MainThread]: 
[0m20:48:01.084413 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:48:01.085331 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.1451964, "process_user_time": 3.646424, "process_kernel_time": 0.161134, "process_mem_max_rss": "177752", "process_in_blocks": "3712", "process_out_blocks": "4488", "command_success": false}
[0m20:48:01.086006 [debug] [MainThread]: Command `dbt run` failed at 20:48:01.085914 after 6.15 seconds
[0m20:48:01.086397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21c90e7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21c82c2020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21adf06530>]}
[0m20:48:01.086776 [debug] [MainThread]: Flushing usage events
[0m20:49:24.060450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36874e3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36878aa9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36878aa980>]}


============================== 20:49:24.063160 | d256a481-6bb9-4ef3-a25d-d1445730de36 ==============================
[0m20:49:24.063160 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:49:24.063648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'version_check': 'True', 'profiles_dir': 'dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:49:24.521631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366e19ae60>]}
[0m20:49:24.573220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366e1be860>]}
[0m20:49:24.574194 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:49:24.594761 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:49:24.747266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:49:24.747963 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m20:49:24.973242 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:49:24.973793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366dcc1810>]}
[0m20:49:25.137250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m20:49:25.150010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366d7b4130>]}
[0m20:49:25.269738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366d7b6710>]}
[0m20:49:25.270204 [info ] [MainThread]: Found 22 data tests, 5 models, 1 source, 651 macros
[0m20:49:25.270516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366d7b4370>]}
[0m20:49:25.271919 [info ] [MainThread]: 
[0m20:49:25.272407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:25.276397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:49:25.277007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:49:25.287928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:49:25.290145 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:49:25.292455 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:49:25.294631 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:49:25.295040 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:49:25.295406 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:49:25.295804 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:49:25.296158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:25.296659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:25.297008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:25.623590 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.327 seconds
[0m20:49:25.624850 [debug] [ThreadPool]: On list_research_db: Close
[0m20:49:26.285344 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.989 seconds
[0m20:49:26.287847 [debug] [ThreadPool]: On list_research_db: Close
[0m20:49:26.289904 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.993 seconds
[0m20:49:26.293692 [debug] [ThreadPool]: On list_research_db: Close
[0m20:49:26.391812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m20:49:26.394405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m20:49:26.395526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m20:49:26.431799 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m20:49:26.430784 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m20:49:26.433127 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m20:49:26.436370 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m20:49:26.437017 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m20:49:26.437621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:26.438232 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m20:49:26.438761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:26.442028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:26.778500 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.340 seconds
[0m20:49:26.780769 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m20:49:26.954366 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.512 seconds
[0m20:49:26.956924 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m20:49:27.033267 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.596 seconds
[0m20:49:27.035679 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m20:49:27.109901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36868b47c0>]}
[0m20:49:27.110655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:27.111059 [info ] [MainThread]: 
[0m20:49:27.119791 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m20:49:27.120544 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m20:49:27.121195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m20:49:27.121732 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m20:49:27.131605 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m20:49:27.132843 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m20:49:27.161896 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m20:49:27.163872 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m20:49:27.164543 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m20:49:27.165106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:27.913910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m20:49:27.940173 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m20:49:28.022909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366e19ab90>]}
[0m20:49:28.023568 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 0.90s]
[0m20:49:28.024114 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m20:49:28.024800 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m20:49:28.025208 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m20:49:28.025607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.int_research_questions_unified)
[0m20:49:28.025998 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m20:49:28.031120 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m20:49:28.038156 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m20:49:28.041055 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m20:49:28.042447 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m20:49:28.043249 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m20:49:28.043773 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:49:28.835900 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m20:49:28.838155 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m20:49:28.909477 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366c337a90>]}
[0m20:49:28.910137 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 0.88s]
[0m20:49:28.910753 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m20:49:28.911468 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m20:49:28.912026 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m20:49:28.912863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.consolidated_research_questions)
[0m20:49:28.913218 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m20:49:28.921013 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m20:49:28.928298 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m20:49:28.931717 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m20:49:28.933732 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m20:49:28.934213 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (-- 

-- /*
--     This model represents the final, consolidated view of research questions.
--     It includes only current and active questions, ready for analysis and reporting.
-- */

-- SELECT
--     question_id,
--     year,
--     question_text,
--     category,
--     is_active,
--     valid_from,
--     valid_to,
--     question_status,
--     answer_set
-- FROM research_db.etl_schema_intermediate.int_research_questions_unified
-- WHERE question_status = 'Current' AND is_active = true

-- 



WITH deduplicated_questions AS (
    SELECT DISTINCT *
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
),

classified_questions AS (
    SELECT
        *,
        CASE
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) = 2 THEN 'Binary'
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) <= 4 THEN 'Multiple Choice'
            ELSE 'Extended Multiple Choice'
        END AS question_type,
        CASE
            WHEN category LIKE '%Topic%' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS standardized_category
    FROM deduplicated_questions
),

final AS (
    SELECT
        question_id,
        year,
        question_text,
        standardized_category AS category,
        question_type,
        is_active,
        valid_from,
        valid_to,
        question_status,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text
    FROM classified_questions
)

SELECT
    *,
    CASE
        WHEN previous_question_text IS NULL THEN 'New'
        WHEN question_text != previous_question_text THEN 'Modified'
        ELSE 'Unchanged'
    END AS question_change_status
FROM final
WHERE question_status = 'Current' AND is_active = true
        );
[0m20:49:28.934604 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:49:30.059939 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.125 seconds
[0m20:49:30.062016 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m20:49:30.584579 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366dc3e2f0>]}
[0m20:49:30.586599 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 1.67s]
[0m20:49:30.588612 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m20:49:30.590560 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m20:49:30.591817 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m20:49:30.593333 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m20:49:30.594789 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m20:49:30.596525 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m20:49:30.597754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m20:49:30.598777 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m20:49:30.599764 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m20:49:30.611118 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m20:49:30.611751 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m20:49:30.612549 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m20:49:30.617700 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m20:49:30.620389 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m20:49:30.620863 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (

WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set
    FROM research_db.etl_schema.consolidated_research_questions
),

answer_set_changes AS (
    SELECT
        question_id,
        year,
        ARRAY_AGG(
            OBJECT_CONSTRUCT(
                'action', 
                CASE
                    WHEN new_option IS NULL AND old_option IS NOT NULL THEN 'removed'
                    WHEN new_option IS NOT NULL AND old_option IS NULL THEN 'added'
                    WHEN new_option != old_option THEN 'modified'
                    ELSE 'unchanged'
                END,
                'old_option', old_option,
                'new_option', new_option
            )
        ) AS changes
    FROM (
        SELECT 
            qh.question_id,
            qh.year,
            new_options.value:OptionText::STRING AS new_option,
            old_options.value:OptionText::STRING AS old_option
        FROM question_history qh,
        TABLE(FLATTEN(PARSE_JSON(qh.answer_set))) new_options
        FULL OUTER JOIN TABLE(FLATTEN(PARSE_JSON(qh.previous_answer_set))) old_options
        ON new_options.index = old_options.index
        WHERE qh.answer_set != qh.previous_answer_set
    )
    GROUP BY question_id, year
)

SELECT
    qh.question_id,
    qh.year,
    qh.question_text,
    qh.category,
    qh.answer_set,
    qh.previous_question_text,
    qh.previous_answer_set,
    CASE
        WHEN qh.previous_question_text IS NULL THEN 'New Question'
        WHEN qh.question_text != qh.previous_question_text THEN 'Modified Question'
        WHEN qh.answer_set != qh.previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type,
    asc.changes AS answer_set_changes
FROM question_history qh
LEFT JOIN answer_set_changes asc ON qh.question_id = asc.question_id AND qh.year = asc.year
ORDER BY qh.year, qh.question_id
        );
[0m20:49:30.621243 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:49:30.622212 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m20:49:30.624822 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m20:49:30.626836 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m20:49:30.627245 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m20:49:30.627582 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:49:30.918603 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b76225-0001-5d03-0001-de660003064a
[0m20:49:30.919840 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000002 (0A000): Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
[0m20:49:30.921101 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m20:49:31.002638 [debug] [Thread-3 (]: Database Error in model question_evolution (models/marts/question_evolution.sql)
  000002 (0A000): Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
  compiled code at target/run/research_questions_etl/models/marts/question_evolution.sql
[0m20:49:31.003966 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366c3251b0>]}
[0m20:49:31.005571 [error] [Thread-3 (]: 5 of 5 ERROR creating sql table model etl_schema.question_evolution ............ [[31mERROR[0m in 0.41s]
[0m20:49:31.007069 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m20:49:31.607463 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m20:49:31.609521 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m20:49:31.687459 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256a481-6bb9-4ef3-a25d-d1445730de36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366c3c0520>]}
[0m20:49:31.689118 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 1.09s]
[0m20:49:31.690628 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m20:49:31.693433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:31.694285 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m20:49:31.694905 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m20:49:31.695519 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m20:49:31.696248 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m20:49:31.697055 [info ] [MainThread]: 
[0m20:49:31.697607 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m20:49:31.699299 [debug] [MainThread]: Command end result
[0m20:49:31.794317 [info ] [MainThread]: 
[0m20:49:31.794740 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:31.795035 [info ] [MainThread]: 
[0m20:49:31.795391 [error] [MainThread]:   Database Error in model question_evolution (models/marts/question_evolution.sql)
  000002 (0A000): Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
  compiled code at target/run/research_questions_etl/models/marts/question_evolution.sql
[0m20:49:31.795689 [info ] [MainThread]: 
[0m20:49:31.795973 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:49:31.796815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.7776303, "process_user_time": 3.458734, "process_kernel_time": 0.137108, "process_mem_max_rss": "177704", "process_in_blocks": "40416", "process_out_blocks": "4496", "command_success": false}
[0m20:49:31.797955 [debug] [MainThread]: Command `dbt run` failed at 20:49:31.797870 after 7.78 seconds
[0m20:49:31.798313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36874e3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366ddf5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e366ddf43d0>]}
[0m20:49:31.798635 [debug] [MainThread]: Flushing usage events
[0m20:52:23.841401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d37fd7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d367ac0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d367adf90>]}


============================== 20:52:23.843894 | 2376d9f4-141b-42e4-8554-3051bcd7f21c ==============================
[0m20:52:23.843894 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:52:23.844634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'profiles_dir': 'dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:52:24.372537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1ec911e0>]}
[0m20:52:24.423327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d3830ed40>]}
[0m20:52:24.424132 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:52:24.446146 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:52:24.598963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:52:24.599803 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m20:52:24.852666 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:52:24.853182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1e747310>]}
[0m20:52:25.025277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m20:52:25.038119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1e548130>]}
[0m20:52:25.160647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1e54a890>]}
[0m20:52:25.161239 [info ] [MainThread]: Found 22 data tests, 5 models, 1 source, 651 macros
[0m20:52:25.161623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1e549e10>]}
[0m20:52:25.163633 [info ] [MainThread]: 
[0m20:52:25.164295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:52:25.168866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:52:25.169652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:52:25.175611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m20:52:25.185089 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:52:25.187764 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:52:25.190717 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m20:52:25.191426 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:52:25.191853 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:52:25.192257 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m20:52:25.192718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:25.193223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:25.193601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:25.658826 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.466 seconds
[0m20:52:25.659975 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.467 seconds
[0m20:52:25.661571 [debug] [ThreadPool]: On list_research_db: Close
[0m20:52:25.663452 [debug] [ThreadPool]: On list_research_db: Close
[0m20:52:25.700048 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.506 seconds
[0m20:52:25.701368 [debug] [ThreadPool]: On list_research_db: Close
[0m20:52:25.807249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m20:52:25.807938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m20:52:25.808558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m20:52:25.827563 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m20:52:25.830893 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m20:52:25.833739 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m20:52:25.834210 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m20:52:25.834722 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m20:52:25.835183 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m20:52:25.835727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:25.836060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:25.836440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:26.094637 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.258 seconds
[0m20:52:26.095326 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.259 seconds
[0m20:52:26.096977 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m20:52:26.098341 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m20:52:26.296644 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.461 seconds
[0m20:52:26.298305 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m20:52:26.489401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d379a4370>]}
[0m20:52:26.490018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:52:26.490376 [info ] [MainThread]: 
[0m20:52:26.492112 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m20:52:26.492676 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m20:52:26.493194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m20:52:26.493546 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m20:52:26.501916 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m20:52:26.502825 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m20:52:26.528744 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m20:52:26.529935 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m20:52:26.530409 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m20:52:26.530747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:28.040371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.509 seconds
[0m20:52:28.073463 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m20:52:28.152033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1e493910>]}
[0m20:52:28.152743 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 1.66s]
[0m20:52:28.153299 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m20:52:28.154113 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m20:52:28.154617 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m20:52:28.155037 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.int_research_questions_unified)
[0m20:52:28.155384 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m20:52:28.158685 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m20:52:28.159585 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m20:52:28.164486 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m20:52:28.166279 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m20:52:28.167241 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m20:52:28.167946 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:52:29.266466 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.098 seconds
[0m20:52:29.269881 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m20:52:29.351499 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1d188070>]}
[0m20:52:29.352356 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.20s]
[0m20:52:29.353002 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m20:52:29.353844 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m20:52:29.354422 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m20:52:29.354899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.consolidated_research_questions)
[0m20:52:29.355283 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m20:52:29.362448 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m20:52:29.363375 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m20:52:29.367034 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m20:52:29.370165 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m20:52:29.370810 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (-- 

-- /*
--     This model represents the final, consolidated view of research questions.
--     It includes only current and active questions, ready for analysis and reporting.
-- */

-- SELECT
--     question_id,
--     year,
--     question_text,
--     category,
--     is_active,
--     valid_from,
--     valid_to,
--     question_status,
--     answer_set
-- FROM research_db.etl_schema_intermediate.int_research_questions_unified
-- WHERE question_status = 'Current' AND is_active = true

-- 



WITH deduplicated_questions AS (
    SELECT DISTINCT *
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
),

classified_questions AS (
    SELECT
        *,
        CASE
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) = 2 THEN 'Binary'
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) <= 4 THEN 'Multiple Choice'
            ELSE 'Extended Multiple Choice'
        END AS question_type,
        CASE
            WHEN category LIKE '%Topic%' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS standardized_category
    FROM deduplicated_questions
),

final AS (
    SELECT
        question_id,
        year,
        question_text,
        standardized_category AS category,
        question_type,
        is_active,
        valid_from,
        valid_to,
        question_status,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text
    FROM classified_questions
)

SELECT
    *,
    CASE
        WHEN previous_question_text IS NULL THEN 'New'
        WHEN question_text != previous_question_text THEN 'Modified'
        ELSE 'Unchanged'
    END AS question_change_status
FROM final
WHERE question_status = 'Current' AND is_active = true
        );
[0m20:52:29.371248 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:52:30.393805 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.022 seconds
[0m20:52:30.397723 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m20:52:30.471914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1d1f3e80>]}
[0m20:52:30.472796 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 1.12s]
[0m20:52:30.473483 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m20:52:30.474336 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m20:52:30.474898 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m20:52:30.475416 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m20:52:30.476103 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m20:52:30.476750 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m20:52:30.477307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m20:52:30.477940 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m20:52:30.478441 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m20:52:30.482221 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m20:52:30.487289 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m20:52:30.494846 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m20:52:30.495404 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m20:52:30.499198 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m20:52:30.502758 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m20:52:30.505647 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m20:52:30.508071 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m20:52:30.508911 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (

WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set
    FROM research_db.etl_schema.consolidated_research_questions
),

new_options AS (
    SELECT
        question_id,
        year,
        f.value:OptionText::STRING AS option_text,
        f.index AS option_index,
        'added' AS change_type
    FROM question_history,
        TABLE(FLATTEN(PARSE_JSON(answer_set))) f
    WHERE previous_answer_set IS NULL OR answer_set != previous_answer_set
),

old_options AS (
    SELECT
        question_id,
        year,
        f.value:OptionText::STRING AS option_text,
        f.index AS option_index,
        'removed' AS change_type
    FROM question_history,
        TABLE(FLATTEN(PARSE_JSON(previous_answer_set))) f
    WHERE answer_set != previous_answer_set
),

combined_options AS (
    SELECT * FROM new_options
    UNION ALL
    SELECT * FROM old_options
),

answer_set_changes AS (
    SELECT
        question_id,
        year,
        ARRAY_AGG(
            OBJECT_CONSTRUCT(
                'action', change_type,
                'option', option_text
            )
        ) AS changes
    FROM combined_options
    GROUP BY question_id, year
)

SELECT
    qh.question_id,
    qh.year,
    qh.question_text,
    qh.category,
    qh.answer_set,
    qh.previous_question_text,
    qh.previous_answer_set,
    CASE
        WHEN qh.previous_question_text IS NULL THEN 'New Question'
        WHEN qh.question_text != qh.previous_question_text THEN 'Modified Question'
        WHEN qh.answer_set != qh.previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type,
    asc.changes AS answer_set_changes
FROM question_history qh
LEFT JOIN answer_set_changes asc ON qh.question_id = asc.question_id AND qh.year = asc.year
ORDER BY qh.year, qh.question_id
        );
[0m20:52:30.509439 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m20:52:30.509871 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:52:30.510286 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:52:31.290015 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m20:52:31.292079 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m20:52:31.321240 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m20:52:31.326559 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m20:52:31.391550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1d1fbe80>]}
[0m20:52:31.393218 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 0.91s]
[0m20:52:31.394818 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m20:52:31.403706 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2376d9f4-141b-42e4-8554-3051bcd7f21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1d1c13f0>]}
[0m20:52:31.406155 [info ] [Thread-3 (]: 5 of 5 OK created sql table model etl_schema.question_evolution ................ [[32mSUCCESS 1[0m in 0.93s]
[0m20:52:31.408061 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m20:52:31.411249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:31.412147 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m20:52:31.412664 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m20:52:31.413020 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m20:52:31.413520 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m20:52:31.413993 [info ] [MainThread]: 
[0m20:52:31.414391 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.25 seconds (6.25s).
[0m20:52:31.415579 [debug] [MainThread]: Command end result
[0m20:52:31.524466 [info ] [MainThread]: 
[0m20:52:31.524988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:31.525399 [info ] [MainThread]: 
[0m20:52:31.525757 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:52:31.526859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.728875, "process_user_time": 3.653391, "process_kernel_time": 0.151188, "process_mem_max_rss": "176144", "process_in_blocks": "11072", "process_out_blocks": "4488"}
[0m20:52:31.529601 [debug] [MainThread]: Command `dbt run` succeeded at 20:52:31.529494 after 7.73 seconds
[0m20:52:31.530007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d37fd7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d1e55c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d3830f370>]}
[0m20:52:31.530455 [debug] [MainThread]: Flushing usage events
[0m21:01:20.895029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad9a0dfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad9899a980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad9899a920>]}


============================== 21:01:20.898824 | 28630a2e-540b-4475-b26e-0a043cfb82b7 ==============================
[0m21:01:20.898824 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:01:20.899276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt/logs', 'version_check': 'True', 'profiles_dir': 'dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:01:21.349468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad99b502e0>]}
[0m21:01:21.393017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad9a417b50>]}
[0m21:01:21.393824 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:01:21.405581 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:01:21.549876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:01:21.550501 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m21:01:21.783792 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:01:21.784302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad808993c0>]}
[0m21:01:21.945404 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m21:01:21.958401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad803b0130>]}
[0m21:01:22.074069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad803b28f0>]}
[0m21:01:22.074560 [info ] [MainThread]: Found 22 data tests, 5 models, 1 source, 651 macros
[0m21:01:22.074889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad803b22c0>]}
[0m21:01:22.076462 [info ] [MainThread]: 
[0m21:01:22.076962 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:01:22.080919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m21:01:22.081499 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m21:01:22.092530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m21:01:22.095018 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m21:01:22.097878 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m21:01:22.100331 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m21:01:22.100754 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m21:01:22.101153 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m21:01:22.101503 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m21:01:22.101825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:22.102100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:22.102356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:22.835648 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.733 seconds
[0m21:01:22.837791 [debug] [ThreadPool]: On list_research_db: Close
[0m21:01:23.224317 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.122 seconds
[0m21:01:23.227582 [debug] [ThreadPool]: On list_research_db: Close
[0m21:01:23.285428 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.183 seconds
[0m21:01:23.288621 [debug] [ThreadPool]: On list_research_db: Close
[0m21:01:23.386340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m21:01:23.387802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m21:01:23.389160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m21:01:23.413316 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m21:01:23.419135 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m21:01:23.423544 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m21:01:23.424420 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m21:01:23.425442 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m21:01:23.426363 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m21:01:23.427374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:23.428240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:23.429160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:23.829068 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.402 seconds
[0m21:01:23.832255 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.404 seconds
[0m21:01:23.836197 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m21:01:23.839874 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m21:01:23.844274 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.415 seconds
[0m21:01:23.851615 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m21:01:23.962102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad9a1c6bc0>]}
[0m21:01:23.962709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:01:23.963085 [info ] [MainThread]: 
[0m21:01:23.971324 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m21:01:23.971917 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m21:01:23.972438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m21:01:23.972862 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m21:01:23.981051 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m21:01:23.982135 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m21:01:24.008276 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m21:01:24.009652 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m21:01:24.010025 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m21:01:24.010364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:24.765890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m21:01:24.794915 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m21:01:24.887827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad80303850>]}
[0m21:01:24.889491 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 0.91s]
[0m21:01:24.891137 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m21:01:24.893011 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m21:01:24.894359 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m21:01:24.895835 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.int_research_questions_unified)
[0m21:01:24.896916 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m21:01:24.902829 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m21:01:24.904208 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m21:01:24.908296 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m21:01:24.909565 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m21:01:24.910053 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m21:01:24.910368 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:25.876864 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.966 seconds
[0m21:01:25.882463 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m21:01:25.965467 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad7ef16560>]}
[0m21:01:25.967318 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.07s]
[0m21:01:25.968942 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m21:01:25.970895 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m21:01:25.972185 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m21:01:25.973805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.consolidated_research_questions)
[0m21:01:25.974858 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m21:01:25.988414 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m21:01:25.995364 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m21:01:25.998653 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m21:01:26.000327 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m21:01:26.000944 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (-- 

-- /*
--     This model represents the final, consolidated view of research questions.
--     It includes only current and active questions, ready for analysis and reporting.
-- */

-- SELECT
--     question_id,
--     year,
--     question_text,
--     category,
--     is_active,
--     valid_from,
--     valid_to,
--     question_status,
--     answer_set
-- FROM research_db.etl_schema_intermediate.int_research_questions_unified
-- WHERE question_status = 'Current' AND is_active = true

-- 



WITH deduplicated_questions AS (
    SELECT DISTINCT *
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
),

classified_questions AS (
    SELECT
        *,
        CASE
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) = 2 THEN 'Binary'
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) <= 4 THEN 'Multiple Choice'
            ELSE 'Extended Multiple Choice'
        END AS question_type,
        CASE
            WHEN category LIKE '%Topic%' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS standardized_category
    FROM deduplicated_questions
),

final AS (
    SELECT
        question_id,
        year,
        question_text,
        standardized_category AS category,
        question_type,
        is_active,
        valid_from,
        valid_to,
        question_status,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text
    FROM classified_questions
)

SELECT
    *,
    CASE
        WHEN previous_question_text IS NULL THEN 'New'
        WHEN question_text != previous_question_text THEN 'Modified'
        ELSE 'Unchanged'
    END AS question_change_status
FROM final
WHERE question_status = 'Current' AND is_active = true
        );
[0m21:01:26.001357 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:27.020903 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.019 seconds
[0m21:01:27.026533 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m21:01:27.113641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad7efa0d90>]}
[0m21:01:27.115330 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 1.14s]
[0m21:01:27.117084 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m21:01:27.119107 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m21:01:27.120604 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m21:01:27.121909 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m21:01:27.123547 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m21:01:27.125041 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m21:01:27.126285 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m21:01:27.127592 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m21:01:27.136427 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m21:01:27.137613 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m21:01:27.143931 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m21:01:27.144550 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m21:01:27.147578 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m21:01:27.148126 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m21:01:27.151191 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m21:01:27.152898 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m21:01:27.153428 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m21:01:27.153872 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:01:27.156770 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m21:01:27.157795 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (

WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set,
        ROW_NUMBER() OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS question_version,
        MIN(year) OVER () AS min_year
    FROM research_db.etl_schema.consolidated_research_questions
),

new_options AS (
    SELECT
        question_id,
        year,
        f.value:OptionText::STRING AS option_text,
        f.index AS option_index,
        'added' AS change_type
    FROM question_history,
        TABLE(FLATTEN(PARSE_JSON(answer_set))) f
    WHERE year > min_year AND (previous_answer_set IS NULL OR answer_set != previous_answer_set)
),

old_options AS (
    SELECT
        question_id,
        year,
        f.value:OptionText::STRING AS option_text,
        f.index AS option_index,
        'removed' AS change_type
    FROM question_history,
        TABLE(FLATTEN(PARSE_JSON(previous_answer_set))) f
    WHERE year > min_year AND answer_set != previous_answer_set
),

combined_options AS (
    SELECT * FROM new_options
    UNION ALL
    SELECT * FROM old_options
),

answer_set_changes AS (
    SELECT
        question_id,
        year,
        ARRAY_AGG(
            OBJECT_CONSTRUCT(
                'action', change_type,
                'option', option_text
            )
        ) AS changes
    FROM combined_options
    GROUP BY question_id, year
)

SELECT
    qh.question_id,
    qh.year,
    qh.question_text,
    qh.category,
    qh.answer_set,
    qh.previous_question_text,
    qh.previous_answer_set,
    CASE
        WHEN qh.year = qh.min_year THEN 'New Question'
        WHEN qh.question_version = 1 THEN 'New Question'
        WHEN qh.question_text != qh.previous_question_text THEN 'Modified Question'
        WHEN qh.answer_set != qh.previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type,
    CASE
        WHEN qh.year = qh.min_year THEN NULL
        ELSE asc.changes
    END AS answer_set_changes
FROM question_history qh
LEFT JOIN answer_set_changes asc ON qh.question_id = asc.question_id AND qh.year = asc.year
ORDER BY qh.year, qh.question_id
        );
[0m21:01:27.158428 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:28.168156 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.014 seconds
[0m21:01:28.170736 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m21:01:28.285590 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad7efabee0>]}
[0m21:01:28.287426 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 1.16s]
[0m21:01:28.289096 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m21:01:28.308002 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.149 seconds
[0m21:01:28.314014 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m21:01:28.401124 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28630a2e-540b-4475-b26e-0a043cfb82b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad7f356560>]}
[0m21:01:28.402788 [info ] [Thread-3 (]: 5 of 5 OK created sql table model etl_schema.question_evolution ................ [[32mSUCCESS 1[0m in 1.27s]
[0m21:01:28.404261 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m21:01:28.406954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:28.408090 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m21:01:28.408894 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m21:01:28.409879 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m21:01:28.411011 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m21:01:28.412578 [info ] [MainThread]: 
[0m21:01:28.414088 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.34 seconds (6.34s).
[0m21:01:28.418645 [debug] [MainThread]: Command end result
[0m21:01:28.521055 [info ] [MainThread]: 
[0m21:01:28.521478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:28.521763 [info ] [MainThread]: 
[0m21:01:28.522051 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:01:28.522888 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.666255, "process_user_time": 3.49063, "process_kernel_time": 0.152071, "process_mem_max_rss": "176248", "process_in_blocks": "40208", "process_out_blocks": "4496"}
[0m21:01:28.523350 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:28.523276 after 7.67 seconds
[0m21:01:28.523657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad9a0dfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad9a417b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad80ec86a0>]}
[0m21:01:28.523964 [debug] [MainThread]: Flushing usage events
[0m21:29:34.997398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75751d5ebfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75751d002aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75751d96ebc0>]}


============================== 21:29:34.999880 | 828853ef-0402-49ff-b358-ca89649c1799 ==============================
[0m21:29:34.999880 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:29:35.000425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:35.456028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75751d5116f0>]}
[0m21:29:35.505576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75750433e110>]}
[0m21:29:35.506461 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:29:35.520286 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:29:35.672177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:29:35.672844 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m21:29:35.890130 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:29:35.890632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75751e30d390>]}
[0m21:29:36.049265 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m21:29:36.064295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757503bd0130>]}
[0m21:29:36.185062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757503be06d0>]}
[0m21:29:36.185540 [info ] [MainThread]: Found 22 data tests, 5 models, 1 source, 651 macros
[0m21:29:36.185920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757503be12a0>]}
[0m21:29:36.187353 [info ] [MainThread]: 
[0m21:29:36.187835 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:29:36.191999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m21:29:36.192834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m21:29:36.198634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m21:29:36.205390 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m21:29:36.208294 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m21:29:36.210982 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m21:29:36.211512 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m21:29:36.212031 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m21:29:36.212443 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m21:29:36.212896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:36.213292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:36.213698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:36.727366 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.514 seconds
[0m21:29:36.729961 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.516 seconds
[0m21:29:36.731766 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.519 seconds
[0m21:29:36.735212 [debug] [ThreadPool]: On list_research_db: Close
[0m21:29:36.738429 [debug] [ThreadPool]: On list_research_db: Close
[0m21:29:36.741608 [debug] [ThreadPool]: On list_research_db: Close
[0m21:29:36.844763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m21:29:36.846428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m21:29:36.849334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m21:29:36.878456 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m21:29:36.881353 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m21:29:36.882118 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m21:29:36.891576 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m21:29:36.892505 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m21:29:36.893494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:36.894435 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m21:29:36.895394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:36.899020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:37.194763 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.299 seconds
[0m21:29:37.197769 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m21:29:37.202817 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.304 seconds
[0m21:29:37.208140 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m21:29:37.211000 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.317 seconds
[0m21:29:37.216577 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m21:29:37.304176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757503c2ded0>]}
[0m21:29:37.304725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:37.305084 [info ] [MainThread]: 
[0m21:29:37.314908 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m21:29:37.316363 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m21:29:37.317583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m21:29:37.318576 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m21:29:37.331038 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m21:29:37.331942 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m21:29:37.353977 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m21:29:37.355276 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m21:29:37.355686 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m21:29:37.356023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:38.436469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.080 seconds
[0m21:29:38.454303 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m21:29:38.529214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757503bd36d0>]}
[0m21:29:38.529850 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 1.21s]
[0m21:29:38.530416 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m21:29:38.531355 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m21:29:38.531935 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m21:29:38.532374 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.int_research_questions_unified)
[0m21:29:38.532688 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m21:29:38.535394 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m21:29:38.542307 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m21:29:38.545526 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m21:29:38.546719 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m21:29:38.547119 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m21:29:38.547451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:39.304636 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m21:29:39.306670 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m21:29:39.384108 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75750275fd90>]}
[0m21:29:39.385805 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 0.85s]
[0m21:29:39.387314 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m21:29:39.389086 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m21:29:39.390636 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m21:29:39.391860 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.consolidated_research_questions)
[0m21:29:39.392907 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m21:29:39.409807 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m21:29:39.411303 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m21:29:39.415867 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m21:29:39.419956 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m21:29:39.420879 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (-- 

-- /*
--     This model represents the final, consolidated view of research questions.
--     It includes only current and active questions, ready for analysis and reporting.
-- */

-- SELECT
--     question_id,
--     year,
--     question_text,
--     category,
--     is_active,
--     valid_from,
--     valid_to,
--     question_status,
--     answer_set
-- FROM research_db.etl_schema_intermediate.int_research_questions_unified
-- WHERE question_status = 'Current' AND is_active = true

-- 



WITH deduplicated_questions AS (
    SELECT DISTINCT *
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
),

classified_questions AS (
    SELECT
        *,
        CASE
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) = 2 THEN 'Binary'
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) <= 4 THEN 'Multiple Choice'
            ELSE 'Extended Multiple Choice'
        END AS question_type,
        CASE
            WHEN category LIKE '%Topic%' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS standardized_category
    FROM deduplicated_questions
),

final AS (
    SELECT
        question_id,
        year,
        question_text,
        standardized_category AS category,
        question_type,
        is_active,
        valid_from,
        valid_to,
        question_status,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text
    FROM classified_questions
)

SELECT
    *,
    CASE
        WHEN previous_question_text IS NULL THEN 'New'
        WHEN question_text != previous_question_text THEN 'Modified'
        ELSE 'Unchanged'
    END AS question_change_status
FROM final
WHERE question_status = 'Current' AND is_active = true
        );
[0m21:29:39.421564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:40.645547 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.224 seconds
[0m21:29:40.651319 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m21:29:40.742228 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757502307e20>]}
[0m21:29:40.744035 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 1.35s]
[0m21:29:40.745538 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m21:29:40.747570 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m21:29:40.748824 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m21:29:40.750226 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m21:29:40.752192 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m21:29:40.754189 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m21:29:40.755607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m21:29:40.757293 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m21:29:40.758559 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m21:29:40.767731 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m21:29:40.774004 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m21:29:40.781248 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m21:29:40.781953 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m21:29:40.785932 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m21:29:40.789502 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m21:29:40.791396 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m21:29:40.791808 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m21:29:40.792182 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:29:40.794282 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m21:29:40.796245 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (

WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set,
        LAG(year) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_year,
        MIN(year) OVER () AS min_year
    FROM research_db.etl_schema.consolidated_research_questions
),

answer_set_changes AS (
    SELECT
        qh.question_id,
        qh.year,
        ARRAY_AGG(
            OBJECT_CONSTRUCT(
                'action', 
                CASE 
                    WHEN qh.year > qh.min_year AND new.value IS NULL THEN 'removed'
                    WHEN qh.year > qh.min_year AND old.value IS NULL THEN 'added'
                    WHEN qh.year > qh.min_year AND new.value != old.value THEN 'modified'
                    ELSE NULL
                END,
                'option', COALESCE(new.value:OptionText, old.value:OptionText)
            )
        ) AS changes
    FROM question_history qh
    LEFT JOIN TABLE(FLATTEN(PARSE_JSON(qh.answer_set))) new
    FULL OUTER JOIN TABLE(FLATTEN(PARSE_JSON(qh.previous_answer_set))) old
        ON new.index = old.index
    WHERE qh.year > qh.min_year
    GROUP BY qh.question_id, qh.year
)

SELECT
    qh.question_id,
    qh.year,
    qh.question_text,
    qh.category,
    qh.answer_set,
    qh.previous_question_text,
    qh.previous_answer_set,
    CASE
        WHEN qh.year = qh.min_year THEN 'New Question'
        WHEN qh.previous_year IS NULL THEN 'New Question'
        WHEN qh.question_text != qh.previous_question_text THEN 'Modified Question'
        WHEN qh.answer_set != qh.previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type,
    CASE
        WHEN qh.year = qh.min_year THEN NULL
        ELSE asc.changes
    END AS answer_set_changes
FROM question_history qh
LEFT JOIN answer_set_changes asc ON qh.question_id = asc.question_id AND qh.year = asc.year
ORDER BY qh.year, qh.question_id
        );
[0m21:29:40.796999 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:41.090161 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7624d-0001-5d03-0001-de660003077a
[0m21:29:41.091346 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000002 (0A000): Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
[0m21:29:41.092615 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m21:29:41.176017 [debug] [Thread-3 (]: Database Error in model question_evolution (models/marts/question_evolution.sql)
  000002 (0A000): Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
  compiled code at target/run/research_questions_etl/models/marts/question_evolution.sql
[0m21:29:41.177383 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75750276af20>]}
[0m21:29:41.179770 [error] [Thread-3 (]: 5 of 5 ERROR creating sql table model etl_schema.question_evolution ............ [[31mERROR[0m in 0.42s]
[0m21:29:41.181464 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m21:29:41.768126 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.976 seconds
[0m21:29:41.774271 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m21:29:41.898819 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828853ef-0402-49ff-b358-ca89649c1799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7575027e49d0>]}
[0m21:29:41.900713 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 1.14s]
[0m21:29:41.902432 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m21:29:41.905322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:41.906080 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m21:29:41.906863 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m21:29:41.907616 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m21:29:41.908202 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m21:29:41.908831 [info ] [MainThread]: 
[0m21:29:41.909407 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m21:29:41.911140 [debug] [MainThread]: Command end result
[0m21:29:42.006380 [info ] [MainThread]: 
[0m21:29:42.006832 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:29:42.007169 [info ] [MainThread]: 
[0m21:29:42.007704 [error] [MainThread]:   Database Error in model question_evolution (models/marts/question_evolution.sql)
  000002 (0A000): Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
  compiled code at target/run/research_questions_etl/models/marts/question_evolution.sql
[0m21:29:42.008069 [info ] [MainThread]: 
[0m21:29:42.008382 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:29:42.009371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.0513086, "process_user_time": 3.499635, "process_kernel_time": 0.14644, "process_mem_max_rss": "177984", "process_in_blocks": "40872", "process_out_blocks": "4496", "command_success": false}
[0m21:29:42.009989 [debug] [MainThread]: Command `dbt run` failed at 21:29:42.009910 after 7.05 seconds
[0m21:29:42.010316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75751d5ebfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75751d5116f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75751c7cc970>]}
[0m21:29:42.010622 [debug] [MainThread]: Flushing usage events
[0m21:32:34.763162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ca1ebfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ca56c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ca56df90>]}


============================== 21:32:34.765706 | d0ed6b94-4138-4655-8546-18f093383ced ==============================
[0m21:32:34.765706 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:32:34.766184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'dbt', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'send_anonymous_usage_stats': 'True'}
[0m21:32:35.222801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627b0f191e0>]}
[0m21:32:35.267750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627c8a16d40>]}
[0m21:32:35.268707 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:32:35.281778 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:32:35.425577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:32:35.426224 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m21:32:35.654055 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:32:35.654557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627b09cf310>]}
[0m21:32:35.816617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m21:32:35.830903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627b07cc130>]}
[0m21:32:35.957913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627b07ce890>]}
[0m21:32:35.958396 [info ] [MainThread]: Found 22 data tests, 5 models, 1 source, 651 macros
[0m21:32:35.958717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627b07cde10>]}
[0m21:32:35.960198 [info ] [MainThread]: 
[0m21:32:35.960685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:32:35.964612 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m21:32:35.965298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m21:32:35.976234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m21:32:35.977891 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m21:32:35.980046 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m21:32:35.982604 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m21:32:35.983118 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m21:32:35.983579 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m21:32:35.983993 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m21:32:35.984332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:35.984622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:35.985001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:36.645637 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.661 seconds
[0m21:32:36.649147 [debug] [ThreadPool]: On list_research_db: Close
[0m21:32:36.654221 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.669 seconds
[0m21:32:36.657373 [debug] [ThreadPool]: On list_research_db: Close
[0m21:32:36.778525 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.793 seconds
[0m21:32:36.781918 [debug] [ThreadPool]: On list_research_db: Close
[0m21:32:36.873260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m21:32:36.876245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m21:32:36.888060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m21:32:36.918145 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m21:32:36.924843 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m21:32:36.931101 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m21:32:36.932049 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m21:32:36.933027 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m21:32:36.933903 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m21:32:36.934825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:36.935657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:36.936404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:37.189779 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.255 seconds
[0m21:32:37.193643 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m21:32:37.199882 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.263 seconds
[0m21:32:37.203157 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m21:32:37.210943 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.275 seconds
[0m21:32:37.214513 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m21:32:37.307973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627c9c4c370>]}
[0m21:32:37.309459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:37.310440 [info ] [MainThread]: 
[0m21:32:37.321332 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m21:32:37.322833 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m21:32:37.324082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m21:32:37.325101 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m21:32:37.340729 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m21:32:37.341932 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m21:32:37.364668 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m21:32:37.366059 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m21:32:37.366485 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m21:32:37.366797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:38.145918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m21:32:38.164812 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m21:32:38.243374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627b0f1abc0>]}
[0m21:32:38.244132 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 0.92s]
[0m21:32:38.244715 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m21:32:38.245523 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m21:32:38.246115 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m21:32:38.246553 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.int_research_questions_unified)
[0m21:32:38.246929 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m21:32:38.249928 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m21:32:38.256938 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m21:32:38.260190 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m21:32:38.261361 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m21:32:38.261733 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT 
    *,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM questions
        );
[0m21:32:38.262068 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:32:39.050768 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m21:32:39.054238 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m21:32:39.156940 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627afbe9240>]}
[0m21:32:39.158731 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 0.91s]
[0m21:32:39.160312 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m21:32:39.162195 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m21:32:39.163709 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m21:32:39.165300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.consolidated_research_questions)
[0m21:32:39.166693 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m21:32:39.185055 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m21:32:39.192062 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m21:32:39.197649 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m21:32:39.199985 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m21:32:39.200520 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (-- 

-- /*
--     This model represents the final, consolidated view of research questions.
--     It includes only current and active questions, ready for analysis and reporting.
-- */

-- SELECT
--     question_id,
--     year,
--     question_text,
--     category,
--     is_active,
--     valid_from,
--     valid_to,
--     question_status,
--     answer_set
-- FROM research_db.etl_schema_intermediate.int_research_questions_unified
-- WHERE question_status = 'Current' AND is_active = true

-- 



WITH deduplicated_questions AS (
    SELECT DISTINCT *
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
),

classified_questions AS (
    SELECT
        *,
        CASE
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) = 2 THEN 'Binary'
            WHEN ARRAY_SIZE(PARSE_JSON(answer_set)) <= 4 THEN 'Multiple Choice'
            ELSE 'Extended Multiple Choice'
        END AS question_type,
        CASE
            WHEN category LIKE '%Topic%' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS standardized_category
    FROM deduplicated_questions
),

final AS (
    SELECT
        question_id,
        year,
        question_text,
        standardized_category AS category,
        question_type,
        is_active,
        valid_from,
        valid_to,
        question_status,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text
    FROM classified_questions
)

SELECT
    *,
    CASE
        WHEN previous_question_text IS NULL THEN 'New'
        WHEN question_text != previous_question_text THEN 'Modified'
        ELSE 'Unchanged'
    END AS question_change_status
FROM final
WHERE question_status = 'Current' AND is_active = true
        );
[0m21:32:39.200907 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:32:39.926982 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m21:32:39.929113 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m21:32:40.014712 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627af3a3550>]}
[0m21:32:40.015393 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 0.85s]
[0m21:32:40.015942 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m21:32:40.016689 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m21:32:40.017315 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m21:32:40.018054 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m21:32:40.018584 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m21:32:40.019081 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m21:32:40.019563 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m21:32:40.019966 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m21:32:40.020352 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m21:32:40.024305 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m21:32:40.027672 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m21:32:40.028419 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m21:32:40.028816 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m21:32:40.032349 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m21:32:40.035528 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m21:32:40.038074 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m21:32:40.038529 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (

WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set,
        LAG(year) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_year,
        MIN(year) OVER () AS min_year
    FROM research_db.etl_schema.consolidated_research_questions
),

current_options AS (
    SELECT
        question_id,
        year,
        f.value:OptionText::STRING AS option_text,
        f.index AS option_index
    FROM question_history,
        TABLE(FLATTEN(input => PARSE_JSON(answer_set))) f
    WHERE year > min_year
),

previous_options AS (
    SELECT
        question_id,
        year,
        f.value:OptionText::STRING AS option_text,
        f.index AS option_index
    FROM question_history,
        TABLE(FLATTEN(input => PARSE_JSON(previous_answer_set))) f
    WHERE year > min_year
),

answer_set_changes AS (
    SELECT
        COALESCE(c.question_id, p.question_id) AS question_id,
        COALESCE(c.year, p.year) AS year,
        ARRAY_AGG(
            OBJECT_CONSTRUCT(
                'action', 
                CASE 
                    WHEN c.option_text IS NULL THEN 'removed'
                    WHEN p.option_text IS NULL THEN 'added'
                    WHEN c.option_text != p.option_text THEN 'modified'
                    ELSE 'unchanged'
                END,
                'option', COALESCE(c.option_text, p.option_text)
            )
        ) AS changes
    FROM current_options c
    FULL OUTER JOIN previous_options p
        ON c.question_id = p.question_id AND c.year = p.year AND c.option_index = p.option_index
    WHERE COALESCE(c.option_text, p.option_text) IS NOT NULL
    GROUP BY COALESCE(c.question_id, p.question_id), COALESCE(c.year, p.year)
)

SELECT
    qh.question_id,
    qh.year,
    qh.question_text,
    qh.category,
    qh.answer_set,
    qh.previous_question_text,
    qh.previous_answer_set,
    CASE
        WHEN qh.year = qh.min_year THEN 'New Question'
        WHEN qh.previous_year IS NULL THEN 'New Question'
        WHEN qh.question_text != qh.previous_question_text THEN 'Modified Question'
        WHEN qh.answer_set != qh.previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type,
    CASE
        WHEN qh.year = qh.min_year THEN NULL
        ELSE asc.changes
    END AS answer_set_changes
FROM question_history qh
LEFT JOIN answer_set_changes asc ON qh.question_id = asc.question_id AND qh.year = asc.year
ORDER BY qh.year, qh.question_id
        );
[0m21:32:40.038950 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:32:40.041362 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m21:32:40.042922 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m21:32:40.043423 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:32:40.867504 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m21:32:40.869717 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m21:32:40.908733 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.870 seconds
[0m21:32:40.910709 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m21:32:40.955581 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627af3e7f40>]}
[0m21:32:40.956253 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 0.94s]
[0m21:32:40.956825 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m21:32:40.981300 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed6b94-4138-4655-8546-18f093383ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627af38d1e0>]}
[0m21:32:40.982009 [info ] [Thread-3 (]: 5 of 5 OK created sql table model etl_schema.question_evolution ................ [[32mSUCCESS 1[0m in 0.96s]
[0m21:32:40.982540 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m21:32:40.983454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:40.983761 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m21:32:40.984005 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m21:32:40.984233 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m21:32:40.984449 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m21:32:40.984762 [info ] [MainThread]: 
[0m21:32:40.985060 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m21:32:40.985959 [debug] [MainThread]: Command end result
[0m21:32:41.082250 [info ] [MainThread]: 
[0m21:32:41.082704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:41.083020 [info ] [MainThread]: 
[0m21:32:41.083323 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:32:41.084272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3633323, "process_user_time": 3.431894, "process_kernel_time": 0.146696, "process_mem_max_rss": "176284", "process_in_blocks": "40160", "process_out_blocks": "4504"}
[0m21:32:41.084717 [debug] [MainThread]: Command `dbt run` succeeded at 21:32:41.084645 after 6.36 seconds
[0m21:32:41.085044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ca1ebfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627c8a17370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627b07e1d80>]}
[0m21:32:41.085353 [debug] [MainThread]: Flushing usage events
[0m22:00:09.242382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7433caae7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7433caeae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7433caeae950>]}


============================== 22:00:09.244799 | 1e547239-fa40-4459-86ac-e0d8743eb866 ==============================
[0m22:00:09.244799 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:00:09.245254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:00:09.652679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e547239-fa40-4459-86ac-e0d8743eb866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7433caa05690>]}
[0m22:00:09.694847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e547239-fa40-4459-86ac-e0d8743eb866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7433c930eb00>]}
[0m22:00:09.695621 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:00:09.706930 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:00:09.840409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:00:09.841096 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:00:09.841497 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:00:10.067302 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:00:10.067766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e547239-fa40-4459-86ac-e0d8743eb866', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7433b1285d50>]}
[0m22:00:10.199132 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2021' which was not found
[0m22:00:10.206407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0030558, "process_user_time": 2.379884, "process_kernel_time": 0.088816, "process_mem_max_rss": "158920", "process_in_blocks": "35000", "process_out_blocks": "24", "command_success": false}
[0m22:00:10.207061 [debug] [MainThread]: Command `dbt run` failed at 22:00:10.206965 after 1.00 seconds
[0m22:00:10.207420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7433caae7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7433ca6873a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7433b12b4160>]}
[0m22:00:10.207753 [debug] [MainThread]: Flushing usage events
[0m22:08:23.300013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2342dc7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23415a28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23415a2890>]}


============================== 22:08:23.301843 | 349a2fe6-a6ca-4bca-af35-4b5b2db42092 ==============================
[0m22:08:23.301843 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:08:23.302302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:08:23.317762 [info ] [MainThread]: dbt version: 1.8.7
[0m22:08:23.318280 [info ] [MainThread]: python version: 3.10.12
[0m22:08:23.318564 [info ] [MainThread]: python path: /home/hasan/Desktop/MyLearning/research_questions_etl/venv/bin/python3
[0m22:08:23.318827 [info ] [MainThread]: os info: Linux-6.8.0-40-generic-x86_64-with-glibc2.35
[0m22:08:23.637701 [info ] [MainThread]: Using profiles dir at /home/hasan/Desktop/MyLearning/research_questions_etl/dbt
[0m22:08:23.638117 [info ] [MainThread]: Using profiles.yml file at /home/hasan/Desktop/MyLearning/research_questions_etl/dbt/profiles.yml
[0m22:08:23.638409 [info ] [MainThread]: Using dbt_project.yml file at /home/hasan/Desktop/MyLearning/research_questions_etl/dbt/dbt_project.yml
[0m22:08:23.638788 [info ] [MainThread]: adapter type: snowflake
[0m22:08:23.639086 [info ] [MainThread]: adapter version: 1.8.3
[0m22:08:23.710231 [info ] [MainThread]: Configuration:
[0m22:08:23.710655 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:08:23.710964 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:08:23.711229 [info ] [MainThread]: Required dependencies:
[0m22:08:23.711491 [debug] [MainThread]: Executing "git --help"
[0m22:08:23.719906 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialise an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:08:23.720298 [debug] [MainThread]: STDERR: "b''"
[0m22:08:23.720585 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:08:23.720878 [info ] [MainThread]: Connection:
[0m22:08:23.721173 [info ] [MainThread]:   account: oacgvzl-ml59242
[0m22:08:23.721428 [info ] [MainThread]:   user: etl_user
[0m22:08:23.721676 [info ] [MainThread]:   database: research_db
[0m22:08:23.721939 [info ] [MainThread]:   warehouse: etl_warehouse
[0m22:08:23.722184 [info ] [MainThread]:   role: etl_role
[0m22:08:23.722425 [info ] [MainThread]:   schema: etl_schema
[0m22:08:23.722666 [info ] [MainThread]:   authenticator: None
[0m22:08:23.722918 [info ] [MainThread]:   oauth_client_id: None
[0m22:08:23.723159 [info ] [MainThread]:   query_tag: None
[0m22:08:23.723400 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:08:23.723639 [info ] [MainThread]:   host: None
[0m22:08:23.723886 [info ] [MainThread]:   port: None
[0m22:08:23.724125 [info ] [MainThread]:   proxy_host: None
[0m22:08:23.724359 [info ] [MainThread]:   proxy_port: None
[0m22:08:23.724592 [info ] [MainThread]:   protocol: None
[0m22:08:23.724833 [info ] [MainThread]:   connect_retries: 1
[0m22:08:23.725067 [info ] [MainThread]:   connect_timeout: None
[0m22:08:23.725313 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:08:23.725546 [info ] [MainThread]:   retry_all: False
[0m22:08:23.725788 [info ] [MainThread]:   insecure_mode: False
[0m22:08:23.726022 [info ] [MainThread]:   reuse_connections: None
[0m22:08:23.726398 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:08:23.727438 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:08:23.728013 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:08:23.728302 [debug] [MainThread]: On debug: select 1 as id
[0m22:08:23.728557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:24.531889 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.803 seconds
[0m22:08:24.534163 [debug] [MainThread]: On debug: Close
[0m22:08:24.664651 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:08:24.665905 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:08:24.667825 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.401981, "process_user_time": 1.858912, "process_kernel_time": 0.067741, "process_mem_max_rss": "157556", "process_in_blocks": "504", "process_out_blocks": "40"}
[0m22:08:24.669365 [debug] [MainThread]: Command `dbt debug` succeeded at 22:08:24.669112 after 1.40 seconds
[0m22:08:24.670342 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:08:24.671333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2342dc7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a23298ac1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2341686b90>]}
[0m22:08:24.672398 [debug] [MainThread]: Flushing usage events
[0m22:08:37.731918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f47bee7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f47c2adb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f47c2adb70>]}


============================== 22:08:37.733853 | 5acab8d2-2a05-4305-ba7f-a393703226ac ==============================
[0m22:08:37.733853 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:08:37.734268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:38.127801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5acab8d2-2a05-4305-ba7f-a393703226ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f47c223a90>]}
[0m22:08:38.168588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5acab8d2-2a05-4305-ba7f-a393703226ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f47b0c2b90>]}
[0m22:08:38.169207 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:08:38.179384 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:08:38.292049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:08:38.292805 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m22:08:38.293256 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:08:38.293625 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:08:38.294021 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:08:38.504996 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:08:38.505497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5acab8d2-2a05-4305-ba7f-a393703226ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f47ba86500>]}
[0m22:08:38.645524 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2022' which was not found
[0m22:08:38.646337 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.9498594, "process_user_time": 2.343799, "process_kernel_time": 0.073836, "process_mem_max_rss": "159076", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:08:38.646852 [debug] [MainThread]: Command `dbt compile` failed at 22:08:38.646766 after 0.95 seconds
[0m22:08:38.647181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f47bee7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f47ba87400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f47b9d1870>]}
[0m22:08:38.647498 [debug] [MainThread]: Flushing usage events
[0m22:11:51.400336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a666680a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a66973160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a669722c0>]}


============================== 22:11:51.402230 | f5c07edc-1d25-4e81-aec2-26ce6e60ac95 ==============================
[0m22:11:51.402230 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:11:51.402687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:51.792867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5c07edc-1d25-4e81-aec2-26ce6e60ac95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a4cff4310>]}
[0m22:11:51.833159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5c07edc-1d25-4e81-aec2-26ce6e60ac95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a4d345b10>]}
[0m22:11:51.833824 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:11:51.843947 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:11:51.951127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:11:51.951827 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m22:11:51.952256 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:11:51.952607 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:11:51.952992 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:11:52.156546 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:11:52.157044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f5c07edc-1d25-4e81-aec2-26ce6e60ac95', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a66456ef0>]}
[0m22:11:52.292604 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2023' which was not found
[0m22:11:52.293411 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.92813104, "process_user_time": 2.30063, "process_kernel_time": 0.07579, "process_mem_max_rss": "159180", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:11:52.293925 [debug] [MainThread]: Command `dbt compile` failed at 22:11:52.293841 after 0.93 seconds
[0m22:11:52.294257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a666680a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a660020e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a660d5960>]}
[0m22:11:52.294584 [debug] [MainThread]: Flushing usage events
[0m22:12:29.554474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767f5addbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767f5939e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767f5939e0e0>]}


============================== 22:12:29.556363 | 4909e872-6322-432a-a884-2bac698b15c2 ==============================
[0m22:12:29.556363 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:12:29.556828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m22:12:29.937851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4909e872-6322-432a-a884-2bac698b15c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767f59313a90>]}
[0m22:12:29.977164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4909e872-6322-432a-a884-2bac698b15c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767f5a1aeb90>]}
[0m22:12:29.977820 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:12:29.988199 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:12:30.094625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:12:30.095320 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m22:12:30.095717 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:12:30.096086 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:12:30.096417 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:12:30.300838 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:12:30.301317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4909e872-6322-432a-a884-2bac698b15c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767f5abd6aa0>]}
[0m22:12:30.438135 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2022' which was not found
[0m22:12:30.438923 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.91869533, "process_user_time": 2.266387, "process_kernel_time": 0.088819, "process_mem_max_rss": "159056", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:12:30.439421 [debug] [MainThread]: Command `dbt compile` failed at 22:12:30.439343 after 0.92 seconds
[0m22:12:30.439746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767f5addbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767f5a9680a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767f5a7ed060>]}
[0m22:12:30.440077 [debug] [MainThread]: Flushing usage events
[0m22:12:51.924470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778c8c600a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778c73b3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778c73b22c0>]}


============================== 22:12:51.926390 | 62d54be3-9208-44ac-a769-72212ab48f54 ==============================
[0m22:12:51.926390 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:12:51.926872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:12:52.311464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62d54be3-9208-44ac-a769-72212ab48f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778af764310>]}
[0m22:12:52.351066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62d54be3-9208-44ac-a769-72212ab48f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778af8b2b90>]}
[0m22:12:52.351683 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:12:52.362214 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:12:52.469156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:12:52.469845 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m22:12:52.470275 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:12:52.470647 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:12:52.471022 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:12:52.675289 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:12:52.675724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '62d54be3-9208-44ac-a769-72212ab48f54', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778c870a350>]}
[0m22:12:52.809665 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2022' which was not found
[0m22:12:52.810417 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.9201398, "process_user_time": 2.294493, "process_kernel_time": 0.068894, "process_mem_max_rss": "159320", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m22:12:52.810926 [debug] [MainThread]: Command `dbt compile` failed at 22:12:52.810847 after 0.92 seconds
[0m22:12:52.811247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778c8c600a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778c89cdb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7778c86e5a80>]}
[0m22:12:52.811564 [debug] [MainThread]: Flushing usage events
[0m22:14:21.542497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389251e3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389255a9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389255a9b70>]}


============================== 22:14:21.544426 | 6961e5a6-7583-4ed3-8f02-aff5308d4ec8 ==============================
[0m22:14:21.544426 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:14:21.544863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:14:21.934537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6961e5a6-7583-4ed3-8f02-aff5308d4ec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73892551fa90>]}
[0m22:14:21.975355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6961e5a6-7583-4ed3-8f02-aff5308d4ec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389245b5c00>]}
[0m22:14:21.976055 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:14:21.986418 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:14:22.114732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:14:22.115482 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m22:14:22.115942 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:14:22.116311 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:14:22.116652 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:14:22.326207 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:14:22.326670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6961e5a6-7583-4ed3-8f02-aff5308d4ec8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738924c57070>]}
[0m22:14:22.463394 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2023' which was not found
[0m22:14:22.464208 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.9571079, "process_user_time": 2.36822, "process_kernel_time": 0.050004, "process_mem_max_rss": "159304", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:14:22.464710 [debug] [MainThread]: Command `dbt compile` failed at 22:14:22.464616 after 0.96 seconds
[0m22:14:22.465045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389251e3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73890b91c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738925149180>]}
[0m22:14:22.465362 [debug] [MainThread]: Flushing usage events
[0m22:14:38.542040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780c63ceffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780c640b28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780c640b2890>]}


============================== 22:14:38.544002 | 4c6a8bef-8649-4288-80ed-15f83febbd5f ==============================
[0m22:14:38.544002 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:14:38.544408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:14:38.548814 [info ] [MainThread]: dbt version: 1.8.7
[0m22:14:38.549122 [info ] [MainThread]: python version: 3.10.12
[0m22:14:38.549409 [info ] [MainThread]: python path: /home/hasan/Desktop/MyLearning/research_questions_etl/venv/bin/python3
[0m22:14:38.549655 [info ] [MainThread]: os info: Linux-6.8.0-40-generic-x86_64-with-glibc2.35
[0m22:14:38.869569 [info ] [MainThread]: Using profiles dir at /home/hasan/Desktop/MyLearning/research_questions_etl/dbt
[0m22:14:38.869975 [info ] [MainThread]: Using profiles.yml file at /home/hasan/Desktop/MyLearning/research_questions_etl/dbt/profiles.yml
[0m22:14:38.870336 [info ] [MainThread]: Using dbt_project.yml file at /home/hasan/Desktop/MyLearning/research_questions_etl/dbt/dbt_project.yml
[0m22:14:38.870692 [info ] [MainThread]: adapter type: snowflake
[0m22:14:38.871048 [info ] [MainThread]: adapter version: 1.8.3
[0m22:14:38.942165 [info ] [MainThread]: Configuration:
[0m22:14:38.942567 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:14:38.942875 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:14:38.943147 [info ] [MainThread]: Required dependencies:
[0m22:14:38.943419 [debug] [MainThread]: Executing "git --help"
[0m22:14:38.944801 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialise an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:14:38.945150 [debug] [MainThread]: STDERR: "b''"
[0m22:14:38.945404 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:14:38.945657 [info ] [MainThread]: Connection:
[0m22:14:38.945953 [info ] [MainThread]:   account: oacgvzl-ml59242
[0m22:14:38.946197 [info ] [MainThread]:   user: etl_user
[0m22:14:38.946424 [info ] [MainThread]:   database: research_db
[0m22:14:38.946649 [info ] [MainThread]:   warehouse: etl_warehouse
[0m22:14:38.946885 [info ] [MainThread]:   role: etl_role
[0m22:14:38.947115 [info ] [MainThread]:   schema: etl_schema
[0m22:14:38.947339 [info ] [MainThread]:   authenticator: None
[0m22:14:38.947562 [info ] [MainThread]:   oauth_client_id: None
[0m22:14:38.947789 [info ] [MainThread]:   query_tag: None
[0m22:14:38.948012 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:14:38.948314 [info ] [MainThread]:   host: None
[0m22:14:38.948549 [info ] [MainThread]:   port: None
[0m22:14:38.948776 [info ] [MainThread]:   proxy_host: None
[0m22:14:38.949044 [info ] [MainThread]:   proxy_port: None
[0m22:14:38.949276 [info ] [MainThread]:   protocol: None
[0m22:14:38.949499 [info ] [MainThread]:   connect_retries: 1
[0m22:14:38.949723 [info ] [MainThread]:   connect_timeout: None
[0m22:14:38.949955 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:14:38.950177 [info ] [MainThread]:   retry_all: False
[0m22:14:38.950401 [info ] [MainThread]:   insecure_mode: False
[0m22:14:38.950619 [info ] [MainThread]:   reuse_connections: None
[0m22:14:38.950968 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:14:38.952065 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:14:38.952639 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:14:38.952913 [debug] [MainThread]: On debug: select 1 as id
[0m22:14:38.953151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:39.466136 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.513 seconds
[0m22:14:39.468381 [debug] [MainThread]: On debug: Close
[0m22:14:39.557073 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:14:39.558249 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:14:39.560117 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0532842, "process_user_time": 1.930529, "process_kernel_time": 0.071759, "process_mem_max_rss": "157656", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m22:14:39.561491 [debug] [MainThread]: Command `dbt debug` succeeded at 22:14:39.561260 after 1.05 seconds
[0m22:14:39.562357 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:14:39.563217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780c63ceffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780c4a8fc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780c6268ab90>]}
[0m22:14:39.564244 [debug] [MainThread]: Flushing usage events
[0m22:16:14.969322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74848abd3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484893f1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484893f1b70>]}


============================== 22:16:14.971267 | b5d441bb-c0b6-4a55-b016-62291500a9e4 ==============================
[0m22:16:14.971267 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:16:14.971676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:16:15.359197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d441bb-c0b6-4a55-b016-62291500a9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748489367a90>]}
[0m22:16:15.399647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d441bb-c0b6-4a55-b016-62291500a9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748489f1ab90>]}
[0m22:16:15.400278 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:16:15.410545 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:16:15.518651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:16:15.519341 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m22:16:15.519777 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:16:15.520145 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:16:15.520502 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:16:15.730475 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:16:15.730951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5d441bb-c0b6-4a55-b016-62291500a9e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74848aeb7e80>]}
[0m22:16:15.866151 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2023' which was not found
[0m22:16:15.866931 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.93271637, "process_user_time": 2.319115, "process_kernel_time": 0.072846, "process_mem_max_rss": "159264", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:16:15.867401 [debug] [MainThread]: Command `dbt compile` failed at 22:16:15.867323 after 0.93 seconds
[0m22:16:15.867720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74848abd3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74847129c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74848ab35180>]}
[0m22:16:15.868040 [debug] [MainThread]: Flushing usage events
[0m22:17:33.060814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8536c64100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e853519e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e853519e920>]}


============================== 22:17:33.062772 | 124b2cf9-3bf2-4edc-a713-21a4de0c2e78 ==============================
[0m22:17:33.062772 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:17:33.063269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run-operation --args {"sql": "SHOW TABLES IN RESEARCH_DB.ETL_SCHEMA;"} snowflake_query', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:17:33.453521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '124b2cf9-3bf2-4edc-a713-21a4de0c2e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8536621d20>]}
[0m22:17:33.494186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '124b2cf9-3bf2-4edc-a713-21a4de0c2e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e85357dc250>]}
[0m22:17:33.494842 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:17:33.505266 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:17:33.614028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:17:33.614733 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m22:17:33.615155 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:17:33.615497 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:17:33.615887 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:17:33.823381 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:17:33.823873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '124b2cf9-3bf2-4edc-a713-21a4de0c2e78', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e851d304970>]}
[0m22:17:33.958808 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2023' which was not found
[0m22:17:33.959597 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.9338294, "process_user_time": 2.312711, "process_kernel_time": 0.078921, "process_mem_max_rss": "158928", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:17:33.960114 [debug] [MainThread]: Command `dbt run-operation` failed at 22:17:33.960032 after 0.93 seconds
[0m22:17:33.960439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8536c64100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e85367689a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e851d3776d0>]}
[0m22:17:33.960766 [debug] [MainThread]: Flushing usage events
[0m22:19:33.720621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8c26bbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8c2a82080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8c2a820e0>]}


============================== 22:19:33.722517 | c9c04281-7e96-4fb8-944b-ddbcba301b8f ==============================
[0m22:19:33.722517 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:19:33.722978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m22:19:34.112864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c04281-7e96-4fb8-944b-ddbcba301b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8c2a3f5e0>]}
[0m22:19:34.153680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9c04281-7e96-4fb8-944b-ddbcba301b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8a9332890>]}
[0m22:19:34.154315 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:19:34.164563 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:19:34.274508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:19:34.275480 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m22:19:34.275868 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:19:34.276211 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:19:34.276525 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:19:34.488558 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:19:34.489029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c9c04281-7e96-4fb8-944b-ddbcba301b8f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8c1a62a40>]}
[0m22:19:34.613133 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2023' which was not found
[0m22:19:34.613904 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.92856, "process_user_time": 2.313852, "process_kernel_time": 0.073835, "process_mem_max_rss": "159068", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:19:34.614383 [debug] [MainThread]: Command `dbt compile` failed at 22:19:34.614305 after 0.93 seconds
[0m22:19:34.614706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8c26bbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8a8cf0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8c21a5870>]}
[0m22:19:34.615054 [debug] [MainThread]: Flushing usage events
[0m22:20:42.947985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c4ae680a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c4b173160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c4b1722c0>]}


============================== 22:20:42.949963 | 841f5219-b9e8-4ead-b7a3-27e45e6687ce ==============================
[0m22:20:42.949963 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:20:42.950533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:43.343643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '841f5219-b9e8-4ead-b7a3-27e45e6687ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c317f4310>]}
[0m22:20:43.384318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '841f5219-b9e8-4ead-b7a3-27e45e6687ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c31b3eb90>]}
[0m22:20:43.384941 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:20:43.395533 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:20:43.505091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m22:20:43.506018 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m22:20:43.506371 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m22:20:43.506664 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:20:43.506950 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:20:43.717953 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:20:43.718394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '841f5219-b9e8-4ead-b7a3-27e45e6687ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c4a190310>]}
[0m22:20:43.886388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m22:20:43.898631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '841f5219-b9e8-4ead-b7a3-27e45e6687ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c313d13c0>]}
[0m22:20:43.998238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '841f5219-b9e8-4ead-b7a3-27e45e6687ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c313d31f0>]}
[0m22:20:43.998746 [info ] [MainThread]: Found 16 data tests, 5 models, 1 source, 651 macros
[0m22:20:43.999068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841f5219-b9e8-4ead-b7a3-27e45e6687ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c31b69a80>]}
[0m22:20:44.000685 [info ] [MainThread]: 
[0m22:20:44.001189 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:20:44.005138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_intermediate'
[0m22:20:44.005810 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_staging'
[0m22:20:44.016772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema'
[0m22:20:44.019626 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m22:20:44.021946 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m22:20:44.024440 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m22:20:44.024892 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m22:20:44.025326 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m22:20:44.025638 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m22:20:44.025917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:44.026205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:44.026488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:44.588354 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.562 seconds
[0m22:20:44.590528 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.564 seconds
[0m22:20:44.594804 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m22:20:44.597532 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.571 seconds
[0m22:20:44.601190 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m22:20:44.607211 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m22:20:44.707136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841f5219-b9e8-4ead-b7a3-27e45e6687ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c315071c0>]}
[0m22:20:44.708673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:20:44.709585 [info ] [MainThread]: 
[0m22:20:44.721341 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m22:20:44.722643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.stg_research_questions)
[0m22:20:44.723658 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m22:20:44.737234 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m22:20:44.741812 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m22:20:44.742640 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m22:20:44.743826 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m22:20:44.744266 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m22:20:44.744693 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m22:20:44.745178 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.int_research_questions_unified)
[0m22:20:44.745661 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m22:20:44.746179 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c'
[0m22:20:44.746556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46)
[0m22:20:44.746986 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m22:20:44.747456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.stg_research_questions, now test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe)
[0m22:20:44.747831 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m22:20:44.748152 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m22:20:44.751182 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m22:20:44.751626 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m22:20:44.758766 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c"
[0m22:20:44.763136 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46"
[0m22:20:44.766612 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe"
[0m22:20:44.767275 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m22:20:44.767757 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m22:20:44.768607 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m22:20:44.769290 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m22:20:44.769631 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m22:20:44.770053 [debug] [Thread-3 (]: Began running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m22:20:44.770467 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m22:20:44.771334 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m22:20:44.771666 [debug] [Thread-4 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m22:20:44.772045 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428)
[0m22:20:44.772664 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m22:20:44.773046 [debug] [Thread-1 (]: Began running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m22:20:44.773450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c, now model.research_questions_etl.consolidated_research_questions)
[0m22:20:44.773798 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m22:20:44.774215 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m22:20:44.774644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe, now test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5)
[0m22:20:44.774987 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m22:20:44.780440 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428"
[0m22:20:44.780908 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46, now test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14)
[0m22:20:44.781309 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m22:20:44.783791 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m22:20:44.784347 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m22:20:44.784693 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m22:20:44.787926 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5"
[0m22:20:44.788776 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m22:20:44.792725 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14"
[0m22:20:44.793452 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m22:20:44.794427 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m22:20:44.795403 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m22:20:44.796444 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m22:20:44.797726 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m22:20:44.798673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428, now test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be)
[0m22:20:44.800143 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m22:20:44.801604 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m22:20:44.802478 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m22:20:44.803440 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m22:20:44.804997 [debug] [Thread-1 (]: Began running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m22:20:44.805972 [debug] [Thread-2 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m22:20:44.807145 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.consolidated_research_questions, now test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6)
[0m22:20:44.813293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5, now test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5)
[0m22:20:44.814138 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be"
[0m22:20:44.814961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14, now model.research_questions_etl.answer_option_analysis)
[0m22:20:44.815704 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m22:20:44.816408 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m22:20:44.817050 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m22:20:44.817660 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m22:20:44.823328 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6"
[0m22:20:44.826806 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5"
[0m22:20:44.829690 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m22:20:44.830556 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m22:20:44.831227 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m22:20:44.831774 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m22:20:44.832286 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m22:20:44.832709 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m22:20:44.833331 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m22:20:44.833916 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m22:20:44.834496 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m22:20:44.834939 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be, now model.research_questions_etl.question_evolution)
[0m22:20:44.835382 [debug] [Thread-4 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m22:20:44.835829 [debug] [Thread-1 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m22:20:44.836267 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m22:20:44.836646 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m22:20:44.837018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6, now test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960)
[0m22:20:44.837432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5, now test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0)
[0m22:20:44.837826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.answer_option_analysis, now test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b)
[0m22:20:44.840782 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m22:20:44.841131 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m22:20:44.841468 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m22:20:44.841813 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m22:20:44.845112 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960"
[0m22:20:44.845576 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m22:20:44.849299 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0"
[0m22:20:44.852823 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b"
[0m22:20:44.853412 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m22:20:44.854133 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m22:20:44.854987 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m22:20:44.855391 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m22:20:44.855821 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m22:20:44.856281 [debug] [Thread-3 (]: Began running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m22:20:44.857090 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m22:20:44.857445 [debug] [Thread-4 (]: Began running node test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3
[0m22:20:44.858040 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m22:20:44.858486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.question_evolution, now test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752)
[0m22:20:44.859023 [debug] [Thread-1 (]: Began running node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m22:20:44.859430 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960, now test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3)
[0m22:20:44.859979 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m22:20:44.860391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0, now test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1)
[0m22:20:44.860818 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3
[0m22:20:44.863962 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752"
[0m22:20:44.864362 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m22:20:44.867662 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3"
[0m22:20:44.872033 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1"
[0m22:20:44.872555 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m22:20:44.872973 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3
[0m22:20:44.873486 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m22:20:44.874386 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m22:20:44.875113 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3
[0m22:20:44.876028 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m22:20:44.877205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:44.877570 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b' was properly closed.
[0m22:20:44.877870 [debug] [MainThread]: Connection 'test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752' was properly closed.
[0m22:20:44.878149 [debug] [MainThread]: Connection 'test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1' was properly closed.
[0m22:20:44.878420 [debug] [MainThread]: Connection 'test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3' was properly closed.
[0m22:20:44.881078 [debug] [MainThread]: Command end result
[0m22:20:44.910753 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9980631, "process_user_time": 2.839521, "process_kernel_time": 0.100805, "process_mem_max_rss": "174916", "process_in_blocks": "376", "process_out_blocks": "4488"}
[0m22:20:44.911346 [debug] [MainThread]: Command `dbt compile` succeeded at 22:20:44.911249 after 2.00 seconds
[0m22:20:44.911691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c4ae680a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c2ff68df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c31b3eb90>]}
[0m22:20:44.912062 [debug] [MainThread]: Flushing usage events
[0m22:20:54.912251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d39327dfe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3930da1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3930da1b70>]}


============================== 22:20:54.914180 | f3e6ea03-5c15-4c7d-bcea-bc2c12a915c9 ==============================
[0m22:20:54.914180 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:20:54.914677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:55.304937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3e6ea03-5c15-4c7d-bcea-bc2c12a915c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3930d17a90>]}
[0m22:20:55.346825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3e6ea03-5c15-4c7d-bcea-bc2c12a915c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3931bb2b90>]}
[0m22:20:55.347455 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:20:55.357729 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:20:55.465929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:20:55.466532 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m22:20:55.671770 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:20:55.672208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f3e6ea03-5c15-4c7d-bcea-bc2c12a915c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3918f1a920>]}
[0m22:20:55.765628 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.research_questions_etl.consolidated_research_questions' (models/marts/consolidated_research_questions.sql) depends on a source named 'raw.questions_2022' which was not found
[0m22:20:55.766374 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.88945645, "process_user_time": 2.293251, "process_kernel_time": 0.05503, "process_mem_max_rss": "158704", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m22:20:55.766874 [debug] [MainThread]: Command `dbt compile` failed at 22:20:55.766789 after 0.89 seconds
[0m22:20:55.767201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d39327dfe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d39321f1060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d393236c0a0>]}
[0m22:20:55.767522 [debug] [MainThread]: Flushing usage events
[0m22:21:31.226511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b4fd3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b37f1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b37f1b70>]}


============================== 22:21:31.228497 | b9ed4e83-0144-4d3c-a8c1-851417bc680e ==============================
[0m22:21:31.228497 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:21:31.229152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m22:21:31.617517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9ed4e83-0144-4d3c-a8c1-851417bc680e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b3767a90>]}
[0m22:21:31.658672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9ed4e83-0144-4d3c-a8c1-851417bc680e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b431ab90>]}
[0m22:21:31.659340 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:21:31.673877 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:21:31.799280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:21:31.799672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:21:31.804196 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m22:21:31.843496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ed4e83-0144-4d3c-a8c1-851417bc680e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39b708130>]}
[0m22:21:31.938785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ed4e83-0144-4d3c-a8c1-851417bc680e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39b69bac0>]}
[0m22:21:31.939242 [info ] [MainThread]: Found 16 data tests, 5 models, 1 source, 651 macros
[0m22:21:31.939561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9ed4e83-0144-4d3c-a8c1-851417bc680e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39b6eb4f0>]}
[0m22:21:31.941094 [info ] [MainThread]: 
[0m22:21:31.941569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:21:31.945418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_intermediate'
[0m22:21:31.953004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_staging'
[0m22:21:31.961776 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m22:21:31.962552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema'
[0m22:21:32.012116 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m22:21:32.012631 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m22:21:32.014659 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m22:21:32.015081 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m22:21:32.015455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:32.015804 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m22:21:32.016144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:32.018298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:32.593784 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.577 seconds
[0m22:21:32.597907 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m22:21:32.603615 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.585 seconds
[0m22:21:32.607385 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m22:21:32.988462 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.973 seconds
[0m22:21:32.992384 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m22:21:33.077883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9ed4e83-0144-4d3c-a8c1-851417bc680e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b52b6d40>]}
[0m22:21:33.079559 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:33.080530 [info ] [MainThread]: 
[0m22:21:33.084927 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m22:21:33.086201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m22:21:33.087215 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m22:21:33.097132 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m22:21:33.097847 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m22:21:33.098569 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m22:21:33.099452 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m22:21:33.099881 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m22:21:33.100276 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m22:21:33.100588 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m22:21:33.100961 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.int_research_questions_unified)
[0m22:21:33.101506 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c'
[0m22:21:33.101948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46)
[0m22:21:33.102460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.stg_research_questions, now test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe)
[0m22:21:33.102962 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m22:21:33.103515 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m22:21:33.103981 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m22:21:33.104312 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m22:21:33.107943 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m22:21:33.117002 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c"
[0m22:21:33.122068 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46"
[0m22:21:33.125556 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe"
[0m22:21:33.126203 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m22:21:33.126621 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m22:21:33.127080 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m22:21:33.127721 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m22:21:33.128076 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m22:21:33.128637 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m22:21:33.129162 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m22:21:33.129616 [debug] [Thread-3 (]: Began running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m22:21:33.130458 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m22:21:33.130818 [debug] [Thread-4 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m22:21:33.131235 [debug] [Thread-2 (]: Began running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m22:21:33.131679 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428)
[0m22:21:33.132138 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m22:21:33.132591 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c, now model.research_questions_etl.consolidated_research_questions)
[0m22:21:33.132960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46, now test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5)
[0m22:21:33.133304 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m22:21:33.133716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe, now test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14)
[0m22:21:33.134067 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m22:21:33.134404 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m22:21:33.139400 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428"
[0m22:21:33.139823 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m22:21:33.142169 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m22:21:33.150351 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5"
[0m22:21:33.155053 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14"
[0m22:21:33.155649 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m22:21:33.156175 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m22:21:33.156795 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m22:21:33.157431 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m22:21:33.158207 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m22:21:33.158947 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m22:21:33.159680 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m22:21:33.160368 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m22:21:33.160828 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m22:21:33.161290 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m22:21:33.161910 [debug] [Thread-2 (]: Began running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m22:21:33.162459 [debug] [Thread-1 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m22:21:33.162962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428, now test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be)
[0m22:21:33.163501 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.consolidated_research_questions, now test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6)
[0m22:21:33.163971 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5, now test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5)
[0m22:21:33.164447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14, now model.research_questions_etl.answer_option_analysis)
[0m22:21:33.164847 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m22:21:33.165294 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m22:21:33.165728 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m22:21:33.166137 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m22:21:33.169678 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be"
[0m22:21:33.172949 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6"
[0m22:21:33.176259 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5"
[0m22:21:33.178576 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m22:21:33.179303 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m22:21:33.180001 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m22:21:33.180454 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m22:21:33.181109 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m22:21:33.181540 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m22:21:33.182166 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m22:21:33.182783 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m22:21:33.183240 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m22:21:33.183877 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m22:21:33.184264 [debug] [Thread-2 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m22:21:33.184661 [debug] [Thread-4 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m22:21:33.185114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be, now model.research_questions_etl.question_evolution)
[0m22:21:33.185562 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m22:21:33.186084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5, now test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960)
[0m22:21:33.186521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6, now test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0)
[0m22:21:33.186868 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m22:21:33.187247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.answer_option_analysis, now test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b)
[0m22:21:33.187620 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m22:21:33.187968 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m22:21:33.191628 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m22:21:33.192035 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m22:21:33.195606 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960"
[0m22:21:33.199456 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0"
[0m22:21:33.203919 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b"
[0m22:21:33.204499 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m22:21:33.205355 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m22:21:33.206275 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m22:21:33.206631 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m22:21:33.207249 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m22:21:33.207609 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m22:21:33.207993 [debug] [Thread-3 (]: Began running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m22:21:33.208695 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960
[0m22:21:33.209083 [debug] [Thread-4 (]: Began running node test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3
[0m22:21:33.209712 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m22:21:33.210073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.question_evolution, now test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752)
[0m22:21:33.210481 [debug] [Thread-2 (]: Began running node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m22:21:33.210901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0, now test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3)
[0m22:21:33.211345 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m22:21:33.211727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_question_status__Current.f371476960, now test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1)
[0m22:21:33.212055 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3
[0m22:21:33.215496 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752"
[0m22:21:33.215999 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m22:21:33.221608 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3"
[0m22:21:33.227701 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1"
[0m22:21:33.228294 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3
[0m22:21:33.228704 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m22:21:33.229144 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m22:21:33.229872 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3
[0m22:21:33.230623 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m22:21:33.231309 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m22:21:33.232352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:33.232636 [debug] [MainThread]: Connection 'test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1' was properly closed.
[0m22:21:33.232894 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b' was properly closed.
[0m22:21:33.233127 [debug] [MainThread]: Connection 'test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752' was properly closed.
[0m22:21:33.233349 [debug] [MainThread]: Connection 'test.research_questions_etl.accepted_values_question_evolution_evolution_type__New_Question__Modified_Question__Modified_Answer_Set__Unchanged.4a2c4c03c3' was properly closed.
[0m22:21:33.235498 [debug] [MainThread]: Command end result
[0m22:21:33.265673 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0746903, "process_user_time": 2.529216, "process_kernel_time": 0.115918, "process_mem_max_rss": "168952", "process_out_blocks": "3112", "process_in_blocks": "0"}
[0m22:21:33.266248 [debug] [MainThread]: Command `dbt compile` succeeded at 22:21:33.266154 after 2.08 seconds
[0m22:21:33.266580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b4fd3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39bc8e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b43182e0>]}
[0m22:21:33.266913 [debug] [MainThread]: Flushing usage events
[0m22:21:54.172851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33ba8600d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33b8faeef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33b8facd00>]}


============================== 22:21:54.174862 | 9f629b68-1f05-48c7-ad1e-e918d319015d ==============================
[0m22:21:54.174862 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:21:54.175309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:21:54.562250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33ba6f9720>]}
[0m22:21:54.602294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a14b0d30>]}
[0m22:21:54.602923 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:21:54.614976 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:21:54.722862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:21:54.723253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:21:54.727666 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m22:21:54.778330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a0f04130>]}
[0m22:21:54.876767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a0f05300>]}
[0m22:21:54.877239 [info ] [MainThread]: Found 16 data tests, 5 models, 1 source, 651 macros
[0m22:21:54.877567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a0f073d0>]}
[0m22:21:54.878955 [info ] [MainThread]: 
[0m22:21:54.879425 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:21:54.883211 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:21:54.891713 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:21:54.898127 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:21:54.947925 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:21:54.948500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:21:54.948961 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:21:54.949426 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:21:54.951493 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:21:54.951832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:54.952183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:54.952514 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:21:54.955913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:55.515056 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.563 seconds
[0m22:21:55.518622 [debug] [ThreadPool]: On list_research_db: Close
[0m22:21:55.525216 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.569 seconds
[0m22:21:55.528121 [debug] [ThreadPool]: On list_research_db: Close
[0m22:21:55.531761 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.580 seconds
[0m22:21:55.533964 [debug] [ThreadPool]: On list_research_db: Close
[0m22:21:55.622039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m22:21:55.623571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m22:21:55.631712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m22:21:55.657306 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m22:21:55.660376 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m22:21:55.660674 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m22:21:55.663205 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m22:21:55.663593 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m22:21:55.663864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:55.664179 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m22:21:55.664507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:55.665305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:56.071341 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.407 seconds
[0m22:21:56.075174 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m22:21:56.124003 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.460 seconds
[0m22:21:56.127605 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m22:21:56.312363 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.647 seconds
[0m22:21:56.316101 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m22:21:56.400320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33baab7340>]}
[0m22:21:56.402246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:56.403305 [info ] [MainThread]: 
[0m22:21:56.407847 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m22:21:56.409559 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m22:21:56.411502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m22:21:56.413049 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m22:21:56.432192 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m22:21:56.433067 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m22:21:56.458579 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m22:21:56.459930 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m22:21:56.460291 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m22:21:56.460616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:21:57.890137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.429 seconds
[0m22:21:57.907379 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m22:21:57.985398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a148ec20>]}
[0m22:21:57.987097 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 1.57s]
[0m22:21:57.988578 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m22:21:57.990382 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m22:21:57.991734 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m22:21:57.993353 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.int_research_questions_unified)
[0m22:21:57.994452 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m22:21:58.001304 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m22:21:58.001997 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m22:21:58.005558 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m22:21:58.008814 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m22:21:58.009307 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (-- 

-- WITH questions AS (
--     SELECT
--         question_id,
--         year,
--         question_text,
--         category,
--         is_active,
--         valid_from,
--         valid_to,
--         answer_set
--     FROM research_db.etl_schema_staging.stg_research_questions
-- )

-- SELECT 
--     *,
--     CASE 
--         WHEN is_active AND valid_to IS NULL THEN 'Current'
--         WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
--         ELSE 'Historical'
--     END AS question_status
-- FROM questions


WITH questions_with_status AS (
    SELECT
        *,
        CASE 
            WHEN valid_to IS NULL THEN 'Current'
            WHEN is_active = false THEN 'Deprecated'
            ELSE 'Historical'
        END AS question_status
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT * FROM questions_with_status
        );
[0m22:21:58.009698 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:21:59.432370 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.422 seconds
[0m22:21:59.436381 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m22:21:59.531693 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a0393f40>]}
[0m22:21:59.533523 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.54s]
[0m22:21:59.535205 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m22:21:59.537717 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m22:21:59.539192 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m22:21:59.540631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.consolidated_research_questions)
[0m22:21:59.541903 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m22:21:59.544978 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m22:21:59.545520 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m22:21:59.549366 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m22:21:59.552286 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m22:21:59.552765 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set,
    question_status
FROM research_db.etl_schema_intermediate.int_research_questions_unified
WHERE question_status = 'Current'
        );
[0m22:21:59.553140 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:22:00.455800 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.902 seconds
[0m22:22:00.459752 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m22:22:00.542510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a0f53400>]}
[0m22:22:00.545263 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 1.00s]
[0m22:22:00.547756 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m22:22:00.550033 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m22:22:00.551931 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m22:22:00.552813 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m22:22:00.553922 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m22:22:00.554945 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m22:22:00.555780 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m22:22:00.556649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m22:22:00.561699 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m22:22:00.562322 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m22:22:00.566100 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m22:22:00.566760 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m22:22:00.569999 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m22:22:00.570610 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m22:22:00.574064 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m22:22:00.575671 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m22:22:00.576314 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m22:22:00.577838 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m22:22:00.578352 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:22:00.578850 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (-- 

-- WITH question_history AS (
--     SELECT
--         CAST(year AS INT) || '_' || question_id AS unique_id,
--         year,
--         question_id,
--         question_text,
--         category,
--         answer_set,
--         LAG(question_text) OVER (PARTITION BY question_id ORDER BY year) AS previous_question_text,
--         LAG(answer_set) OVER (PARTITION BY question_id ORDER BY year) AS previous_answer_set,
--         LAG(year) OVER (PARTITION BY question_id ORDER BY year) AS previous_year,
--         FIRST_VALUE(year) OVER (PARTITION BY question_id ORDER BY year) AS first_year
--     FROM research_db.etl_schema.consolidated_research_questions
-- ),

-- answer_set_changes AS (
--     SELECT
--         unique_id,
--         year,
--         ARRAY_AGG(
--             OBJECT_CONSTRUCT(
--                 'action', 
--                 CASE 
--                     WHEN year = first_year THEN 'initial'
--                     WHEN new_option IS NULL THEN 'removed'
--                     WHEN old_option IS NULL THEN 'added'
--                     WHEN new_option != old_option THEN 'modified'
--                     ELSE 'unchanged'
--                 END,
--                 'old_option', old_option,
--                 'new_option', new_option
--             )
--         ) AS changes
--     FROM (
--         SELECT 
--             qh.unique_id,
--             qh.year,
--             qh.first_year,
--             new.value:OptionText::STRING AS new_option,
--             old.value:OptionText::STRING AS old_option
--         FROM question_history qh
--         LEFT JOIN TABLE(FLATTEN(PARSE_JSON(qh.answer_set))) new
--         FULL OUTER JOIN TABLE(FLATTEN(PARSE_JSON(qh.previous_answer_set))) old
--             ON new.index = old.index
--     )
--     GROUP BY unique_id, year, first_year
-- )

-- SELECT
--     qh.unique_id,
--     qh.year,
--     qh.question_id,
--     qh.question_text,
--     qh.category,
--     qh.answer_set,
--     qh.previous_question_text,
--     qh.previous_answer_set,
--     CASE
--         WHEN qh.year = qh.first_year THEN 'New Question'
--         WHEN qh.question_text != qh.previous_question_text THEN 'Modified Question'
--         WHEN qh.answer_set != qh.previous_answer_set THEN 'Modified Answer Set'
--         ELSE 'Unchanged'
--     END AS evolution_type,
--     asc.changes AS answer_set_changes
-- FROM question_history qh
-- LEFT JOIN answer_set_changes asc ON qh.unique_id = asc.unique_id
-- ORDER BY qh.year, qh.question_id



WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
)

SELECT
    question_id,
    year,
    question_text,
    category,
    answer_set,
    CASE
        WHEN previous_question_text IS NULL THEN 'New Question'
        WHEN question_text != previous_question_text THEN 'Modified Question'
        WHEN answer_set != previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type
FROM question_history
        );
[0m22:22:00.580040 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:22:01.991503 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.413 seconds
[0m22:22:01.994416 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.414 seconds
[0m22:22:02.000192 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m22:22:02.005503 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m22:22:02.082978 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a012a230>]}
[0m22:22:02.085645 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 1.53s]
[0m22:22:02.087270 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m22:22:02.090125 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f629b68-1f05-48c7-ad1e-e918d319015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a0383730>]}
[0m22:22:02.091590 [info ] [Thread-3 (]: 5 of 5 OK created sql table model etl_schema.question_evolution ................ [[32mSUCCESS 1[0m in 1.53s]
[0m22:22:02.093106 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m22:22:02.095808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:02.096722 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m22:22:02.097898 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m22:22:02.098731 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m22:22:02.099198 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m22:22:02.099617 [info ] [MainThread]: 
[0m22:22:02.100027 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 7.22 seconds (7.22s).
[0m22:22:02.101040 [debug] [MainThread]: Command end result
[0m22:22:02.135178 [info ] [MainThread]: 
[0m22:22:02.135653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:22:02.136011 [info ] [MainThread]: 
[0m22:22:02.136328 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:22:02.136958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.999205, "process_user_time": 2.998101, "process_kernel_time": 0.120641, "process_mem_max_rss": "171720", "process_in_blocks": "88", "process_out_blocks": "2992"}
[0m22:22:02.137475 [debug] [MainThread]: Command `dbt run` succeeded at 22:22:02.137400 after 8.00 seconds
[0m22:22:02.137789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33ba8600d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33ba6f9720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a33a12b2950>]}
[0m22:22:02.138095 [debug] [MainThread]: Flushing usage events
[0m22:30:34.392480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76939d3780a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76939d672ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76939d670430>]}


============================== 22:30:34.394438 | dcfd0509-d3e4-45d8-aea0-b8ed387d2009 ==============================
[0m22:30:34.394438 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:30:34.394929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'profiles_dir': 'dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:34.785584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76939d215720>]}
[0m22:30:34.827236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7693840d0d30>]}
[0m22:30:34.827895 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:30:34.838820 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:30:34.949880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:34.950295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:34.954777 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m22:30:34.995273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769383b24130>]}
[0m22:30:35.094079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769383b252d0>]}
[0m22:30:35.094851 [info ] [MainThread]: Found 16 data tests, 5 models, 1 source, 651 macros
[0m22:30:35.095404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769383b27340>]}
[0m22:30:35.097067 [info ] [MainThread]: 
[0m22:30:35.097543 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:30:35.101450 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:30:35.102013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:30:35.112943 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:30:35.116537 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:30:35.166135 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:30:35.168036 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:30:35.168460 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:30:35.168865 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:30:35.169153 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:30:35.169471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:35.169848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:35.170114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:35.496851 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.327 seconds
[0m22:30:35.500341 [debug] [ThreadPool]: On list_research_db: Close
[0m22:30:35.673090 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.503 seconds
[0m22:30:35.676412 [debug] [ThreadPool]: On list_research_db: Close
[0m22:30:35.681220 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.511 seconds
[0m22:30:35.686192 [debug] [ThreadPool]: On list_research_db: Close
[0m22:30:35.794285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m22:30:35.795926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m22:30:35.798706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m22:30:35.815845 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m22:30:35.819596 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m22:30:35.824020 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m22:30:35.825045 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m22:30:35.826034 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m22:30:35.827141 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m22:30:35.828101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:35.829134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:35.830288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:36.154717 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.326 seconds
[0m22:30:36.158644 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m22:30:36.293781 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.466 seconds
[0m22:30:36.297524 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m22:30:36.393424 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.563 seconds
[0m22:30:36.397445 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m22:30:36.499712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76939d3d7460>]}
[0m22:30:36.501321 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:30:36.502385 [info ] [MainThread]: 
[0m22:30:36.506949 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m22:30:36.508396 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m22:30:36.509656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.stg_research_questions)
[0m22:30:36.510678 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m22:30:36.528147 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m22:30:36.528796 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m22:30:36.550209 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m22:30:36.551046 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m22:30:36.551397 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m22:30:36.551714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:37.361953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m22:30:37.379159 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m22:30:37.468403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7693840aec20>]}
[0m22:30:37.470117 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 0.96s]
[0m22:30:37.471792 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m22:30:37.473482 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m22:30:37.474856 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m22:30:37.476561 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.int_research_questions_unified)
[0m22:30:37.477588 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m22:30:37.484021 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m22:30:37.484713 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m22:30:37.487443 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m22:30:37.488432 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m22:30:37.488799 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (-- 

-- WITH questions AS (
--     SELECT
--         question_id,
--         year,
--         question_text,
--         category,
--         is_active,
--         valid_from,
--         valid_to,
--         answer_set
--     FROM research_db.etl_schema_staging.stg_research_questions
-- )

-- SELECT 
--     *,
--     CASE 
--         WHEN is_active AND valid_to IS NULL THEN 'Current'
--         WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
--         ELSE 'Historical'
--     END AS question_status
-- FROM questions


WITH questions_with_status AS (
    SELECT
        *,
        CASE 
            WHEN valid_to IS NULL THEN 'Current'
            WHEN is_active = false THEN 'Deprecated'
            ELSE 'Historical'
        END AS question_status
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT * FROM questions_with_status
        );
[0m22:30:37.489147 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:39.113951 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.625 seconds
[0m22:30:39.120079 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m22:30:39.213166 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76939c695c90>]}
[0m22:30:39.215154 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.74s]
[0m22:30:39.216654 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m22:30:39.218561 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m22:30:39.220025 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m22:30:39.221267 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.consolidated_research_questions)
[0m22:30:39.222325 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m22:30:39.231293 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m22:30:39.232629 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m22:30:39.238468 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m22:30:39.239501 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m22:30:39.239922 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set,
    question_status
FROM research_db.etl_schema_intermediate.int_research_questions_unified
WHERE question_status = 'Current'
        );
[0m22:30:39.240286 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:40.649797 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.409 seconds
[0m22:30:40.656335 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m22:30:40.738637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769381b26fb0>]}
[0m22:30:40.740464 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 1.52s]
[0m22:30:40.742091 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m22:30:40.744180 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m22:30:40.745527 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m22:30:40.747147 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m22:30:40.748672 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m22:30:40.750337 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m22:30:40.751695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m22:30:40.753037 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m22:30:40.754664 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m22:30:40.761827 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m22:30:40.768520 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m22:30:40.769600 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m22:30:40.770261 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m22:30:40.774404 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m22:30:40.777505 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m22:30:40.779345 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m22:30:40.779990 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m22:30:40.780542 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:30:40.783230 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m22:30:40.783683 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (-- 

-- WITH question_history AS (
--     SELECT
--         CAST(year AS INT) || '_' || question_id AS unique_id,
--         year,
--         question_id,
--         question_text,
--         category,
--         answer_set,
--         LAG(question_text) OVER (PARTITION BY question_id ORDER BY year) AS previous_question_text,
--         LAG(answer_set) OVER (PARTITION BY question_id ORDER BY year) AS previous_answer_set,
--         LAG(year) OVER (PARTITION BY question_id ORDER BY year) AS previous_year,
--         FIRST_VALUE(year) OVER (PARTITION BY question_id ORDER BY year) AS first_year
--     FROM research_db.etl_schema.consolidated_research_questions
-- ),

-- answer_set_changes AS (
--     SELECT
--         unique_id,
--         year,
--         ARRAY_AGG(
--             OBJECT_CONSTRUCT(
--                 'action', 
--                 CASE 
--                     WHEN year = first_year THEN 'initial'
--                     WHEN new_option IS NULL THEN 'removed'
--                     WHEN old_option IS NULL THEN 'added'
--                     WHEN new_option != old_option THEN 'modified'
--                     ELSE 'unchanged'
--                 END,
--                 'old_option', old_option,
--                 'new_option', new_option
--             )
--         ) AS changes
--     FROM (
--         SELECT 
--             qh.unique_id,
--             qh.year,
--             qh.first_year,
--             new.value:OptionText::STRING AS new_option,
--             old.value:OptionText::STRING AS old_option
--         FROM question_history qh
--         LEFT JOIN TABLE(FLATTEN(PARSE_JSON(qh.answer_set))) new
--         FULL OUTER JOIN TABLE(FLATTEN(PARSE_JSON(qh.previous_answer_set))) old
--             ON new.index = old.index
--     )
--     GROUP BY unique_id, year, first_year
-- )

-- SELECT
--     qh.unique_id,
--     qh.year,
--     qh.question_id,
--     qh.question_text,
--     qh.category,
--     qh.answer_set,
--     qh.previous_question_text,
--     qh.previous_answer_set,
--     CASE
--         WHEN qh.year = qh.first_year THEN 'New Question'
--         WHEN qh.question_text != qh.previous_question_text THEN 'Modified Question'
--         WHEN qh.answer_set != qh.previous_answer_set THEN 'Modified Answer Set'
--         ELSE 'Unchanged'
--     END AS evolution_type,
--     asc.changes AS answer_set_changes
-- FROM question_history qh
-- LEFT JOIN answer_set_changes asc ON qh.unique_id = asc.unique_id
-- ORDER BY qh.year, qh.question_id



WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
)

SELECT
    question_id,
    year,
    question_text,
    category,
    answer_set,
    CASE
        WHEN previous_question_text IS NULL THEN 'New Question'
        WHEN question_text != previous_question_text THEN 'Modified Question'
        WHEN answer_set != previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type
FROM question_history
        );
[0m22:30:40.784094 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:41.745102 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.961 seconds
[0m22:30:41.748606 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m22:30:41.825278 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769381b6e5f0>]}
[0m22:30:41.826525 [info ] [Thread-3 (]: 5 of 5 OK created sql table model etl_schema.question_evolution ................ [[32mSUCCESS 1[0m in 1.07s]
[0m22:30:41.827774 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m22:30:43.207136 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.426 seconds
[0m22:30:43.213661 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m22:30:43.898054 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd0509-d3e4-45d8-aea0-b8ed387d2009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769381b51e40>]}
[0m22:30:43.899959 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 3.15s]
[0m22:30:43.901726 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m22:30:43.904766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:43.905766 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m22:30:43.906597 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m22:30:43.907590 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m22:30:43.908472 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m22:30:43.909594 [info ] [MainThread]: 
[0m22:30:43.910576 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.81 seconds (8.81s).
[0m22:30:43.912902 [debug] [MainThread]: Command end result
[0m22:30:43.945379 [info ] [MainThread]: 
[0m22:30:43.945835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:30:43.946159 [info ] [MainThread]: 
[0m22:30:43.946454 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:30:43.947076 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.590409, "process_user_time": 3.084323, "process_kernel_time": 0.097946, "process_mem_max_rss": "171600", "process_out_blocks": "3000", "process_in_blocks": "0"}
[0m22:30:43.947512 [debug] [MainThread]: Command `dbt run` succeeded at 22:30:43.947441 after 9.59 seconds
[0m22:30:43.947827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76939d3780a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76939c4c9300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769381b24940>]}
[0m22:30:43.948149 [debug] [MainThread]: Flushing usage events
[0m22:33:54.283145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ccb3efeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ccb7bea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ccb7be9b0>]}


============================== 22:33:54.285114 | 5bbd3252-a3d8-4c09-99f0-9fa919d1848e ==============================
[0m22:33:54.285114 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:33:54.285541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'dbt', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:33:54.681479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bbd3252-a3d8-4c09-99f0-9fa919d1848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ccb3116c0>]}
[0m22:33:54.723431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bbd3252-a3d8-4c09-99f0-9fa919d1848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758cca5d2020>]}
[0m22:33:54.724090 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:33:54.735537 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:33:54.848814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:33:54.849447 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/staging/stg_research_questions.sql
[0m22:33:55.057772 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:33:55.058224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5bbd3252-a3d8-4c09-99f0-9fa919d1848e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758cb1bae920>]}
[0m22:33:55.194798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m22:33:55.206678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bbd3252-a3d8-4c09-99f0-9fa919d1848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758cb1b1e3b0>]}
[0m22:33:55.305969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bbd3252-a3d8-4c09-99f0-9fa919d1848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ccb76ec80>]}
[0m22:33:55.306444 [info ] [MainThread]: Found 16 data tests, 5 models, 1 source, 651 macros
[0m22:33:55.306781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bbd3252-a3d8-4c09-99f0-9fa919d1848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ccb76e170>]}
[0m22:33:55.308201 [info ] [MainThread]: 
[0m22:33:55.308678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:33:55.312558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:33:55.313137 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:33:55.318986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:33:55.325963 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:33:55.328488 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:33:55.330879 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:33:55.331293 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:33:55.331751 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:33:55.332060 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:33:55.332370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:55.332703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:55.333094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:55.661181 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.328 seconds
[0m22:33:55.664704 [debug] [ThreadPool]: On list_research_db: Close
[0m22:33:55.799068 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.467 seconds
[0m22:33:55.801528 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.468 seconds
[0m22:33:55.804847 [debug] [ThreadPool]: On list_research_db: Close
[0m22:33:55.808271 [debug] [ThreadPool]: On list_research_db: Close
[0m22:33:55.927203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m22:33:55.928720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m22:33:55.930377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m22:33:55.955038 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m22:33:55.961418 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m22:33:55.966102 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m22:33:55.966850 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m22:33:55.967556 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m22:33:55.968257 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m22:33:55.968835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:33:55.969482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:33:55.970137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:33:56.273768 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.305 seconds
[0m22:33:56.275851 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m22:33:56.278706 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.309 seconds
[0m22:33:56.281279 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m22:33:56.414509 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.444 seconds
[0m22:33:56.418352 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m22:33:56.499720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bbd3252-a3d8-4c09-99f0-9fa919d1848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758cb1c2da50>]}
[0m22:33:56.501339 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:33:56.502348 [info ] [MainThread]: 
[0m22:33:56.506868 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m22:33:56.508333 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m22:33:56.509633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m22:33:56.510611 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m22:33:56.527595 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m22:33:56.528390 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m22:33:56.549902 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m22:33:56.551040 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m22:33:56.551403 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

WITH deduplicated AS (
    SELECT
        question_id,
        year,
        question_text,
        CASE 
            WHEN category LIKE 'New %' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS category,
        is_active,
        valid_from,
        valid_to,
        answer_set,
        question_status,
        ROW_NUMBER() OVER (PARTITION BY question_id, year ORDER BY valid_from DESC) AS rn
    FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
)

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set,
    question_status
FROM deduplicated
WHERE rn = 1
        );
[0m22:33:56.551777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:57.496010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.944 seconds
[0m22:33:57.513228 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m22:33:57.611470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bbd3252-a3d8-4c09-99f0-9fa919d1848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758cb2112b90>]}
[0m22:33:57.613454 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 1.10s]
[0m22:33:57.615191 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m22:33:57.617432 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m22:33:57.618919 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m22:33:57.620489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.int_research_questions_unified)
[0m22:33:57.621509 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m22:33:57.626492 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m22:33:57.627666 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m22:33:57.630950 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m22:33:57.631957 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m22:33:57.632336 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (-- 

-- WITH questions AS (
--     SELECT
--         question_id,
--         year,
--         question_text,
--         category,
--         is_active,
--         valid_from,
--         valid_to,
--         answer_set
--     FROM research_db.etl_schema_staging.stg_research_questions
-- )

-- SELECT 
--     *,
--     CASE 
--         WHEN is_active AND valid_to IS NULL THEN 'Current'
--         WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
--         ELSE 'Historical'
--     END AS question_status
-- FROM questions


WITH questions_with_status AS (
    SELECT
        *,
        CASE 
            WHEN valid_to IS NULL THEN 'Current'
            WHEN is_active = false THEN 'Deprecated'
            ELSE 'Historical'
        END AS question_status
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT * FROM questions_with_status
        );
[0m22:33:57.632689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:57.924707 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7628d-0001-5d4d-0001-de660002b77a
[0m22:33:57.925980 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'QUESTION_STATUS'
[0m22:33:57.927358 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m22:33:58.025729 [debug] [Thread-3 (]: Database Error in model int_research_questions_unified (models/intermediate/int_research_questions_unified.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'QUESTION_STATUS'
  compiled code at target/run/research_questions_etl/models/intermediate/int_research_questions_unified.sql
[0m22:33:58.027084 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bbd3252-a3d8-4c09-99f0-9fa919d1848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758cb07ef880>]}
[0m22:33:58.028722 [error] [Thread-3 (]: 2 of 5 ERROR creating sql table model etl_schema_intermediate.int_research_questions_unified  [[31mERROR[0m in 0.41s]
[0m22:33:58.030261 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m22:33:58.033107 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m22:33:58.034726 [info ] [Thread-2 (]: 3 of 5 SKIP relation etl_schema.consolidated_research_questions ................ [[33mSKIP[0m]
[0m22:33:58.036097 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m22:33:58.038027 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m22:33:58.039184 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m22:33:58.040335 [info ] [Thread-4 (]: 4 of 5 SKIP relation etl_schema.answer_option_analysis ......................... [[33mSKIP[0m]
[0m22:33:58.041986 [info ] [Thread-3 (]: 5 of 5 SKIP relation etl_schema.question_evolution ............................. [[33mSKIP[0m]
[0m22:33:58.043348 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m22:33:58.044454 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m22:33:58.048049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:58.049666 [debug] [MainThread]: Connection 'model.research_questions_etl.int_research_questions_unified' was properly closed.
[0m22:33:58.050932 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m22:33:58.052015 [debug] [MainThread]: Connection 'list_research_db_etl_schema_staging' was properly closed.
[0m22:33:58.052971 [info ] [MainThread]: 
[0m22:33:58.053625 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m22:33:58.055053 [debug] [MainThread]: Command end result
[0m22:33:58.085870 [info ] [MainThread]: 
[0m22:33:58.086303 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:33:58.086592 [info ] [MainThread]: 
[0m22:33:58.086917 [error] [MainThread]:   Database Error in model int_research_questions_unified (models/intermediate/int_research_questions_unified.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'QUESTION_STATUS'
  compiled code at target/run/research_questions_etl/models/intermediate/int_research_questions_unified.sql
[0m22:33:58.087186 [info ] [MainThread]: 
[0m22:33:58.087452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
[0m22:33:58.088074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8414211, "process_user_time": 3.082926, "process_kernel_time": 0.100834, "process_mem_max_rss": "176308", "process_in_blocks": "776", "process_out_blocks": "4296", "command_success": false}
[0m22:33:58.088564 [debug] [MainThread]: Command `dbt run` failed at 22:33:58.088486 after 3.84 seconds
[0m22:33:58.088910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758ccb3efeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758cb0b95060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758cc9e79960>]}
[0m22:33:58.089237 [debug] [MainThread]: Flushing usage events
[0m22:34:51.101407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77547c5d3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77547bf5aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77547adaebc0>]}


============================== 22:34:51.103430 | 96857219-8410-4fe6-88de-c4fff502cc9e ==============================
[0m22:34:51.103430 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:34:51.103865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:51.534486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77547c4f96f0>]}
[0m22:34:51.580932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754632b2110>]}
[0m22:34:51.581635 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:34:51.593615 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:34:51.713302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:34:51.714042 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m22:34:51.944357 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:34:51.944839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775462e622f0>]}
[0m22:34:52.094542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m22:34:52.107683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775462b422f0>]}
[0m22:34:52.208665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775462cc9450>]}
[0m22:34:52.209162 [info ] [MainThread]: Found 16 data tests, 5 models, 1 source, 651 macros
[0m22:34:52.209504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775462cc9420>]}
[0m22:34:52.211138 [info ] [MainThread]: 
[0m22:34:52.211705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:34:52.215996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:34:52.216683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:34:52.222485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m22:34:52.234331 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:34:52.234753 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:34:52.236974 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m22:34:52.237336 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:34:52.237657 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:34:52.238010 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m22:34:52.238318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:52.238636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:52.238996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:52.597768 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.359 seconds
[0m22:34:52.599116 [debug] [ThreadPool]: On list_research_db: Close
[0m22:34:52.776297 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m22:34:52.778102 [debug] [ThreadPool]: On list_research_db: Close
[0m22:34:52.784668 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.546 seconds
[0m22:34:52.786232 [debug] [ThreadPool]: On list_research_db: Close
[0m22:34:52.866461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m22:34:52.867051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m22:34:52.867687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m22:34:52.880132 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m22:34:52.882284 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m22:34:52.884599 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m22:34:52.885100 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m22:34:52.885565 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m22:34:52.885919 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m22:34:52.886299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:52.886662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:52.886981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:53.147206 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.260 seconds
[0m22:34:53.150776 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m22:34:53.155839 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.269 seconds
[0m22:34:53.159753 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m22:34:53.266299 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.380 seconds
[0m22:34:53.267667 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m22:34:53.358477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775462b31720>]}
[0m22:34:53.359197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:53.359537 [info ] [MainThread]: 
[0m22:34:53.361364 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m22:34:53.361834 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m22:34:53.362222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m22:34:53.362537 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m22:34:53.370241 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m22:34:53.371039 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m22:34:53.393316 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m22:34:53.394619 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m22:34:53.395048 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

WITH deduplicated AS (
    SELECT
        question_id,
        year,
        question_text,
        CASE 
            WHEN category LIKE 'New %' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS category,
        is_active,
        valid_from,
        valid_to,
        answer_set,
        question_status,
        ROW_NUMBER() OVER (PARTITION BY question_id, year ORDER BY valid_from DESC) AS rn
    FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
)

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set,
    question_status
FROM deduplicated
WHERE rn = 1
        );
[0m22:34:53.395376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:54.387474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m22:34:54.407455 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m22:34:54.481195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77546328ebf0>]}
[0m22:34:54.481949 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 1.12s]
[0m22:34:54.482549 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m22:34:54.483556 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m22:34:54.484228 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m22:34:54.485478 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.int_research_questions_unified)
[0m22:34:54.486057 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m22:34:54.490499 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m22:34:54.491205 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m22:34:54.495190 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m22:34:54.496504 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m22:34:54.496959 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (-- 

-- WITH questions AS (
--     SELECT
--         question_id,
--         year,
--         question_text,
--         category,
--         is_active,
--         valid_from,
--         valid_to,
--         answer_set
--     FROM research_db.etl_schema_staging.stg_research_questions
-- )

-- SELECT 
--     *,
--     CASE 
--         WHEN is_active AND valid_to IS NULL THEN 'Current'
--         WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
--         ELSE 'Historical'
--     END AS question_status
-- FROM questions


WITH latest_questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        valid_from,
        valid_to,
        answer_set,
        question_status,
        ROW_NUMBER() OVER (PARTITION BY SPLIT_PART(question_id, '_', 2) ORDER BY year DESC) AS rn
    FROM research_db.etl_schema_staging.stg_research_questions
)

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set,
    question_status
FROM latest_questions
WHERE rn = 1
        );
[0m22:34:54.497327 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:55.728062 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.230 seconds
[0m22:34:55.734556 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m22:34:55.815916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775461b4bfd0>]}
[0m22:34:55.816632 [info ] [Thread-3 (]: 2 of 5 OK created sql table model etl_schema_intermediate.int_research_questions_unified  [[32mSUCCESS 1[0m in 1.33s]
[0m22:34:55.817178 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m22:34:55.817899 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m22:34:55.818364 [info ] [Thread-2 (]: 3 of 5 START sql table model etl_schema.consolidated_research_questions ........ [RUN]
[0m22:34:55.818763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.consolidated_research_questions)
[0m22:34:55.819078 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m22:34:55.821767 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m22:34:55.822239 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m22:34:55.825992 [debug] [Thread-2 (]: Writing runtime sql for node "model.research_questions_etl.consolidated_research_questions"
[0m22:34:55.826844 [debug] [Thread-2 (]: Using snowflake connection "model.research_questions_etl.consolidated_research_questions"
[0m22:34:55.827188 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.consolidated_research_questions"} */
create or replace transient table research_db.etl_schema.consolidated_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set,
    question_status
FROM research_db.etl_schema_intermediate.int_research_questions_unified
WHERE question_status = 'Current'
        );
[0m22:34:55.827491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:56.762792 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.935 seconds
[0m22:34:56.764842 [debug] [Thread-2 (]: On model.research_questions_etl.consolidated_research_questions: Close
[0m22:34:56.841912 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77546178ce20>]}
[0m22:34:56.842567 [info ] [Thread-2 (]: 3 of 5 OK created sql table model etl_schema.consolidated_research_questions ... [[32mSUCCESS 1[0m in 1.02s]
[0m22:34:56.843084 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m22:34:56.843890 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m22:34:56.844316 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m22:34:56.844786 [info ] [Thread-4 (]: 4 of 5 START sql table model etl_schema.answer_option_analysis ................. [RUN]
[0m22:34:56.845296 [info ] [Thread-3 (]: 5 of 5 START sql table model etl_schema.question_evolution ..................... [RUN]
[0m22:34:56.845811 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.research_questions_etl.answer_option_analysis'
[0m22:34:56.846195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now model.research_questions_etl.question_evolution)
[0m22:34:56.846484 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m22:34:56.846766 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m22:34:56.849424 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m22:34:56.854531 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m22:34:56.853345 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m22:34:56.859601 [debug] [Thread-4 (]: Writing runtime sql for node "model.research_questions_etl.answer_option_analysis"
[0m22:34:56.860588 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m22:34:56.865750 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.question_evolution"
[0m22:34:56.868038 [debug] [Thread-4 (]: Using snowflake connection "model.research_questions_etl.answer_option_analysis"
[0m22:34:56.868842 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.answer_option_analysis"} */
create or replace transient table research_db.etl_schema.answer_option_analysis
         as
        (

WITH answer_options AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        f.value:OptionOrder::INT as option_order,
        f.value:OptionText::STRING as option_text
    FROM research_db.etl_schema.consolidated_research_questions,
    LATERAL FLATTEN(input => PARSE_JSON(answer_set)) f
)

SELECT
    question_id,
    year,
    question_text,
    category,
    option_order,
    option_text,
    COUNT(*) OVER (PARTITION BY question_id) as total_options,
    LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) as previous_option_text,
    CASE
        WHEN LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) IS NULL THEN 'New'
        WHEN option_text != LAG(option_text) OVER (PARTITION BY question_id, option_order ORDER BY year) THEN 'Modified'
        ELSE 'Unchanged'
    END as option_change_status
FROM answer_options
ORDER BY year, question_id, option_order
        );
[0m22:34:56.869496 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:34:56.871862 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.question_evolution"
[0m22:34:56.875312 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.question_evolution"} */
create or replace transient table research_db.etl_schema.question_evolution
         as
        (-- 

-- WITH question_history AS (
--     SELECT
--         CAST(year AS INT) || '_' || question_id AS unique_id,
--         year,
--         question_id,
--         question_text,
--         category,
--         answer_set,
--         LAG(question_text) OVER (PARTITION BY question_id ORDER BY year) AS previous_question_text,
--         LAG(answer_set) OVER (PARTITION BY question_id ORDER BY year) AS previous_answer_set,
--         LAG(year) OVER (PARTITION BY question_id ORDER BY year) AS previous_year,
--         FIRST_VALUE(year) OVER (PARTITION BY question_id ORDER BY year) AS first_year
--     FROM research_db.etl_schema.consolidated_research_questions
-- ),

-- answer_set_changes AS (
--     SELECT
--         unique_id,
--         year,
--         ARRAY_AGG(
--             OBJECT_CONSTRUCT(
--                 'action', 
--                 CASE 
--                     WHEN year = first_year THEN 'initial'
--                     WHEN new_option IS NULL THEN 'removed'
--                     WHEN old_option IS NULL THEN 'added'
--                     WHEN new_option != old_option THEN 'modified'
--                     ELSE 'unchanged'
--                 END,
--                 'old_option', old_option,
--                 'new_option', new_option
--             )
--         ) AS changes
--     FROM (
--         SELECT 
--             qh.unique_id,
--             qh.year,
--             qh.first_year,
--             new.value:OptionText::STRING AS new_option,
--             old.value:OptionText::STRING AS old_option
--         FROM question_history qh
--         LEFT JOIN TABLE(FLATTEN(PARSE_JSON(qh.answer_set))) new
--         FULL OUTER JOIN TABLE(FLATTEN(PARSE_JSON(qh.previous_answer_set))) old
--             ON new.index = old.index
--     )
--     GROUP BY unique_id, year, first_year
-- )

-- SELECT
--     qh.unique_id,
--     qh.year,
--     qh.question_id,
--     qh.question_text,
--     qh.category,
--     qh.answer_set,
--     qh.previous_question_text,
--     qh.previous_answer_set,
--     CASE
--         WHEN qh.year = qh.first_year THEN 'New Question'
--         WHEN qh.question_text != qh.previous_question_text THEN 'Modified Question'
--         WHEN qh.answer_set != qh.previous_answer_set THEN 'Modified Answer Set'
--         ELSE 'Unchanged'
--     END AS evolution_type,
--     asc.changes AS answer_set_changes
-- FROM question_history qh
-- LEFT JOIN answer_set_changes asc ON qh.unique_id = asc.unique_id
-- ORDER BY qh.year, qh.question_id



WITH question_history AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        answer_set,
        LAG(question_text) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_question_text,
        LAG(answer_set) OVER (PARTITION BY SPLIT_PART(question_id, '_', 1) ORDER BY year) AS previous_answer_set
    FROM research_db.etl_schema_intermediate.int_research_questions_unified
)

SELECT
    question_id,
    year,
    question_text,
    category,
    answer_set,
    CASE
        WHEN previous_question_text IS NULL THEN 'New Question'
        WHEN question_text != previous_question_text THEN 'Modified Question'
        WHEN answer_set != previous_answer_set THEN 'Modified Answer Set'
        ELSE 'Unchanged'
    END AS evolution_type
FROM question_history
        );
[0m22:34:56.876492 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:57.565998 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m22:34:57.571838 [debug] [Thread-3 (]: On model.research_questions_etl.question_evolution: Close
[0m22:34:57.625330 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m22:34:57.630422 [debug] [Thread-4 (]: On model.research_questions_etl.answer_option_analysis: Close
[0m22:34:57.648043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7754617ead10>]}
[0m22:34:57.649762 [info ] [Thread-3 (]: 5 of 5 OK created sql table model etl_schema.question_evolution ................ [[32mSUCCESS 1[0m in 0.80s]
[0m22:34:57.651539 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m22:34:57.703719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96857219-8410-4fe6-88de-c4fff502cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77546177e680>]}
[0m22:34:57.704394 [info ] [Thread-4 (]: 4 of 5 OK created sql table model etl_schema.answer_option_analysis ............ [[32mSUCCESS 1[0m in 0.86s]
[0m22:34:57.704906 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m22:34:57.706626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:57.706934 [debug] [MainThread]: Connection 'model.research_questions_etl.question_evolution' was properly closed.
[0m22:34:57.707210 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m22:34:57.707455 [debug] [MainThread]: Connection 'model.research_questions_etl.consolidated_research_questions' was properly closed.
[0m22:34:57.707690 [debug] [MainThread]: Connection 'model.research_questions_etl.answer_option_analysis' was properly closed.
[0m22:34:57.708021 [info ] [MainThread]: 
[0m22:34:57.708323 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m22:34:57.709218 [debug] [MainThread]: Command end result
[0m22:34:57.807340 [info ] [MainThread]: 
[0m22:34:57.807842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:57.808150 [info ] [MainThread]: 
[0m22:34:57.808436 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:34:57.809064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7447557, "process_user_time": 3.201568, "process_kernel_time": 0.112353, "process_mem_max_rss": "176684", "process_out_blocks": "4392", "process_in_blocks": "0"}
[0m22:34:57.809528 [debug] [MainThread]: Command `dbt run` succeeded at 22:34:57.809451 after 6.75 seconds
[0m22:34:57.809850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77547c5d3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77547b3f1f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775462cdf250>]}
[0m22:34:57.810172 [debug] [MainThread]: Flushing usage events
[0m23:00:17.914912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a80c9dfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a80afa2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a80afa29b0>]}


============================== 23:00:17.917403 | 41f32a7b-0abd-4f49-a38d-b654d0fde614 ==============================
[0m23:00:17.917403 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:00:17.917856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'profiles_dir': 'dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:00:18.337053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f32a7b-0abd-4f49-a38d-b654d0fde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a80c9056c0>]}
[0m23:00:18.379576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f32a7b-0abd-4f49-a38d-b654d0fde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a80bbc2020>]}
[0m23:00:18.380423 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:00:18.393266 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:00:18.525251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:00:18.525871 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m23:00:18.526291 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m23:00:18.526652 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m23:00:18.751068 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:00:18.751539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '41f32a7b-0abd-4f49-a38d-b654d0fde614', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7f30be920>]}
[0m23:00:18.936000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m23:00:18.947998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41f32a7b-0abd-4f49-a38d-b654d0fde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7f2f4ded0>]}
[0m23:00:19.069405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41f32a7b-0abd-4f49-a38d-b654d0fde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7f36e84c0>]}
[0m23:00:19.069957 [info ] [MainThread]: Found 16 data tests, 5 models, 1 source, 651 macros
[0m23:00:19.070309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f32a7b-0abd-4f49-a38d-b654d0fde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7f36ebd60>]}
[0m23:00:19.071732 [info ] [MainThread]: 
[0m23:00:19.072222 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:00:19.076304 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:00:19.077053 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:00:19.088149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:00:19.090116 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:00:19.092492 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:00:19.094545 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:00:19.094910 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:00:19.095294 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:00:19.095631 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:00:19.095949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:19.096276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:19.096598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:19.787328 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.691 seconds
[0m23:00:19.790674 [debug] [ThreadPool]: On list_research_db: Close
[0m23:00:19.794260 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.698 seconds
[0m23:00:19.797315 [debug] [ThreadPool]: On list_research_db: Close
[0m23:00:19.936626 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.841 seconds
[0m23:00:19.940203 [debug] [ThreadPool]: On list_research_db: Close
[0m23:00:20.041177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m23:00:20.049403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m23:00:20.061275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m23:00:20.081809 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m23:00:20.094485 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m23:00:20.100362 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m23:00:20.101332 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m23:00:20.102378 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m23:00:20.103493 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m23:00:20.104531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:20.105526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:20.106495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:20.370260 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.265 seconds
[0m23:00:20.373939 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m23:00:20.380772 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.274 seconds
[0m23:00:20.384497 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m23:00:20.540591 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.436 seconds
[0m23:00:20.542054 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m23:00:20.620102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f32a7b-0abd-4f49-a38d-b654d0fde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7f34a7c70>]}
[0m23:00:20.621632 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:20.622563 [info ] [MainThread]: 
[0m23:00:20.633597 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m23:00:20.635316 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m23:00:20.636653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m23:00:20.637707 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m23:00:20.652565 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m23:00:20.653556 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m23:00:20.675489 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m23:00:20.677361 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m23:00:20.677774 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

WITH deduplicated AS (
    SELECT
        question_id,
        year,
        question_text,
        CASE 
            WHEN category LIKE 'New %' THEN REPLACE(category, 'New ', '')
            ELSE category
        END AS category,
        is_active,
        valid_from,
        valid_to,
        answer_set,
        question_status,
        ROW_NUMBER() OVER (PARTITION BY question_id, year ORDER BY valid_from DESC) AS rn
    FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
)

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    valid_from,
    valid_to,
    answer_set,
    question_status
FROM deduplicated
WHERE rn = 1
        );
[0m23:00:20.678115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:21.907051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.229 seconds
[0m23:00:21.935719 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m23:00:22.021050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f32a7b-0abd-4f49-a38d-b654d0fde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7f369ab90>]}
[0m23:00:22.022781 [info ] [Thread-1 (]: 1 of 5 OK created sql table model etl_schema_staging.stg_research_questions .... [[32mSUCCESS 1[0m in 1.38s]
[0m23:00:22.024483 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m23:00:22.026688 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m23:00:22.028132 [info ] [Thread-3 (]: 2 of 5 START sql table model etl_schema_intermediate.int_research_questions_unified  [RUN]
[0m23:00:22.029319 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.int_research_questions_unified)
[0m23:00:22.030788 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m23:00:22.043150 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m23:00:22.050788 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m23:00:22.056176 [debug] [Thread-3 (]: Writing runtime sql for node "model.research_questions_etl.int_research_questions_unified"
[0m23:00:22.057939 [debug] [Thread-3 (]: Using snowflake connection "model.research_questions_etl.int_research_questions_unified"
[0m23:00:22.058349 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.int_research_questions_unified"} */
create or replace transient table research_db.etl_schema_intermediate.int_research_questions_unified
         as
        (

WITH questions AS (
    SELECT
        question_id,
        year,
        question_text,
        category,
        is_active,
        answer_set,
        previous_answer_set,
        valid_to,
        first_seen_year,
        previous_version_id,
        match_score,
        answer_set_version,
        text_changed
    FROM research_db.etl_schema_staging.stg_research_questions
),

latest_questions AS (
    SELECT
        *,
        ROW_NUMBER() OVER (PARTITION BY SPLIT_PART(question_id, '_', 2) ORDER BY year DESC) AS rn
    FROM questions
)

SELECT
    question_id,
    year,
    question_text,
    category,
    is_active,
    answer_set,
    previous_answer_set,
    valid_to,
    first_seen_year,
    previous_version_id,
    match_score,
    answer_set_version,
    text_changed,
    CASE 
        WHEN is_active AND valid_to IS NULL THEN 'Current'
        WHEN NOT is_active AND valid_to IS NOT NULL THEN 'Deprecated'
        ELSE 'Historical'
    END AS question_status
FROM latest_questions
WHERE rn = 1
        );
[0m23:00:22.058707 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:22.518189 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b76848-0001-5df9-0001-de66000381e2
[0m23:00:22.519372 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'PREVIOUS_ANSWER_SET'
[0m23:00:22.520648 [debug] [Thread-3 (]: On model.research_questions_etl.int_research_questions_unified: Close
[0m23:00:22.601140 [debug] [Thread-3 (]: Database Error in model int_research_questions_unified (models/intermediate/int_research_questions_unified.sql)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/intermediate/int_research_questions_unified.sql
[0m23:00:22.602433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f32a7b-0abd-4f49-a38d-b654d0fde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7f1b83b80>]}
[0m23:00:22.604034 [error] [Thread-3 (]: 2 of 5 ERROR creating sql table model etl_schema_intermediate.int_research_questions_unified  [[31mERROR[0m in 0.57s]
[0m23:00:22.605667 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m23:00:22.608845 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m23:00:22.610029 [info ] [Thread-2 (]: 3 of 5 SKIP relation etl_schema.consolidated_research_questions ................ [[33mSKIP[0m]
[0m23:00:22.611266 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m23:00:22.613517 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m23:00:22.614675 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m23:00:22.615939 [info ] [Thread-4 (]: 4 of 5 SKIP relation etl_schema.answer_option_analysis ......................... [[33mSKIP[0m]
[0m23:00:22.617636 [info ] [Thread-3 (]: 5 of 5 SKIP relation etl_schema.question_evolution ............................. [[33mSKIP[0m]
[0m23:00:22.619439 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m23:00:22.621054 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m23:00:22.623955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:22.624932 [debug] [MainThread]: Connection 'list_research_db_etl_schema' was properly closed.
[0m23:00:22.625770 [debug] [MainThread]: Connection 'model.research_questions_etl.int_research_questions_unified' was properly closed.
[0m23:00:22.626384 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m23:00:22.627308 [info ] [MainThread]: 
[0m23:00:22.628205 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m23:00:22.630430 [debug] [MainThread]: Command end result
[0m23:00:22.664068 [info ] [MainThread]: 
[0m23:00:22.664508 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:00:22.664782 [info ] [MainThread]: 
[0m23:00:22.665104 [error] [MainThread]:   Database Error in model int_research_questions_unified (models/intermediate/int_research_questions_unified.sql)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/intermediate/int_research_questions_unified.sql
[0m23:00:22.665361 [info ] [MainThread]: 
[0m23:00:22.665619 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
[0m23:00:22.666466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.7890654, "process_user_time": 3.217071, "process_kernel_time": 0.164492, "process_mem_max_rss": "176316", "process_in_blocks": "47024", "process_out_blocks": "4320", "command_success": false}
[0m23:00:22.666952 [debug] [MainThread]: Command `dbt run` failed at 23:00:22.666877 after 4.79 seconds
[0m23:00:22.667287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a80c9dfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a80bdb2fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a80bbc2020>]}
[0m23:00:22.667600 [debug] [MainThread]: Flushing usage events
[0m23:03:10.345400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac12efdbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac12d5580a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac12d559f90>]}


============================== 23:03:10.347365 | c3aa4dd3-a842-49e8-ad20-29d1de857f18 ==============================
[0m23:03:10.347365 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:03:10.347795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:03:10.760213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3aa4dd3-a842-49e8-ad20-29d1de857f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac115cfd1e0>]}
[0m23:03:10.802229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3aa4dd3-a842-49e8-ad20-29d1de857f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac115d21a20>]}
[0m23:03:10.802898 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:03:10.813245 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:03:10.924818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:03:10.925748 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m23:03:10.926120 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m23:03:10.926432 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/staging/stg_research_questions.sql
[0m23:03:11.140154 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:03:11.140612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c3aa4dd3-a842-49e8-ad20-29d1de857f18', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac12e3876a0>]}
[0m23:03:11.330266 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m23:03:11.342053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3aa4dd3-a842-49e8-ad20-29d1de857f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac12d515b40>]}
[0m23:03:11.441654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3aa4dd3-a842-49e8-ad20-29d1de857f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1156a8250>]}
[0m23:03:11.442140 [info ] [MainThread]: Found 19 data tests, 5 models, 1 source, 651 macros
[0m23:03:11.442460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3aa4dd3-a842-49e8-ad20-29d1de857f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1156a86d0>]}
[0m23:03:11.443864 [info ] [MainThread]: 
[0m23:03:11.444367 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:11.448245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:03:11.454310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:03:11.460283 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:03:11.462975 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:03:11.463395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:03:11.463874 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:03:11.464199 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:03:11.465982 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:03:11.466329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:11.466642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:11.466930 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:03:11.470879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:11.962743 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.496 seconds
[0m23:03:11.966222 [debug] [ThreadPool]: On list_research_db: Close
[0m23:03:12.003444 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m23:03:12.006997 [debug] [ThreadPool]: On list_research_db: Close
[0m23:03:12.041172 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.570 seconds
[0m23:03:12.044368 [debug] [ThreadPool]: On list_research_db: Close
[0m23:03:12.127528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m23:03:12.129077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m23:03:12.132038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m23:03:12.162567 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m23:03:12.167211 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m23:03:12.171776 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m23:03:12.172562 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m23:03:12.173181 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m23:03:12.173666 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m23:03:12.174224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:12.174824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:12.175345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:12.493690 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.318 seconds
[0m23:03:12.496429 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.322 seconds
[0m23:03:12.500069 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m23:03:12.503738 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m23:03:12.616875 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.443 seconds
[0m23:03:12.620910 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m23:03:12.705136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3aa4dd3-a842-49e8-ad20-29d1de857f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1158d64d0>]}
[0m23:03:12.706707 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:03:12.707640 [info ] [MainThread]: 
[0m23:03:12.712163 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m23:03:12.713512 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m23:03:12.714935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m23:03:12.715974 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m23:03:12.732865 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m23:03:12.733688 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m23:03:12.756015 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m23:03:12.757023 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m23:03:12.757384 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    CASE 
        WHEN category LIKE 'New %' THEN REPLACE(category, 'New ', '')
        ELSE category
    END AS category,
    is_active,
    answer_set,
    valid_to,
    first_seen_year,
    previous_version_id,
    match_score,
    answer_set_version,
    text_changed
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m23:03:12.757692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:13.078400 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7684b-0001-5df9-0001-de6600038206
[0m23:03:13.078894 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 4
invalid identifier 'FIRST_SEEN_YEAR'
[0m23:03:13.079501 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m23:03:13.187949 [debug] [Thread-1 (]: Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 16 at position 4
  invalid identifier 'FIRST_SEEN_YEAR'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:03:13.191558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3aa4dd3-a842-49e8-ad20-29d1de857f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1141281c0>]}
[0m23:03:13.193153 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model etl_schema_staging.stg_research_questions  [[31mERROR[0m in 0.47s]
[0m23:03:13.194657 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m23:03:13.197492 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m23:03:13.199180 [info ] [Thread-3 (]: 2 of 5 SKIP relation etl_schema_intermediate.int_research_questions_unified .... [[33mSKIP[0m]
[0m23:03:13.200724 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m23:03:13.203111 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m23:03:13.204293 [info ] [Thread-2 (]: 3 of 5 SKIP relation etl_schema.consolidated_research_questions ................ [[33mSKIP[0m]
[0m23:03:13.205797 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m23:03:13.208079 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m23:03:13.209491 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m23:03:13.210672 [info ] [Thread-4 (]: 4 of 5 SKIP relation etl_schema.answer_option_analysis ......................... [[33mSKIP[0m]
[0m23:03:13.212069 [info ] [Thread-3 (]: 5 of 5 SKIP relation etl_schema.question_evolution ............................. [[33mSKIP[0m]
[0m23:03:13.213315 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m23:03:13.214250 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m23:03:13.216913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:13.217658 [debug] [MainThread]: Connection 'list_research_db_etl_schema_staging' was properly closed.
[0m23:03:13.217909 [debug] [MainThread]: Connection 'list_research_db_etl_schema' was properly closed.
[0m23:03:13.218153 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m23:03:13.218462 [info ] [MainThread]: 
[0m23:03:13.218816 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m23:03:13.219440 [debug] [MainThread]: Command end result
[0m23:03:13.250547 [info ] [MainThread]: 
[0m23:03:13.250980 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:03:13.251309 [info ] [MainThread]: 
[0m23:03:13.251664 [error] [MainThread]:   Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 16 at position 4
  invalid identifier 'FIRST_SEEN_YEAR'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:03:13.251939 [info ] [MainThread]: 
[0m23:03:13.252230 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m23:03:13.252873 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.943608, "process_user_time": 3.137008, "process_kernel_time": 0.10893, "process_mem_max_rss": "176052", "process_out_blocks": "4328", "command_success": false, "process_in_blocks": "0"}
[0m23:03:13.253333 [debug] [MainThread]: Command `dbt run` failed at 23:03:13.253248 after 2.94 seconds
[0m23:03:13.253685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac12efdbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac1156a8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac115a61360>]}
[0m23:03:13.254005 [debug] [MainThread]: Flushing usage events
[0m23:06:20.395749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a73ecf3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a73f0ba080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a73f0ba0e0>]}


============================== 23:06:20.397806 | cfd17086-755c-4a92-9f21-166c7861f0f5 ==============================
[0m23:06:20.397806 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:06:20.398337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:06:20.800898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfd17086-755c-4a92-9f21-166c7861f0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a73f0775e0>]}
[0m23:06:20.842617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfd17086-755c-4a92-9f21-166c7861f0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a725ad2890>]}
[0m23:06:20.843272 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:06:20.853707 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:06:20.967261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:06:20.968075 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m23:06:20.968524 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m23:06:20.968853 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/staging/stg_research_questions.sql
[0m23:06:21.194233 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:06:21.194707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cfd17086-755c-4a92-9f21-166c7861f0f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a73e7503a0>]}
[0m23:06:21.346634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m23:06:21.359602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfd17086-755c-4a92-9f21-166c7861f0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a72536d9f0>]}
[0m23:06:21.466966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfd17086-755c-4a92-9f21-166c7861f0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7254ef2e0>]}
[0m23:06:21.467458 [info ] [MainThread]: Found 19 data tests, 5 models, 1 source, 651 macros
[0m23:06:21.467801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd17086-755c-4a92-9f21-166c7861f0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a72552cf10>]}
[0m23:06:21.469477 [info ] [MainThread]: 
[0m23:06:21.469945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:06:21.474105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema'
[0m23:06:21.479952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_staging'
[0m23:06:21.489151 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m23:06:21.489931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_intermediate'
[0m23:06:21.492169 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m23:06:21.492625 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m23:06:21.494560 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m23:06:21.494988 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m23:06:21.495561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:21.495899 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m23:06:21.496265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:21.498336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:22.146288 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.648 seconds
[0m23:06:22.148265 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.652 seconds
[0m23:06:22.150887 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m23:06:22.152304 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m23:06:22.154004 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.658 seconds
[0m23:06:22.156850 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m23:06:22.246686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd17086-755c-4a92-9f21-166c7861f0f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a73eddad70>]}
[0m23:06:22.247308 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:06:22.247628 [info ] [MainThread]: 
[0m23:06:22.249159 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m23:06:22.249647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m23:06:22.250161 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m23:06:22.260342 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m23:06:22.261088 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m23:06:22.261883 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m23:06:22.262623 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m23:06:22.263047 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m23:06:22.263375 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m23:06:22.263748 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m23:06:22.264177 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.int_research_questions_unified)
[0m23:06:22.264965 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c'
[0m23:06:22.265516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46)
[0m23:06:22.266122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.stg_research_questions, now test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe)
[0m23:06:22.266741 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m23:06:22.267331 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m23:06:22.267909 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m23:06:22.268545 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m23:06:22.275057 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m23:06:22.292243 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c"
[0m23:06:22.293070 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46"
[0m23:06:22.298979 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe"
[0m23:06:22.300100 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m23:06:22.301424 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m23:06:22.301900 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m23:06:22.302378 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m23:06:22.302838 [debug] [Thread-3 (]: Began running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m23:06:22.303324 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m23:06:22.304379 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m23:06:22.305158 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m23:06:22.305652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428)
[0m23:06:22.306415 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m23:06:22.306875 [debug] [Thread-1 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m23:06:22.307458 [debug] [Thread-4 (]: Began running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m23:06:22.307870 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m23:06:22.308309 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m23:06:22.308840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe, now model.research_questions_etl.consolidated_research_questions)
[0m23:06:22.309361 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c, now test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5)
[0m23:06:22.314829 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428"
[0m23:06:22.315297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46, now test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14)
[0m23:06:22.315740 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m23:06:22.316088 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m23:06:22.316487 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m23:06:22.319866 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m23:06:22.323275 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5"
[0m23:06:22.323663 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m23:06:22.326855 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14"
[0m23:06:22.327831 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m23:06:22.328318 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m23:06:22.328736 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m23:06:22.329221 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m23:06:22.329580 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m23:06:22.330205 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m23:06:22.330858 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m23:06:22.331311 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428, now test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be)
[0m23:06:22.331878 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m23:06:22.332250 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m23:06:22.332759 [debug] [Thread-1 (]: Began running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m23:06:22.333393 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m23:06:22.333816 [debug] [Thread-2 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m23:06:22.334212 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5, now test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6)
[0m23:06:22.334624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.consolidated_research_questions, now test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5)
[0m23:06:22.337929 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be"
[0m23:06:22.338283 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14, now model.research_questions_etl.answer_option_analysis)
[0m23:06:22.338566 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m23:06:22.338879 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m23:06:22.339332 [debug] [Thread-2 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m23:06:22.342270 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6"
[0m23:06:22.342696 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m23:06:22.345857 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5"
[0m23:06:22.348815 [debug] [Thread-2 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m23:06:22.349226 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m23:06:22.349866 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m23:06:22.350466 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m23:06:22.351216 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m23:06:22.351660 [debug] [Thread-2 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m23:06:22.352180 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m23:06:22.352945 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m23:06:22.353456 [debug] [Thread-4 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d
[0m23:06:22.354262 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m23:06:22.354773 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be, now model.research_questions_etl.question_evolution)
[0m23:06:22.355236 [debug] [Thread-1 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd
[0m23:06:22.355771 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6, now test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d)
[0m23:06:22.356334 [debug] [Thread-2 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m23:06:22.356917 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m23:06:22.357600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5, now test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd)
[0m23:06:22.357994 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d
[0m23:06:22.358456 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.answer_option_analysis, now test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0)
[0m23:06:22.362345 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m23:06:22.362950 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd
[0m23:06:22.368586 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d"
[0m23:06:22.368991 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m23:06:22.372634 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd"
[0m23:06:22.373105 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m23:06:22.376470 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0"
[0m23:06:22.376812 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d
[0m23:06:22.377621 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m23:06:22.378107 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd
[0m23:06:22.378704 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d
[0m23:06:22.379027 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m23:06:22.379418 [debug] [Thread-3 (]: Began running node test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270
[0m23:06:22.380181 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd
[0m23:06:22.380571 [debug] [Thread-4 (]: Began running node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80
[0m23:06:22.381158 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m23:06:22.381624 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.question_evolution, now test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270)
[0m23:06:22.382077 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m23:06:22.382478 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d, now test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80)
[0m23:06:22.382870 [debug] [Thread-2 (]: Began running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m23:06:22.383271 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270
[0m23:06:22.383712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd, now test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b)
[0m23:06:22.384039 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80
[0m23:06:22.384389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0, now test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752)
[0m23:06:22.391233 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270"
[0m23:06:22.391607 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m23:06:22.397810 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80"
[0m23:06:22.398184 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m23:06:22.401323 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b"
[0m23:06:22.401750 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270
[0m23:06:22.405104 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752"
[0m23:06:22.405445 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80
[0m23:06:22.405918 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m23:06:22.406589 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270
[0m23:06:22.407257 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80
[0m23:06:22.407567 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m23:06:22.408129 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m23:06:22.408599 [debug] [Thread-3 (]: Began running node test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9
[0m23:06:22.409115 [debug] [Thread-4 (]: Began running node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m23:06:22.409660 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m23:06:22.410172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270, now test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9)
[0m23:06:22.410629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80, now test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1)
[0m23:06:22.411114 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9
[0m23:06:22.411545 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m23:06:22.415107 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9"
[0m23:06:22.421389 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1"
[0m23:06:22.421907 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9
[0m23:06:22.422525 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9
[0m23:06:22.422849 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m23:06:22.423502 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m23:06:22.424209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:22.424473 [debug] [MainThread]: Connection 'test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9' was properly closed.
[0m23:06:22.424706 [debug] [MainThread]: Connection 'test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752' was properly closed.
[0m23:06:22.424930 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b' was properly closed.
[0m23:06:22.425163 [debug] [MainThread]: Connection 'test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1' was properly closed.
[0m23:06:22.427595 [debug] [MainThread]: Command end result
[0m23:06:22.457650 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0984943, "process_user_time": 2.870854, "process_kernel_time": 0.107582, "process_mem_max_rss": "175188", "process_in_blocks": "24", "process_out_blocks": "4616"}
[0m23:06:22.458260 [debug] [MainThread]: Command `dbt compile` succeeded at 23:06:22.458170 after 2.10 seconds
[0m23:06:22.458590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a73ecf3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a73ce019c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a725ad2890>]}
[0m23:06:22.458908 [debug] [MainThread]: Flushing usage events
[0m23:06:28.796825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880351dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788033759000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788033759f90>]}


============================== 23:06:28.798796 | 9e65f408-1386-4467-9c31-df74ead5f3fe ==============================
[0m23:06:28.798796 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:06:28.799226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:06:29.196596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e65f408-1386-4467-9c31-df74ead5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880351016f0>]}
[0m23:06:29.238028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e65f408-1386-4467-9c31-df74ead5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880345ba410>]}
[0m23:06:29.238652 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:06:29.249286 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:06:29.366317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:06:29.366903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:06:29.372255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m23:06:29.416715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e65f408-1386-4467-9c31-df74ead5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78801b97c3a0>]}
[0m23:06:29.522292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e65f408-1386-4467-9c31-df74ead5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78801b97e6e0>]}
[0m23:06:29.522768 [info ] [MainThread]: Found 19 data tests, 5 models, 1 source, 651 macros
[0m23:06:29.523100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e65f408-1386-4467-9c31-df74ead5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78803375b280>]}
[0m23:06:29.524500 [info ] [MainThread]: 
[0m23:06:29.524953 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:06:29.528702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:06:29.536203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:06:29.544164 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:06:29.544738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:06:29.592544 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:06:29.594270 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:06:29.596237 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:06:29.596644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:29.596983 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:06:29.597293 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:06:29.599462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:29.599847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:29.923177 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.323 seconds
[0m23:06:29.926606 [debug] [ThreadPool]: On list_research_db: Close
[0m23:06:29.929233 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.333 seconds
[0m23:06:29.934914 [debug] [ThreadPool]: On list_research_db: Close
[0m23:06:30.074653 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.475 seconds
[0m23:06:30.078203 [debug] [ThreadPool]: On list_research_db: Close
[0m23:06:30.186881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m23:06:30.195240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m23:06:30.201821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m23:06:30.222369 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m23:06:30.227452 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m23:06:30.232726 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m23:06:30.233698 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m23:06:30.234784 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m23:06:30.235883 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m23:06:30.236911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:30.237916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:30.239046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:30.517176 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.279 seconds
[0m23:06:30.518686 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m23:06:30.653099 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.414 seconds
[0m23:06:30.653962 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.417 seconds
[0m23:06:30.655271 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m23:06:30.656620 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m23:06:30.747357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e65f408-1386-4467-9c31-df74ead5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78801bd6c430>]}
[0m23:06:30.749162 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:06:30.750104 [info ] [MainThread]: 
[0m23:06:30.754880 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m23:06:30.756332 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m23:06:30.757722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.stg_research_questions)
[0m23:06:30.758731 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m23:06:30.771811 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m23:06:30.772546 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m23:06:30.795263 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m23:06:30.796263 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m23:06:30.796638 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    CASE 
        WHEN category LIKE 'New %' THEN REPLACE(category, 'New ', '')
        ELSE category
    END AS category,
    is_active,
    answer_set,
    valid_to,
    previous_version_id,
    match_score,
    answer_set_version,
    text_changed
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m23:06:30.796945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:06:31.139864 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7684e-0001-5e0c-0001-de660003a1f2
[0m23:06:31.141116 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 4
invalid identifier 'PREVIOUS_VERSION_ID'
[0m23:06:31.142440 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m23:06:31.232247 [debug] [Thread-1 (]: Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 16 at position 4
  invalid identifier 'PREVIOUS_VERSION_ID'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:06:31.238089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e65f408-1386-4467-9c31-df74ead5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788034580e20>]}
[0m23:06:31.240650 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model etl_schema_staging.stg_research_questions  [[31mERROR[0m in 0.48s]
[0m23:06:31.242544 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m23:06:31.245061 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m23:06:31.245811 [info ] [Thread-3 (]: 2 of 5 SKIP relation etl_schema_intermediate.int_research_questions_unified .... [[33mSKIP[0m]
[0m23:06:31.246474 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m23:06:31.247350 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m23:06:31.247883 [info ] [Thread-2 (]: 3 of 5 SKIP relation etl_schema.consolidated_research_questions ................ [[33mSKIP[0m]
[0m23:06:31.248424 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m23:06:31.249268 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m23:06:31.249747 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m23:06:31.250147 [info ] [Thread-4 (]: 4 of 5 SKIP relation etl_schema.answer_option_analysis ......................... [[33mSKIP[0m]
[0m23:06:31.250569 [info ] [Thread-3 (]: 5 of 5 SKIP relation etl_schema.question_evolution ............................. [[33mSKIP[0m]
[0m23:06:31.250976 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m23:06:31.251337 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m23:06:31.252308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:31.252666 [debug] [MainThread]: Connection 'list_research_db_etl_schema_intermediate' was properly closed.
[0m23:06:31.253040 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m23:06:31.253356 [debug] [MainThread]: Connection 'list_research_db_etl_schema_staging' was properly closed.
[0m23:06:31.253717 [info ] [MainThread]: 
[0m23:06:31.254108 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m23:06:31.254856 [debug] [MainThread]: Command end result
[0m23:06:31.286077 [info ] [MainThread]: 
[0m23:06:31.286563 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:06:31.286897 [info ] [MainThread]: 
[0m23:06:31.287268 [error] [MainThread]:   Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 16 at position 4
  invalid identifier 'PREVIOUS_VERSION_ID'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:06:31.287565 [info ] [MainThread]: 
[0m23:06:31.287849 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m23:06:31.288468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5276842, "process_user_time": 2.707092, "process_kernel_time": 0.123456, "process_mem_max_rss": "170020", "process_out_blocks": "2920", "command_success": false, "process_in_blocks": "0"}
[0m23:06:31.288911 [debug] [MainThread]: Command `dbt run` failed at 23:06:31.288836 after 2.53 seconds
[0m23:06:31.289283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880351dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7880345ba410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788034c57880>]}
[0m23:06:31.289606 [debug] [MainThread]: Flushing usage events
[0m23:08:54.231872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a5d4e7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a5d8adb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a5d8adba0>]}


============================== 23:08:54.233875 | 972b739b-5b4f-446c-a426-6a7d8f70b3cd ==============================
[0m23:08:54.233875 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:08:54.234310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:08:54.650467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '972b739b-5b4f-446c-a426-6a7d8f70b3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a441f0f70>]}
[0m23:08:54.693174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '972b739b-5b4f-446c-a426-6a7d8f70b3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a5bd0fca0>]}
[0m23:08:54.693844 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:08:54.704639 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:08:54.819331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:08:54.820127 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/schema.yml
[0m23:08:54.820569 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/consolidated_research_questions.sql
[0m23:08:54.820997 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/intermediate/int_research_questions_unified.sql
[0m23:08:54.821313 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/staging/stg_research_questions.sql
[0m23:08:55.036761 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:08:55.037235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '972b739b-5b4f-446c-a426-6a7d8f70b3cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a43c9e320>]}
[0m23:08:55.232853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m23:08:55.245198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '972b739b-5b4f-446c-a426-6a7d8f70b3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a437ce350>]}
[0m23:08:55.353585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '972b739b-5b4f-446c-a426-6a7d8f70b3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a43c52bf0>]}
[0m23:08:55.354102 [info ] [MainThread]: Found 19 data tests, 5 models, 1 source, 651 macros
[0m23:08:55.354455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '972b739b-5b4f-446c-a426-6a7d8f70b3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a43c4dae0>]}
[0m23:08:55.356180 [info ] [MainThread]: 
[0m23:08:55.356676 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:08:55.360586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_intermediate'
[0m23:08:55.361091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema'
[0m23:08:55.366928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_staging'
[0m23:08:55.374859 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m23:08:55.377240 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m23:08:55.379951 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m23:08:55.380357 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m23:08:55.380761 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m23:08:55.381154 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m23:08:55.381518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:55.381925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:55.382275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:56.879885 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.497 seconds
[0m23:08:56.882493 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m23:08:56.884303 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.503 seconds
[0m23:08:56.885387 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m23:08:56.891376 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.509 seconds
[0m23:08:56.895047 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m23:08:56.998553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '972b739b-5b4f-446c-a426-6a7d8f70b3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a43c61360>]}
[0m23:08:56.999081 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:08:56.999411 [info ] [MainThread]: 
[0m23:08:57.000898 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m23:08:57.001319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m23:08:57.001655 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m23:08:57.009011 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m23:08:57.009724 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m23:08:57.010417 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m23:08:57.011340 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m23:08:57.011835 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.int_research_questions_unified)
[0m23:08:57.012357 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m23:08:57.012746 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.int_research_questions_unified
[0m23:08:57.013097 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m23:08:57.013540 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m23:08:57.014172 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c'
[0m23:08:57.017082 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.int_research_questions_unified"
[0m23:08:57.017707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46)
[0m23:08:57.018192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.stg_research_questions, now test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe)
[0m23:08:57.018680 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m23:08:57.019240 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m23:08:57.019657 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m23:08:57.020217 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.int_research_questions_unified
[0m23:08:57.027499 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c"
[0m23:08:57.031079 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46"
[0m23:08:57.035302 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe"
[0m23:08:57.036066 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m23:08:57.036619 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m23:08:57.037149 [debug] [Thread-3 (]: Began running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m23:08:57.037564 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m23:08:57.038151 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m23:08:57.038722 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c
[0m23:08:57.039133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.int_research_questions_unified, now test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428)
[0m23:08:57.039825 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46
[0m23:08:57.040357 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe
[0m23:08:57.040705 [debug] [Thread-4 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m23:08:57.041110 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m23:08:57.041539 [debug] [Thread-2 (]: Began running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m23:08:57.042030 [debug] [Thread-1 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m23:08:57.042435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_id.9874d2654c, now model.research_questions_etl.consolidated_research_questions)
[0m23:08:57.047921 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428"
[0m23:08:57.048488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_question_text.8e646c9a46, now test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5)
[0m23:08:57.048912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_stg_research_questions_year.a7e94ae4fe, now test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14)
[0m23:08:57.049358 [debug] [Thread-4 (]: Began compiling node model.research_questions_etl.consolidated_research_questions
[0m23:08:57.049812 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m23:08:57.050175 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m23:08:57.052871 [debug] [Thread-4 (]: Writing injected SQL for node "model.research_questions_etl.consolidated_research_questions"
[0m23:08:57.053257 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m23:08:57.056910 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5"
[0m23:08:57.060175 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14"
[0m23:08:57.061013 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428
[0m23:08:57.061379 [debug] [Thread-4 (]: Began executing node model.research_questions_etl.consolidated_research_questions
[0m23:08:57.061901 [debug] [Thread-3 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m23:08:57.062290 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m23:08:57.062620 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m23:08:57.063224 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m23:08:57.063640 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_stg_research_questions_question_id.42e9615428, now test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be)
[0m23:08:57.064289 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5
[0m23:08:57.064835 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14
[0m23:08:57.065208 [debug] [Thread-4 (]: Began running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m23:08:57.065754 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m23:08:57.066184 [debug] [Thread-2 (]: Began running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m23:08:57.066575 [debug] [Thread-1 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m23:08:57.067065 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.consolidated_research_questions, now test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6)
[0m23:08:57.071645 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be"
[0m23:08:57.072143 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_int_research_questions_unified_question_status__Current__Historical__Deprecated.b21d04f7c5, now test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5)
[0m23:08:57.072548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_id.2ee86f8b14, now model.research_questions_etl.answer_option_analysis)
[0m23:08:57.072904 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m23:08:57.073451 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m23:08:57.073806 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.answer_option_analysis
[0m23:08:57.074139 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m23:08:57.077551 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6"
[0m23:08:57.080986 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5"
[0m23:08:57.083477 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.answer_option_analysis"
[0m23:08:57.084192 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be
[0m23:08:57.084769 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m23:08:57.085282 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m23:08:57.085726 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m23:08:57.086095 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.answer_option_analysis
[0m23:08:57.086921 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6
[0m23:08:57.087742 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5
[0m23:08:57.088222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_question_text.1536e919be, now model.research_questions_etl.question_evolution)
[0m23:08:57.089141 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m23:08:57.089783 [debug] [Thread-4 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d
[0m23:08:57.090395 [debug] [Thread-2 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd
[0m23:08:57.090849 [debug] [Thread-3 (]: Began compiling node model.research_questions_etl.question_evolution
[0m23:08:57.091466 [debug] [Thread-1 (]: Began running node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m23:08:57.092031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.not_null_int_research_questions_unified_year.5c657bcef6, now test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d)
[0m23:08:57.092442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.unique_int_research_questions_unified_question_id.f1ea6f28d5, now test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd)
[0m23:08:57.096110 [debug] [Thread-3 (]: Writing injected SQL for node "model.research_questions_etl.question_evolution"
[0m23:08:57.096670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.answer_option_analysis, now test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0)
[0m23:08:57.097230 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d
[0m23:08:57.097690 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd
[0m23:08:57.098200 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m23:08:57.102068 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d"
[0m23:08:57.102441 [debug] [Thread-3 (]: Began executing node model.research_questions_etl.question_evolution
[0m23:08:57.107237 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd"
[0m23:08:57.112306 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0"
[0m23:08:57.113168 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m23:08:57.113784 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d
[0m23:08:57.114342 [debug] [Thread-3 (]: Began running node test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270
[0m23:08:57.114662 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd
[0m23:08:57.115217 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m23:08:57.115942 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d
[0m23:08:57.116381 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.research_questions_etl.question_evolution, now test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270)
[0m23:08:57.116945 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd
[0m23:08:57.117639 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0
[0m23:08:57.118189 [debug] [Thread-4 (]: Began running node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80
[0m23:08:57.118584 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270
[0m23:08:57.118943 [debug] [Thread-2 (]: Began running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m23:08:57.119396 [debug] [Thread-1 (]: Began running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m23:08:57.119959 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_category__Demographics__Research_Topic_A__Research_Topic_B__Topic_C__Topic_D.104424dc3d, now test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80)
[0m23:08:57.123888 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270"
[0m23:08:57.124354 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_is_active__True__False.4624c641bd, now test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b)
[0m23:08:57.124828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.accepted_values_consolidated_research_questions_year__2021__2022__2023.f7e07997d0, now test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752)
[0m23:08:57.125407 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80
[0m23:08:57.125918 [debug] [Thread-2 (]: Began compiling node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m23:08:57.126425 [debug] [Thread-1 (]: Began compiling node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m23:08:57.130237 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80"
[0m23:08:57.130670 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270
[0m23:08:57.134347 [debug] [Thread-2 (]: Writing injected SQL for node "test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b"
[0m23:08:57.140689 [debug] [Thread-1 (]: Writing injected SQL for node "test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752"
[0m23:08:57.141697 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270
[0m23:08:57.142142 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80
[0m23:08:57.142822 [debug] [Thread-2 (]: Began executing node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m23:08:57.143349 [debug] [Thread-1 (]: Began executing node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m23:08:57.143981 [debug] [Thread-3 (]: Began running node test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9
[0m23:08:57.144706 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80
[0m23:08:57.145483 [debug] [Thread-2 (]: Finished running node test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b
[0m23:08:57.146223 [debug] [Thread-1 (]: Finished running node test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752
[0m23:08:57.146868 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.dbt_utils_expression_is_true_consolidated_research_questions_json_array_length_parse_json_answer_set_0.4199c01270, now test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9)
[0m23:08:57.147356 [debug] [Thread-4 (]: Began running node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m23:08:57.147948 [debug] [Thread-3 (]: Began compiling node test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9
[0m23:08:57.148352 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.research_questions_etl.dbt_utils_unique_combination_of_columns_consolidated_research_questions_question_id__year.81b4f90f80, now test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1)
[0m23:08:57.152536 [debug] [Thread-3 (]: Writing injected SQL for node "test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9"
[0m23:08:57.152964 [debug] [Thread-4 (]: Began compiling node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m23:08:57.159255 [debug] [Thread-4 (]: Writing injected SQL for node "test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1"
[0m23:08:57.159812 [debug] [Thread-4 (]: Began executing node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m23:08:57.160215 [debug] [Thread-3 (]: Began executing node test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9
[0m23:08:57.160864 [debug] [Thread-4 (]: Finished running node test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1
[0m23:08:57.161493 [debug] [Thread-3 (]: Finished running node test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9
[0m23:08:57.162471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:57.162771 [debug] [MainThread]: Connection 'test.research_questions_etl.dbt_utils_expression_is_true_question_evolution_evolution_type_IN_New_Question_Modified_Question_Modified_Answer_Set_Unchanged_.ea3cb202a9' was properly closed.
[0m23:08:57.163031 [debug] [MainThread]: Connection 'test.research_questions_etl.not_null_consolidated_research_questions_question_id.c79a7b324b' was properly closed.
[0m23:08:57.163272 [debug] [MainThread]: Connection 'test.research_questions_etl.unique_consolidated_research_questions_question_id.c58b610752' was properly closed.
[0m23:08:57.163502 [debug] [MainThread]: Connection 'test.research_questions_etl.relationships_question_evolution_question_id__question_id__ref_consolidated_research_questions_.883a3021d1' was properly closed.
[0m23:08:57.166030 [debug] [MainThread]: Command end result
[0m23:08:57.197998 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.0030768, "process_user_time": 2.924177, "process_kernel_time": 0.099801, "process_mem_max_rss": "174892", "process_out_blocks": "4608", "process_in_blocks": "0"}
[0m23:08:57.198590 [debug] [MainThread]: Command `dbt compile` succeeded at 23:08:57.198492 after 3.00 seconds
[0m23:08:57.199002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a5d4e7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a5e2904c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1a5c6cb850>]}
[0m23:08:57.199382 [debug] [MainThread]: Flushing usage events
[0m23:09:00.399812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805224effa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805228c2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805228c29b0>]}


============================== 23:09:00.401804 | cd661699-d42b-480f-b871-8c1905cae8dd ==============================
[0m23:09:00.401804 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:09:00.402273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:09:00.810675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd661699-d42b-480f-b871-8c1905cae8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805091afc70>]}
[0m23:09:00.853001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd661699-d42b-480f-b871-8c1905cae8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805091d2860>]}
[0m23:09:00.853629 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:09:00.864172 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:09:00.979217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:00.979639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:00.984315 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m23:09:01.025925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd661699-d42b-480f-b871-8c1905cae8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780508ca03d0>]}
[0m23:09:01.128046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd661699-d42b-480f-b871-8c1905cae8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780508ca3b80>]}
[0m23:09:01.128582 [info ] [MainThread]: Found 19 data tests, 5 models, 1 source, 651 macros
[0m23:09:01.128927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd661699-d42b-480f-b871-8c1905cae8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780508ca20b0>]}
[0m23:09:01.130446 [info ] [MainThread]: 
[0m23:09:01.130946 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:09:01.135151 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:09:01.142799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:09:01.149640 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:09:01.150208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:09:01.200944 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:09:01.201433 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:09:01.203322 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:09:01.203598 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:09:01.203988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:01.204500 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:09:01.204869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:01.206999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:01.779698 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.576 seconds
[0m23:09:01.782405 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.577 seconds
[0m23:09:01.784627 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.578 seconds
[0m23:09:01.788103 [debug] [ThreadPool]: On list_research_db: Close
[0m23:09:01.791365 [debug] [ThreadPool]: On list_research_db: Close
[0m23:09:01.794483 [debug] [ThreadPool]: On list_research_db: Close
[0m23:09:01.905154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m23:09:01.907250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m23:09:01.910123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m23:09:01.932438 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m23:09:01.937536 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m23:09:01.941454 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m23:09:01.942297 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m23:09:01.943162 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m23:09:01.944075 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m23:09:01.944896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:01.945809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:01.946751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:02.274722 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.329 seconds
[0m23:09:02.279709 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m23:09:02.281709 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.335 seconds
[0m23:09:02.287648 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m23:09:02.307688 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.363 seconds
[0m23:09:02.311399 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m23:09:02.412596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd661699-d42b-480f-b871-8c1905cae8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780508fafeb0>]}
[0m23:09:02.414176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:02.415128 [info ] [MainThread]: 
[0m23:09:02.419366 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m23:09:02.420729 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m23:09:02.421908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m23:09:02.422988 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m23:09:02.438789 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m23:09:02.439428 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m23:09:02.461836 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m23:09:02.462939 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m23:09:02.463321 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    CASE 
        WHEN category LIKE 'New %' THEN REPLACE(category, 'New ', '')
        ELSE category
    END AS category,
    is_active,
    TRY_PARSE_JSON(answer_set) AS answer_set,
    TRY_PARSE_JSON(previous_answer_set) AS previous_answer_set,
    valid_to,
    first_seen_year,
    previous_version_id,
    match_score,
    answer_set_version,
    text_changed
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m23:09:02.463618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:02.725395 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b76851-0001-5de9-0001-de6600037536
[0m23:09:02.726643 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 19
invalid identifier 'PREVIOUS_ANSWER_SET'
[0m23:09:02.727889 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m23:09:02.825810 [debug] [Thread-1 (]: Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 19
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:09:02.829730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd661699-d42b-480f-b871-8c1905cae8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780521895f60>]}
[0m23:09:02.831372 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model etl_schema_staging.stg_research_questions  [[31mERROR[0m in 0.41s]
[0m23:09:02.833118 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m23:09:02.836360 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m23:09:02.837699 [info ] [Thread-3 (]: 2 of 5 SKIP relation etl_schema_intermediate.int_research_questions_unified .... [[33mSKIP[0m]
[0m23:09:02.838827 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m23:09:02.841415 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m23:09:02.842557 [info ] [Thread-2 (]: 3 of 5 SKIP relation etl_schema.consolidated_research_questions ................ [[33mSKIP[0m]
[0m23:09:02.843691 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m23:09:02.845800 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m23:09:02.847367 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m23:09:02.848681 [info ] [Thread-4 (]: 4 of 5 SKIP relation etl_schema.answer_option_analysis ......................... [[33mSKIP[0m]
[0m23:09:02.850416 [info ] [Thread-3 (]: 5 of 5 SKIP relation etl_schema.question_evolution ............................. [[33mSKIP[0m]
[0m23:09:02.851875 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m23:09:02.853144 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m23:09:02.855484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:02.856138 [debug] [MainThread]: Connection 'list_research_db_etl_schema_staging' was properly closed.
[0m23:09:02.856672 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m23:09:02.857029 [debug] [MainThread]: Connection 'list_research_db_etl_schema' was properly closed.
[0m23:09:02.857486 [info ] [MainThread]: 
[0m23:09:02.857904 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m23:09:02.858761 [debug] [MainThread]: Command end result
[0m23:09:02.889614 [info ] [MainThread]: 
[0m23:09:02.890094 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:09:02.890389 [info ] [MainThread]: 
[0m23:09:02.890710 [error] [MainThread]:   Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 19
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:09:02.890969 [info ] [MainThread]: 
[0m23:09:02.891253 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m23:09:02.891868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5303004, "process_user_time": 2.792924, "process_kernel_time": 0.116621, "process_mem_max_rss": "170228", "process_out_blocks": "2936", "command_success": false, "process_in_blocks": "0"}
[0m23:09:02.892361 [debug] [MainThread]: Command `dbt run` failed at 23:09:02.892283 after 2.53 seconds
[0m23:09:02.892689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805224effa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7805216c8e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780509055f00>]}
[0m23:09:02.892999 [debug] [MainThread]: Flushing usage events
[0m23:12:06.390536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d52d7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d3b45000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d3b45f90>]}


============================== 23:12:06.392471 | d298ce29-b28f-40da-8446-ec9639ef1afe ==============================
[0m23:12:06.392471 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:12:06.392905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:12:06.788360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd298ce29-b28f-40da-8446-ec9639ef1afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d51f96f0>]}
[0m23:12:06.833490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd298ce29-b28f-40da-8446-ec9639ef1afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d46aa410>]}
[0m23:12:06.834197 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:12:06.845373 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:12:06.954509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:12:06.955149 [debug] [MainThread]: Partial parsing: updated file: research_questions_etl://models/marts/question_evolution.sql
[0m23:12:07.156918 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:12:07.157425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd298ce29-b28f-40da-8446-ec9639ef1afe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d5142ef0>]}
[0m23:12:07.298182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m23:12:07.310579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd298ce29-b28f-40da-8446-ec9639ef1afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5bb5cc130>]}
[0m23:12:07.408852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd298ce29-b28f-40da-8446-ec9639ef1afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5bb5db8b0>]}
[0m23:12:07.409329 [info ] [MainThread]: Found 19 data tests, 5 models, 1 source, 651 macros
[0m23:12:07.409651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd298ce29-b28f-40da-8446-ec9639ef1afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5bb5dba60>]}
[0m23:12:07.411025 [info ] [MainThread]: 
[0m23:12:07.411535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:12:07.415266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:12:07.415833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:12:07.421550 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:12:07.428469 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:12:07.430803 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:12:07.433248 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:12:07.433685 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:12:07.434109 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:12:07.434519 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:12:07.434902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:07.435289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:07.435616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:08.025903 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.591 seconds
[0m23:12:08.026563 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.592 seconds
[0m23:12:08.027717 [debug] [ThreadPool]: On list_research_db: Close
[0m23:12:08.028269 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.593 seconds
[0m23:12:08.029417 [debug] [ThreadPool]: On list_research_db: Close
[0m23:12:08.031325 [debug] [ThreadPool]: On list_research_db: Close
[0m23:12:08.138509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m23:12:08.139865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m23:12:08.141343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m23:12:08.173638 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m23:12:08.180159 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m23:12:08.184695 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m23:12:08.185733 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m23:12:08.186803 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m23:12:08.187866 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m23:12:08.188890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:08.189955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:08.190989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:08.561340 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.371 seconds
[0m23:12:08.565264 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m23:12:08.647318 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.458 seconds
[0m23:12:08.650929 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m23:12:08.672502 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.481 seconds
[0m23:12:08.676068 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m23:12:08.768920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd298ce29-b28f-40da-8446-ec9639ef1afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d55bbeb0>]}
[0m23:12:08.770602 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:08.771565 [info ] [MainThread]: 
[0m23:12:08.776105 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m23:12:08.777549 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m23:12:08.778771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_staging, now model.research_questions_etl.stg_research_questions)
[0m23:12:08.779761 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m23:12:08.796830 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m23:12:08.797821 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m23:12:08.820469 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m23:12:08.821512 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m23:12:08.821865 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    CASE 
        WHEN category LIKE 'New %' THEN REPLACE(category, 'New ', '')
        ELSE category
    END AS category,
    is_active,
    TRY_PARSE_JSON(answer_set) AS answer_set,
    TRY_PARSE_JSON(previous_answer_set) AS previous_answer_set,
    valid_to,
    first_seen_year,
    previous_version_id,
    match_score,
    answer_set_version,
    text_changed
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m23:12:08.822210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:09.088213 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b76854-0001-5de9-0001-de6600037562
[0m23:12:09.088913 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 19
invalid identifier 'PREVIOUS_ANSWER_SET'
[0m23:12:09.089621 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m23:12:09.189298 [debug] [Thread-1 (]: Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 19
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:12:09.190610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd298ce29-b28f-40da-8446-ec9639ef1afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5ba54fca0>]}
[0m23:12:09.191189 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model etl_schema_staging.stg_research_questions  [[31mERROR[0m in 0.41s]
[0m23:12:09.191691 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m23:12:09.192864 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m23:12:09.193277 [info ] [Thread-3 (]: 2 of 5 SKIP relation etl_schema_intermediate.int_research_questions_unified .... [[33mSKIP[0m]
[0m23:12:09.193663 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m23:12:09.194221 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m23:12:09.194625 [info ] [Thread-2 (]: 3 of 5 SKIP relation etl_schema.consolidated_research_questions ................ [[33mSKIP[0m]
[0m23:12:09.194970 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m23:12:09.195496 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m23:12:09.195853 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m23:12:09.196170 [info ] [Thread-4 (]: 4 of 5 SKIP relation etl_schema.answer_option_analysis ......................... [[33mSKIP[0m]
[0m23:12:09.196538 [info ] [Thread-3 (]: 5 of 5 SKIP relation etl_schema.question_evolution ............................. [[33mSKIP[0m]
[0m23:12:09.197014 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m23:12:09.197412 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m23:12:09.198526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:09.198836 [debug] [MainThread]: Connection 'list_research_db_etl_schema_intermediate' was properly closed.
[0m23:12:09.199199 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m23:12:09.199564 [debug] [MainThread]: Connection 'list_research_db_etl_schema' was properly closed.
[0m23:12:09.199968 [info ] [MainThread]: 
[0m23:12:09.200418 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m23:12:09.201520 [debug] [MainThread]: Command end result
[0m23:12:09.231575 [info ] [MainThread]: 
[0m23:12:09.232030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:12:09.232339 [info ] [MainThread]: 
[0m23:12:09.232662 [error] [MainThread]:   Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 19
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:12:09.232927 [info ] [MainThread]: 
[0m23:12:09.233215 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m23:12:09.233842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8779445, "process_user_time": 2.931929, "process_kernel_time": 0.116917, "process_mem_max_rss": "175960", "process_out_blocks": "4360", "command_success": false, "process_in_blocks": "0"}
[0m23:12:09.234319 [debug] [MainThread]: Command `dbt run` failed at 23:12:09.234243 after 2.88 seconds
[0m23:12:09.234647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d52d7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d51f96f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c5d46ab850>]}
[0m23:12:09.234974 [debug] [MainThread]: Flushing usage events
[0m23:12:36.569615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a97ba68100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a979f5ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a979f15a20>]}


============================== 23:12:36.571585 | f4bad5e6-dd4c-4302-95f2-4a4ea624aa9d ==============================
[0m23:12:36.571585 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:12:36.575772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/hasan/Desktop/MyLearning/research_questions_etl/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_research_questions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:12:37.021838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4bad5e6-dd4c-4302-95f2-4a4ea624aa9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9626ee5f0>]}
[0m23:12:37.063966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4bad5e6-dd4c-4302-95f2-4a4ea624aa9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a97a5e0df0>]}
[0m23:12:37.064623 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:12:37.075078 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:12:37.186399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:37.186816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:12:37.191424 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m23:12:37.232194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4bad5e6-dd4c-4302-95f2-4a4ea624aa9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96211c580>]}
[0m23:12:37.333168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4bad5e6-dd4c-4302-95f2-4a4ea624aa9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96211e650>]}
[0m23:12:37.333782 [info ] [MainThread]: Found 19 data tests, 5 models, 1 source, 651 macros
[0m23:12:37.334309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4bad5e6-dd4c-4302-95f2-4a4ea624aa9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96211e800>]}
[0m23:12:37.335897 [info ] [MainThread]: 
[0m23:12:37.336416 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:12:37.337185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m23:12:37.350054 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m23:12:37.350541 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m23:12:37.350835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:38.032539 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.682 seconds
[0m23:12:38.033801 [debug] [ThreadPool]: On list_research_db: Close
[0m23:12:38.130741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m23:12:38.132963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema'
[0m23:12:38.155226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db_etl_schema_intermediate'
[0m23:12:38.160173 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m23:12:38.164941 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m23:12:38.166568 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m23:12:38.167593 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m23:12:38.168599 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m23:12:38.169587 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m23:12:38.170537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:38.171437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:38.172385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:38.454887 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.284 seconds
[0m23:12:38.458625 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m23:12:38.581820 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.409 seconds
[0m23:12:38.585613 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m23:12:38.603294 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.432 seconds
[0m23:12:38.606777 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m23:12:38.693127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4bad5e6-dd4c-4302-95f2-4a4ea624aa9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96269ac20>]}
[0m23:12:38.694687 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:38.695736 [info ] [MainThread]: 
[0m23:12:38.700398 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m23:12:38.701752 [info ] [Thread-1 (]: 1 of 1 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m23:12:38.702933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema_intermediate, now model.research_questions_etl.stg_research_questions)
[0m23:12:38.703909 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m23:12:38.715086 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m23:12:38.715852 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m23:12:38.739714 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m23:12:38.740797 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m23:12:38.741198 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    CASE 
        WHEN category LIKE 'New %' THEN REPLACE(category, 'New ', '')
        ELSE category
    END AS category,
    is_active,
    TRY_PARSE_JSON(answer_set) AS answer_set,
    TRY_PARSE_JSON(previous_answer_set) AS previous_answer_set,
    valid_to,
    first_seen_year,
    previous_version_id,
    match_score,
    answer_set_version,
    text_changed
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m23:12:38.741499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:38.998521 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b76854-0001-5e09-0001-de660003926e
[0m23:12:38.999706 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 19
invalid identifier 'PREVIOUS_ANSWER_SET'
[0m23:12:39.001102 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m23:12:39.092672 [debug] [Thread-1 (]: Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 19
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:12:39.096551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4bad5e6-dd4c-4302-95f2-4a4ea624aa9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a96211c670>]}
[0m23:12:39.098245 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model etl_schema_staging.stg_research_questions  [[31mERROR[0m in 0.39s]
[0m23:12:39.100092 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m23:12:39.103750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:39.104570 [debug] [MainThread]: Connection 'list_research_db_etl_schema_staging' was properly closed.
[0m23:12:39.105430 [debug] [MainThread]: Connection 'list_research_db_etl_schema' was properly closed.
[0m23:12:39.106225 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m23:12:39.107237 [info ] [MainThread]: 
[0m23:12:39.108418 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m23:12:39.109328 [debug] [MainThread]: Command end result
[0m23:12:39.143474 [info ] [MainThread]: 
[0m23:12:39.144028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:12:39.144471 [info ] [MainThread]: 
[0m23:12:39.144900 [error] [MainThread]:   Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 19
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m23:12:39.145246 [info ] [MainThread]: 
[0m23:12:39.145551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:12:39.146285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6134584, "process_user_time": 2.686151, "process_kernel_time": 0.099819, "process_mem_max_rss": "169556", "process_out_blocks": "2944", "command_success": false, "process_in_blocks": "0"}
[0m23:12:39.146776 [debug] [MainThread]: Command `dbt run` failed at 23:12:39.146696 after 2.61 seconds
[0m23:12:39.147168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a97ba68100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a97a5e0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a9624beda0>]}
[0m23:12:39.147531 [debug] [MainThread]: Flushing usage events
[0m00:24:42.912288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773594e400a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773593596ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773593594430>]}


============================== 00:24:42.914838 | 5fa86ee6-c5b2-44e7-be70-cdf893e3d0ba ==============================
[0m00:24:42.914838 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:24:42.915285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir dbt --project-dir dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:24:43.410062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fa86ee6-c5b2-44e7-be70-cdf893e3d0ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773594cdd720>]}
[0m00:24:43.461388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fa86ee6-c5b2-44e7-be70-cdf893e3d0ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77357babc1f0>]}
[0m00:24:43.462371 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:24:43.476511 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:24:43.634408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:43.634802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:43.639370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.research_questions_etl.mart
[0m00:24:43.685430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fa86ee6-c5b2-44e7-be70-cdf893e3d0ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77357b514520>]}
[0m00:24:43.799062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fa86ee6-c5b2-44e7-be70-cdf893e3d0ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77357b516650>]}
[0m00:24:43.799551 [info ] [MainThread]: Found 19 data tests, 5 models, 1 source, 651 macros
[0m00:24:43.799868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa86ee6-c5b2-44e7-be70-cdf893e3d0ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77357b516860>]}
[0m00:24:43.801334 [info ] [MainThread]: 
[0m00:24:43.801814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:24:43.805936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m00:24:43.814121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m00:24:43.820516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_research_db'
[0m00:24:43.821484 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m00:24:43.871205 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m00:24:43.873507 [debug] [ThreadPool]: Using snowflake connection "list_research_db"
[0m00:24:43.873922 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m00:24:43.874453 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m00:24:43.874830 [debug] [ThreadPool]: On list_research_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db"} */
show terse schemas in database research_db
    limit 10000
[0m00:24:43.875196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:43.875752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:43.876079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:44.173149 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.297 seconds
[0m00:24:44.176690 [debug] [ThreadPool]: On list_research_db: Close
[0m00:24:44.315996 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.440 seconds
[0m00:24:44.316876 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.442 seconds
[0m00:24:44.318371 [debug] [ThreadPool]: On list_research_db: Close
[0m00:24:44.320017 [debug] [ThreadPool]: On list_research_db: Close
[0m00:24:44.398110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema)
[0m00:24:44.398610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_intermediate)
[0m00:24:44.399145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_research_db, now list_research_db_etl_schema_staging)
[0m00:24:44.406545 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema"
[0m00:24:44.410393 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_intermediate"
[0m00:24:44.414020 [debug] [ThreadPool]: Using snowflake connection "list_research_db_etl_schema_staging"
[0m00:24:44.414768 [debug] [ThreadPool]: On list_research_db_etl_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema"} */
show objects in research_db.etl_schema limit 10000
[0m00:24:44.415516 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_intermediate"} */
show objects in research_db.etl_schema_intermediate limit 10000
[0m00:24:44.416405 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "connection_name": "list_research_db_etl_schema_staging"} */
show objects in research_db.etl_schema_staging limit 10000
[0m00:24:44.417314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:44.418189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:44.419126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:44.668947 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.252 seconds
[0m00:24:44.670458 [debug] [ThreadPool]: On list_research_db_etl_schema: Close
[0m00:24:44.751931 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.334 seconds
[0m00:24:44.753671 [debug] [ThreadPool]: On list_research_db_etl_schema_intermediate: Close
[0m00:24:45.077782 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.659 seconds
[0m00:24:45.081008 [debug] [ThreadPool]: On list_research_db_etl_schema_staging: Close
[0m00:24:45.157890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa86ee6-c5b2-44e7-be70-cdf893e3d0ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77359509b460>]}
[0m00:24:45.159592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:24:45.160613 [info ] [MainThread]: 
[0m00:24:45.171936 [debug] [Thread-1 (]: Began running node model.research_questions_etl.stg_research_questions
[0m00:24:45.173711 [info ] [Thread-1 (]: 1 of 5 START sql table model etl_schema_staging.stg_research_questions ......... [RUN]
[0m00:24:45.175140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_research_db_etl_schema, now model.research_questions_etl.stg_research_questions)
[0m00:24:45.176243 [debug] [Thread-1 (]: Began compiling node model.research_questions_etl.stg_research_questions
[0m00:24:45.190143 [debug] [Thread-1 (]: Writing injected SQL for node "model.research_questions_etl.stg_research_questions"
[0m00:24:45.191189 [debug] [Thread-1 (]: Began executing node model.research_questions_etl.stg_research_questions
[0m00:24:45.212948 [debug] [Thread-1 (]: Writing runtime sql for node "model.research_questions_etl.stg_research_questions"
[0m00:24:45.214772 [debug] [Thread-1 (]: Using snowflake connection "model.research_questions_etl.stg_research_questions"
[0m00:24:45.215177 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "research_questions_etl", "target_name": "dev", "node_id": "model.research_questions_etl.stg_research_questions"} */
create or replace transient table research_db.etl_schema_staging.stg_research_questions
         as
        (

SELECT
    question_id,
    year,
    question_text,
    CASE 
        WHEN category LIKE 'New %' THEN REPLACE(category, 'New ', '')
        ELSE category
    END AS category,
    is_active,
    TRY_PARSE_JSON(answer_set) AS answer_set,
    TRY_PARSE_JSON(previous_answer_set) AS previous_answer_set,
    valid_to,
    first_seen_year,
    previous_version_id,
    match_score,
    answer_set_version,
    text_changed
FROM RESEARCH_DB.ETL_SCHEMA.consolidated_research_questions
        );
[0m00:24:45.215507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:45.479848 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7689c-0001-5e09-0001-de6600039602
[0m00:24:45.481174 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 19
invalid identifier 'PREVIOUS_ANSWER_SET'
[0m00:24:45.482854 [debug] [Thread-1 (]: On model.research_questions_etl.stg_research_questions: Close
[0m00:24:45.557733 [debug] [Thread-1 (]: Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 19
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m00:24:45.561371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fa86ee6-c5b2-44e7-be70-cdf893e3d0ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735940cdc90>]}
[0m00:24:45.563137 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model etl_schema_staging.stg_research_questions  [[31mERROR[0m in 0.38s]
[0m00:24:45.564762 [debug] [Thread-1 (]: Finished running node model.research_questions_etl.stg_research_questions
[0m00:24:45.567694 [debug] [Thread-3 (]: Began running node model.research_questions_etl.int_research_questions_unified
[0m00:24:45.568715 [info ] [Thread-3 (]: 2 of 5 SKIP relation etl_schema_intermediate.int_research_questions_unified .... [[33mSKIP[0m]
[0m00:24:45.569883 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.int_research_questions_unified
[0m00:24:45.571563 [debug] [Thread-2 (]: Began running node model.research_questions_etl.consolidated_research_questions
[0m00:24:45.572312 [info ] [Thread-2 (]: 3 of 5 SKIP relation etl_schema.consolidated_research_questions ................ [[33mSKIP[0m]
[0m00:24:45.573039 [debug] [Thread-2 (]: Finished running node model.research_questions_etl.consolidated_research_questions
[0m00:24:45.574436 [debug] [Thread-4 (]: Began running node model.research_questions_etl.answer_option_analysis
[0m00:24:45.575142 [debug] [Thread-3 (]: Began running node model.research_questions_etl.question_evolution
[0m00:24:45.575568 [info ] [Thread-4 (]: 4 of 5 SKIP relation etl_schema.answer_option_analysis ......................... [[33mSKIP[0m]
[0m00:24:45.576056 [info ] [Thread-3 (]: 5 of 5 SKIP relation etl_schema.question_evolution ............................. [[33mSKIP[0m]
[0m00:24:45.576536 [debug] [Thread-4 (]: Finished running node model.research_questions_etl.answer_option_analysis
[0m00:24:45.577013 [debug] [Thread-3 (]: Finished running node model.research_questions_etl.question_evolution
[0m00:24:45.578212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:45.578750 [debug] [MainThread]: Connection 'model.research_questions_etl.stg_research_questions' was properly closed.
[0m00:24:45.579185 [debug] [MainThread]: Connection 'list_research_db_etl_schema_intermediate' was properly closed.
[0m00:24:45.579600 [debug] [MainThread]: Connection 'list_research_db_etl_schema_staging' was properly closed.
[0m00:24:45.580140 [info ] [MainThread]: 
[0m00:24:45.580534 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m00:24:45.581355 [debug] [MainThread]: Command end result
[0m00:24:45.613480 [info ] [MainThread]: 
[0m00:24:45.613970 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:24:45.614353 [info ] [MainThread]: 
[0m00:24:45.614693 [error] [MainThread]:   Database Error in model stg_research_questions (models/staging/stg_research_questions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 19
  invalid identifier 'PREVIOUS_ANSWER_SET'
  compiled code at target/run/research_questions_etl/models/staging/stg_research_questions.sql
[0m00:24:45.614986 [info ] [MainThread]: 
[0m00:24:45.615283 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m00:24:45.616308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7459345, "process_user_time": 2.785231, "process_kernel_time": 0.121959, "process_mem_max_rss": "169964", "process_in_blocks": "43960", "process_out_blocks": "2944", "command_success": false}
[0m00:24:45.616779 [debug] [MainThread]: Command `dbt run` failed at 00:24:45.616702 after 2.75 seconds
[0m00:24:45.617102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773594e400a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7735940f9300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77357b8b4940>]}
[0m00:24:45.617428 [debug] [MainThread]: Flushing usage events
